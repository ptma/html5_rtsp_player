{"version":3,"file":"videojs.ws.js","sources":["../../../node_modules/bp_logger/logger.js","../../../src/deps/bp_logger.js","../../../src/core/util/url.js","../../../node_modules/bp_event/event.js","../../../src/deps/bp_event.js","../../../src/core/iso-bmff/mp4-generator.js","../../../src/core/presentation/mse.js","../../../src/core/remuxer/base.js","../../../src/core/remuxer/aac.js","../../../src/core/util/exp-golomb.js","../../../src/core/util/binary.js","../../../src/core/elementary/NALU.js","../../../src/core/parsers/h264.js","../../../src/core/remuxer/h264.js","../../../src/core/defs.js","../../../src/core/remuxer/remuxer.js","../../../node_modules/bp_statemachine/statemachine.js","../../../src/deps/bp_statemachine.js","../../../src/core/parsers/sdp.js","../../../src/client/rtsp/stream.js","../../../src/core/util/md5.js","../../../src/client/rtsp/rtp/rtp.js","../../../src/client/rtsp/rtp/factory.js","../../../src/client/rtsp/message.js","../../../src/core/elementary/NALUAsm.js","../../../src/core/elementary/AACFrame.js","../../../src/core/elementary/AACAsm.js","../../../src/client/rtsp/rtp/payload/parser.js","../../../src/core/base_client.js","../../../src/core/parsers/aac.js","../../../src/client/rtsp/session.js","../../../src/client/rtsp/client.js","../../../node_modules/jsencrypt/lib/asn1js/asn1.js","../../../node_modules/jsencrypt/lib/jsbn/prng4.js","../../../node_modules/jsencrypt/lib/jsbn/rng.js","../../../node_modules/jsencrypt/lib/jsbn/jsbn.js","../../../node_modules/jsencrypt/lib/jsbn/jsbn2.js","../../../node_modules/jsencrypt/lib/jsbn/rsa.js","../../../node_modules/jsencrypt/lib/jsbn/rsa2.js","../../../node_modules/jsencrypt/lib/asn1js/base64.js","../../../node_modules/jsencrypt/lib/asn1js/hex.js","../../../node_modules/jsencrypt/lib/jsrsasign/asn1-1.0.js","../../../node_modules/jsencrypt/lib/jsbn/base64.js","../../../node_modules/jsencrypt/src/jsencrypt.js","../../../src/deps/jsencrypt.js","../../../src/core/base_transport.js","../../../src/core/util/browser.js","../../../src/transport/websocket.js","../../../src/player.js","../../../src/core/parsers/pes.js","../../../src/core/parsers/ts.js","../../../src/client/hls/pes_avc.js","../../../src/client/hls/adts.js","../../../src/client/hls/pes_aac.js","../../../src/core/parsers/m3u8.js","../../../src/client/hls/client.js","../src/videojs.streamedian.js"],"sourcesContent":["// ERROR=0, WARN=1, LOG=2, DEBUG=3\nexport const LogLevel = {\n    Error: 0,\n    Warn: 1,\n    Log: 2,\n    Debug: 3\n};\n\nlet DEFAULT_LOG_LEVEL = LogLevel.Debug;\n\nexport function setDefaultLogLevel(level) {\n    DEFAULT_LOG_LEVEL = level;\n}\nexport class Logger {\n    constructor(level = DEFAULT_LOG_LEVEL, tag) {\n        this.tag = tag;\n        this.setLevel(level);\n    }\n    \n    setLevel(level) {\n        this.level = level;\n    }\n    \n    static get level_map() { return {\n        [LogLevel.Debug]:'log',\n        [LogLevel.Log]:'log',\n        [LogLevel.Warn]:'warn',\n        [LogLevel.Error]:'error'\n    }};\n\n    _log(lvl, args) {\n        args = Array.prototype.slice.call(args);\n        if (this.tag) {\n            args.unshift(`[${this.tag}]`);\n        }\n        if (this.level>=lvl) console[Logger.level_map[lvl]].apply(console, args);\n    }\n    log(){\n        this._log(LogLevel.Log, arguments)\n    }\n    debug(){\n        this._log(LogLevel.Debug, arguments)\n    }\n    error(){\n        this._log(LogLevel.Error, arguments)\n    }\n    warn(){\n        this._log(LogLevel.Warn, arguments)\n    }\n}\n\nconst taggedLoggers = new Map();\nexport function getTagged(tag) {\n    if (!taggedLoggers.has(tag)) {\n        taggedLoggers.set(tag, new Logger(DEFAULT_LOG_LEVEL, tag));\n    }\n    return taggedLoggers.get(tag);\n}\nexport const Log = new Logger();\n","// export * from 'bp_logger';\nexport * from '../../node_modules/bp_logger/logger.js';","export class Url {\n    static parse(url) {\n        let ret = {};\n\n        let regex = /^([^:]+):\\/\\/([^\\/]+)(.*)$/;  //protocol, login, urlpath\n        let result = regex.exec(url);\n\n        if (!result) {\n            throw new Error(\"bad url\");\n        }\n\n        ret.full = url;\n        ret.protocol = result[1];\n        ret.urlpath = result[3];\n\n        let parts = ret.urlpath.split('/');\n        ret.basename = parts.pop().split(/\\?|#/)[0];\n        ret.basepath = parts.join('/');\n\n        let loginSplit = result[2].split('@');\n        let hostport = loginSplit[0].split(':');\n        let userpass = [ null, null ];\n        if (loginSplit.length === 2) {\n            userpass = loginSplit[0].split(':');\n            hostport = loginSplit[1].split(':');\n        }\n\n        ret.user = userpass[0];\n        ret.pass = userpass[1];\n        ret.host = hostport[0];\n        ret.auth = (ret.user && ret.pass) ? `${ret.user}:${ret.pass}` : '';\n\n        ret.port = (null == hostport[1]) ? Url.protocolDefaultPort(ret.protocol) : hostport[1];\n        ret.portDefined = (null != hostport[1]);\n        ret.location = `${ret.host}:${ret.port}`;\n\n        if (ret.protocol == 'unix') {\n            ret.socket = ret.port;\n            ret.port = undefined;\n        }\n\n        return ret;\n    }\n\n    static full(parsed) {\n        return `${parsed.protocol}://${parsed.location}/${parsed.urlpath}`;\n    }\n\n    static isAbsolute(url) {\n        return /^[^:]+:\\/\\//.test(url);\n    }\n\n    static protocolDefaultPort(protocol) {\n        switch (protocol) {\n            case 'rtsp': return 554;\n            case 'http': return 80;\n            case 'https': return 443;\n        }\n\n        return 0;\n    }\n}","const listener = Symbol(\"event_listener\");\nconst listeners = Symbol(\"event_listeners\");\n\nexport class DestructibleEventListener {\n    constructor(eventListener) {\n        this[listener] = eventListener;\n        this[listeners] = new Map();\n    }\n\n    clear() {\n        if (this[listeners]) {\n            for (let entry of this[listeners]) {\n                for (let fn of entry[1]) {\n                    this[listener].removeEventListener(entry[0], fn);\n                }\n            };\n        }\n        this[listeners].clear();\n    }\n\n    destroy() {\n        this.clear();\n        this[listeners] = null;\n    }\n\n    on(event, selector, fn) {\n        if (fn == undefined) {\n            fn = selector;\n            selector = null;\n        }\n        if (selector) {\n            return this.addEventListener(event, (e) => {\n                if (e.target.matches(selector)) {\n                    fn(e)\n                }\n            });\n        } else {\n            return this.addEventListener(event, fn);\n        }\n    }\n\n    addEventListener(event, fn) {\n        if (!this[listeners].has(event)) {\n            this[listeners].set(event, new Set());\n        }\n        this[listeners].get(event).add(fn);\n        this[listener].addEventListener(event, fn, false);\n        return fn;\n    }\n\n    removeEventListener(event, fn) {\n        this[listener].removeEventListener(event, fn, false);\n        if (this[listeners].has(event)) {\n            //this[listeners].set(event, new Set());\n            let ev = this[listeners].get(event);\n            ev.delete(fn);\n            if (!ev.size) {\n                this[listeners].delete(event);\n            }\n        }\n    }\n\n    dispatchEvent(event) {\n        if (this[listener]) {\n            this[listener].dispatchEvent(event);\n        }\n    }\n}\n\nexport class EventEmitter {\n    constructor(element=null) {\n        this[listener] = new DestructibleEventListener(element || document.createElement('div'));\n    }\n\n    clear() {\n        if (this[listener]) {\n            this[listener].clear();\n        }\n    }\n\n    destroy() {\n        if (this[listener]) {\n            this[listener].destroy();\n            this[listener] = null;\n        }\n    }\n\n    on(event, selector, fn) {\n        if (this[listener]) {\n            return this[listener].on(event, selector, fn);\n        }\n        return null;\n    }\n\n    addEventListener(event, fn) {\n        if (this[listener]) {\n            return this[listener].addEventListener(event, fn, false);\n        }\n        return null;\n    }\n\n    removeEventListener(event, fn) {\n        if (this[listener]) {\n            this[listener].removeEventListener(event, fn, false);\n        }\n    }\n\n    dispatchEvent(event, data) {\n        if (this[listener]) {\n            this[listener].dispatchEvent(new CustomEvent(event, {detail: data}));\n        }\n    }\n}\n\nexport class EventSourceWrapper {\n    constructor(eventSource) {\n        this.eventSource = eventSource;\n        this[listeners] = new Map();\n    }\n\n    on(event, selector, fn) {\n        if (!this[listeners].has(event)) {\n            this[listeners].set(event, new Set());\n        }\n        let listener = this.eventSource.on(event, selector, fn);\n        if (listener) {\n            this[listeners].get(event).add(listener);\n        }\n    }\n\n    off(event, fn){\n        this.eventSource.removeEventListener(event, fn);\n    }\n\n    clear() {\n        this.eventSource.clear();\n        this[listeners].clear();\n    }\n\n    destroy() {\n        this.eventSource.clear();\n        this[listeners] = null;\n        this.eventSource = null;\n    }\n}\n","// export * from 'bp_event';\nexport * from '../../node_modules/bp_event/event.js';","/**\n * Generate MP4 Box\n * got from: https://github.com/dailymotion/hls.js\n */\n\nexport class MP4 {\n    static init() {\n        MP4.types = {\n            avc1: [], // codingname\n            avcC: [],\n            btrt: [],\n            dinf: [],\n            dref: [],\n            esds: [],\n            ftyp: [],\n            hdlr: [],\n            mdat: [],\n            mdhd: [],\n            mdia: [],\n            mfhd: [],\n            minf: [],\n            moof: [],\n            moov: [],\n            mp4a: [],\n            mvex: [],\n            mvhd: [],\n            sdtp: [],\n            stbl: [],\n            stco: [],\n            stsc: [],\n            stsd: [],\n            stsz: [],\n            stts: [],\n            tfdt: [],\n            tfhd: [],\n            traf: [],\n            trak: [],\n            trun: [],\n            trex: [],\n            tkhd: [],\n            vmhd: [],\n            smhd: []\n        };\n\n        var i;\n        for (i in MP4.types) {\n            if (MP4.types.hasOwnProperty(i)) {\n                MP4.types[i] = [\n                    i.charCodeAt(0),\n                    i.charCodeAt(1),\n                    i.charCodeAt(2),\n                    i.charCodeAt(3)\n                ];\n            }\n        }\n\n        var videoHdlr = new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x56, 0x69, 0x64, 0x65,\n            0x6f, 0x48, 0x61, 0x6e,\n            0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\n        ]);\n\n        var audioHdlr = new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x53, 0x6f, 0x75, 0x6e,\n            0x64, 0x48, 0x61, 0x6e,\n            0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\n        ]);\n\n        MP4.HDLR_TYPES = {\n            'video': videoHdlr,\n            'audio': audioHdlr\n        };\n\n        var dref = new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x01, // entry_count\n            0x00, 0x00, 0x00, 0x0c, // entry_size\n            0x75, 0x72, 0x6c, 0x20, // 'url' type\n            0x00, // version 0\n            0x00, 0x00, 0x01 // entry_flags\n        ]);\n\n        var stco = new Uint8Array([\n            0x00, // version\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x00 // entry_count\n        ]);\n\n        MP4.STTS = MP4.STSC = MP4.STCO = stco;\n\n        MP4.STSZ = new Uint8Array([\n            0x00, // version\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x00, // sample_size\n            0x00, 0x00, 0x00, 0x00, // sample_count\n        ]);\n        MP4.VMHD = new Uint8Array([\n            0x00, // version\n            0x00, 0x00, 0x01, // flags\n            0x00, 0x00, // graphicsmode\n            0x00, 0x00,\n            0x00, 0x00,\n            0x00, 0x00 // opcolor\n        ]);\n        MP4.SMHD = new Uint8Array([\n            0x00, // version\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, // balance\n            0x00, 0x00 // reserved\n        ]);\n\n        MP4.STSD = new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x01]);// entry_count\n\n        var majorBrand = new Uint8Array([105,115,111,109]); // isom\n        var avc1Brand = new Uint8Array([97,118,99,49]); // avc1\n        var minorVersion = new Uint8Array([0, 0, 0, 1]);\n\n        MP4.FTYP = MP4.box(MP4.types.ftyp, majorBrand, minorVersion, majorBrand, avc1Brand);\n        MP4.DINF = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, dref));\n    }\n\n    static box(type, ...payload) {\n        var size = 8,\n            i = payload.length,\n            len = i,\n            result;\n        // calculate the total size we need to allocate\n        while (i--) {\n            size += payload[i].byteLength;\n        }\n        result = new Uint8Array(size);\n        result[0] = (size >> 24) & 0xff;\n        result[1] = (size >> 16) & 0xff;\n        result[2] = (size >> 8) & 0xff;\n        result[3] = size  & 0xff;\n        result.set(type, 4);\n        // copy the payload into the result\n        for (i = 0, size = 8; i < len; ++i) {\n            // copy payload[i] array @ offset size\n            result.set(payload[i], size);\n            size += payload[i].byteLength;\n        }\n        return result;\n    }\n\n    static hdlr(type) {\n        return MP4.box(MP4.types.hdlr, MP4.HDLR_TYPES[type]);\n    }\n\n    static mdat(data) {\n        return MP4.box(MP4.types.mdat, data);\n    }\n\n    static mdhd(timescale, duration) {\n        return MP4.box(MP4.types.mdhd, new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n            0x00, 0x00, 0x00, 0x02, // creation_time\n            0x00, 0x00, 0x00, 0x03, // modification_time\n            (timescale >> 24) & 0xFF,\n            (timescale >> 16) & 0xFF,\n            (timescale >>  8) & 0xFF,\n            timescale & 0xFF, // timescale\n            (duration >> 24),\n            (duration >> 16) & 0xFF,\n            (duration >>  8) & 0xFF,\n            duration & 0xFF, // duration\n            0x55, 0xc4, // 'und' language (undetermined)\n            0x00, 0x00\n        ]));\n    }\n\n    static mdia(track) {\n        return MP4.box(MP4.types.mdia, MP4.mdhd(track.timescale, track.duration), MP4.hdlr(track.type), MP4.minf(track));\n    }\n\n    static mfhd(sequenceNumber) {\n        return MP4.box(MP4.types.mfhd, new Uint8Array([\n            0x00,\n            0x00, 0x00, 0x00, // flags\n            (sequenceNumber >> 24),\n            (sequenceNumber >> 16) & 0xFF,\n            (sequenceNumber >>  8) & 0xFF,\n            sequenceNumber & 0xFF, // sequence_number\n        ]));\n    }\n\n    static minf(track) {\n        if (track.type === 'audio') {\n            return MP4.box(MP4.types.minf, MP4.box(MP4.types.smhd, MP4.SMHD), MP4.DINF, MP4.stbl(track));\n        } else {\n            return MP4.box(MP4.types.minf, MP4.box(MP4.types.vmhd, MP4.VMHD), MP4.DINF, MP4.stbl(track));\n        }\n    }\n\n    static moof(sn, baseMediaDecodeTime, track) {\n        return MP4.box(MP4.types.moof, MP4.mfhd(sn), MP4.traf(track,baseMediaDecodeTime));\n    }\n    /**\n     * @param tracks... (optional) {array} the tracks associated with this movie\n     */\n    static moov(tracks, duration, timescale) {\n        var\n            i = tracks.length,\n            boxes = [];\n\n        while (i--) {\n            boxes[i] = MP4.trak(tracks[i]);\n        }\n\n        return MP4.box.apply(null, [MP4.types.moov, MP4.mvhd(timescale, duration)].concat(boxes).concat(MP4.mvex(tracks)));\n    }\n\n    static mvex(tracks) {\n        var\n            i = tracks.length,\n            boxes = [];\n\n        while (i--) {\n            boxes[i] = MP4.trex(tracks[i]);\n        }\n        return MP4.box.apply(null, [MP4.types.mvex].concat(boxes));\n    }\n\n    static mvhd(timescale,duration) {\n        var\n            bytes = new Uint8Array([\n                0x00, // version 0\n                0x00, 0x00, 0x00, // flags\n                0x00, 0x00, 0x00, 0x01, // creation_time\n                0x00, 0x00, 0x00, 0x02, // modification_time\n                (timescale >> 24) & 0xFF,\n                (timescale >> 16) & 0xFF,\n                (timescale >>  8) & 0xFF,\n                timescale & 0xFF, // timescale\n                (duration >> 24) & 0xFF,\n                (duration >> 16) & 0xFF,\n                (duration >>  8) & 0xFF,\n                duration & 0xFF, // duration\n                0x00, 0x01, 0x00, 0x00, // 1.0 rate\n                0x01, 0x00, // 1.0 volume\n                0x00, 0x00, // reserved\n                0x00, 0x00, 0x00, 0x00, // reserved\n                0x00, 0x00, 0x00, 0x00, // reserved\n                0x00, 0x01, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x01, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00, // pre_defined\n                0xff, 0xff, 0xff, 0xff // next_track_ID\n            ]);\n        return MP4.box(MP4.types.mvhd, bytes);\n    }\n\n    static sdtp(track) {\n        var\n            samples = track.samples || [],\n            bytes = new Uint8Array(4 + samples.length),\n            flags,\n            i;\n        // leave the full box header (4 bytes) all zero\n        // write the sample table\n        for (i = 0; i < samples.length; i++) {\n            flags = samples[i].flags;\n            bytes[i + 4] = (flags.dependsOn << 4) |\n                (flags.isDependedOn << 2) |\n                (flags.hasRedundancy);\n        }\n\n        return MP4.box(MP4.types.sdtp, bytes);\n    }\n\n    static stbl(track) {\n        return MP4.box(MP4.types.stbl, MP4.stsd(track), MP4.box(MP4.types.stts, MP4.STTS), MP4.box(MP4.types.stsc, MP4.STSC), MP4.box(MP4.types.stsz, MP4.STSZ), MP4.box(MP4.types.stco, MP4.STCO));\n    }\n\n    static avc1(track) {\n        var sps = [], pps = [], i, data, len;\n        // assemble the SPSs\n\n        for (i = 0; i < track.sps.length; i++) {\n            data = track.sps[i];\n            len = data.byteLength;\n            sps.push((len >>> 8) & 0xFF);\n            sps.push((len & 0xFF));\n            sps = sps.concat(Array.prototype.slice.call(data)); // SPS\n        }\n\n        // assemble the PPSs\n        for (i = 0; i < track.pps.length; i++) {\n            data = track.pps[i];\n            len = data.byteLength;\n            pps.push((len >>> 8) & 0xFF);\n            pps.push((len & 0xFF));\n            pps = pps.concat(Array.prototype.slice.call(data));\n        }\n\n        var avcc = MP4.box(MP4.types.avcC, new Uint8Array([\n                0x01,   // version\n                sps[3], // profile\n                sps[4], // profile compat\n                sps[5], // level\n                0xfc | 3, // lengthSizeMinusOne, hard-coded to 4 bytes\n                0xE0 | track.sps.length // 3bit reserved (111) + numOfSequenceParameterSets\n            ].concat(sps).concat([\n                track.pps.length // numOfPictureParameterSets\n            ]).concat(pps))), // \"PPS\"\n            width = track.width,\n            height = track.height;\n        //console.log('avcc:' + Hex.hexDump(avcc));\n        return MP4.box(MP4.types.avc1, new Uint8Array([\n                0x00, 0x00, 0x00, // reserved\n                0x00, 0x00, 0x00, // reserved\n                0x00, 0x01, // data_reference_index\n                0x00, 0x00, // pre_defined\n                0x00, 0x00, // reserved\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00, // pre_defined\n                (width >> 8) & 0xFF,\n                width & 0xff, // width\n                (height >> 8) & 0xFF,\n                height & 0xff, // height\n                0x00, 0x48, 0x00, 0x00, // horizresolution\n                0x00, 0x48, 0x00, 0x00, // vertresolution\n                0x00, 0x00, 0x00, 0x00, // reserved\n                0x00, 0x01, // frame_count\n                0x12,\n                0x62, 0x69, 0x6E, 0x65, //binelpro.ru\n                0x6C, 0x70, 0x72, 0x6F,\n                0x2E, 0x72, 0x75, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, // compressorname\n                0x00, 0x18,   // depth = 24\n                0x11, 0x11]), // pre_defined = -1\n            avcc,\n            MP4.box(MP4.types.btrt, new Uint8Array([\n                0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\n                0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\n                0x00, 0x2d, 0xc6, 0xc0])) // avgBitrate\n        );\n    }\n\n    static esds(track) {\n        var configlen = track.config.byteLength;\n        let data = new Uint8Array(26+configlen+3);\n        data.set([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n\n            0x03, // descriptor_type\n            0x17+configlen, // length\n            0x00, 0x01, //es_id\n            0x00, // stream_priority\n\n            0x04, // descriptor_type\n            0x0f+configlen, // length\n            0x40, //codec : mpeg4_audio\n            0x15, // stream_type\n            0x00, 0x00, 0x00, // buffer_size\n            0x00, 0x00, 0x00, 0x00, // maxBitrate\n            0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n            0x05, // descriptor_type\n            configlen\n        ]);\n        data.set(track.config, 26);\n        data.set([0x06, 0x01, 0x02], 26+configlen);\n        // return new Uint8Array([\n        //     0x00, // version 0\n        //     0x00, 0x00, 0x00, // flags\n        //\n        //     0x03, // descriptor_type\n        //     0x17+configlen, // length\n        //     0x00, 0x01, //es_id\n        //     0x00, // stream_priority\n        //\n        //     0x04, // descriptor_type\n        //     0x0f+configlen, // length\n        //     0x40, //codec : mpeg4_audio\n        //     0x15, // stream_type\n        //     0x00, 0x00, 0x00, // buffer_size\n        //     0x00, 0x00, 0x00, 0x00, // maxBitrate\n        //     0x00, 0x00, 0x00, 0x00, // avgBitrate\n        //\n        //     0x05 // descriptor_type\n        // ].concat([configlen]).concat(track.config).concat([0x06, 0x01, 0x02])); // GASpecificConfig)); // length + audio config descriptor\n        return data;\n    }\n\n    static mp4a(track) {\n        var audiosamplerate = track.audiosamplerate;\n        return MP4.box(MP4.types.mp4a, new Uint8Array([\n                0x00, 0x00, 0x00, // reserved\n                0x00, 0x00, 0x00, // reserved\n                0x00, 0x01, // data_reference_index\n                0x00, 0x00, 0x00, 0x00,\n                0x00, 0x00, 0x00, 0x00, // reserved\n                0x00, track.channelCount, // channelcount\n                0x00, 0x10, // sampleSize:16bits\n                0x00, 0x00, // pre_defined\n                0x00, 0x00, // reserved2\n                (audiosamplerate >> 8) & 0xFF,\n                audiosamplerate & 0xff, //\n                0x00, 0x00]),\n            MP4.box(MP4.types.esds, MP4.esds(track)));\n    }\n\n    static stsd(track) {\n        if (track.type === 'audio') {\n            return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp4a(track));\n        } else {\n            return MP4.box(MP4.types.stsd, MP4.STSD, MP4.avc1(track));\n        }\n    }\n\n    static tkhd(track) {\n        var id = track.id,\n            duration = track.duration,\n            width = track.width,\n            height = track.height,\n            volume = track.volume;\n        return MP4.box(MP4.types.tkhd, new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x07, // flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            (id >> 24) & 0xFF,\n            (id >> 16) & 0xFF,\n            (id >> 8) & 0xFF,\n            id & 0xFF, // track_ID\n            0x00, 0x00, 0x00, 0x00, // reserved\n            (duration >> 24),\n            (duration >> 16) & 0xFF,\n            (duration >>  8) & 0xFF,\n            duration & 0xFF, // duration\n            0x00, 0x00, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00, // reserved\n            0x00, 0x00, // layer\n            0x00, 0x00, // alternate_group\n            (volume>>0)&0xff, (((volume%1)*10)>>0)&0xff, // track volume // FIXME\n            0x00, 0x00, // reserved\n            0x00, 0x01, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00,\n            0x00, 0x01, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00,\n            0x00, 0x00, 0x00, 0x00,\n            0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\n            (width >> 8) & 0xFF,\n            width & 0xFF,\n            0x00, 0x00, // width\n            (height >> 8) & 0xFF,\n            height & 0xFF,\n            0x00, 0x00 // height\n        ]));\n    }\n\n    static traf(track,baseMediaDecodeTime) {\n        var sampleDependencyTable = MP4.sdtp(track),\n            id = track.id;\n        return MP4.box(MP4.types.traf,\n            MP4.box(MP4.types.tfhd, new Uint8Array([\n                0x00, // version 0\n                0x00, 0x00, 0x00, // flags\n                (id >> 24),\n                (id >> 16) & 0XFF,\n                (id >> 8) & 0XFF,\n                (id & 0xFF) // track_ID\n            ])),\n            MP4.box(MP4.types.tfdt, new Uint8Array([\n                0x00, // version 0\n                0x00, 0x00, 0x00, // flags\n                (baseMediaDecodeTime >>24),\n                (baseMediaDecodeTime >> 16) & 0XFF,\n                (baseMediaDecodeTime >> 8) & 0XFF,\n                (baseMediaDecodeTime & 0xFF) // baseMediaDecodeTime\n            ])),\n            MP4.trun(track,\n                sampleDependencyTable.length +\n                16 + // tfhd\n                16 + // tfdt\n                8 +  // traf header\n                16 + // mfhd\n                8 +  // moof header\n                8),  // mdat header\n            sampleDependencyTable);\n    }\n\n    /**\n     * Generate a track box.\n     * @param track {object} a track definition\n     * @return {Uint8Array} the track box\n     */\n    static trak(track) {\n        track.duration = track.duration || 0xffffffff;\n        return MP4.box(MP4.types.trak, MP4.tkhd(track), MP4.mdia(track));\n    }\n\n    static trex(track) {\n        var id = track.id;\n        return MP4.box(MP4.types.trex, new Uint8Array([\n            0x00, // version 0\n            0x00, 0x00, 0x00, // flags\n            (id >> 24),\n            (id >> 16) & 0XFF,\n            (id >> 8) & 0XFF,\n            (id & 0xFF), // track_ID\n            0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n            0x00, 0x00, 0x00, 0x00, // default_sample_duration\n            0x00, 0x00, 0x00, 0x00, // default_sample_size\n            0x00, 0x01, 0x00, 0x01 // default_sample_flags\n        ]));\n    }\n\n    static trun(track, offset) {\n        var samples= track.samples || [],\n            len = samples.length,\n            arraylen = 12 + (16 * len),\n            array = new Uint8Array(arraylen),\n            i,sample,duration,size,flags,cts;\n        offset += 8 + arraylen;\n        array.set([\n            0x00, // version 0\n            0x00, 0x0f, 0x01, // flags\n            (len >>> 24) & 0xFF,\n            (len >>> 16) & 0xFF,\n            (len >>> 8) & 0xFF,\n            len & 0xFF, // sample_count\n            (offset >>> 24) & 0xFF,\n            (offset >>> 16) & 0xFF,\n            (offset >>> 8) & 0xFF,\n            offset & 0xFF // data_offset\n        ],0);\n        for (i = 0; i < len; i++) {\n            sample = samples[i];\n            duration = sample.duration;\n            size = sample.size;\n            flags = sample.flags;\n            cts = sample.cts;\n            array.set([\n                (duration >>> 24) & 0xFF,\n                (duration >>> 16) & 0xFF,\n                (duration >>> 8) & 0xFF,\n                duration & 0xFF, // sample_duration\n                (size >>> 24) & 0xFF,\n                (size >>> 16) & 0xFF,\n                (size >>> 8) & 0xFF,\n                size & 0xFF, // sample_size\n                (flags.isLeading << 2) | flags.dependsOn,\n                (flags.isDependedOn << 6) |\n                (flags.hasRedundancy << 4) |\n                (flags.paddingValue << 1) |\n                flags.isNonSync,\n                flags.degradPrio & 0xF0 << 8,\n                flags.degradPrio & 0x0F, // sample_flags\n                (cts >>> 24) & 0xFF,\n                (cts >>> 16) & 0xFF,\n                (cts >>> 8) & 0xFF,\n                cts & 0xFF // sample_composition_time_offset\n            ],12+16*i);\n        }\n        return MP4.box(MP4.types.trun, array);\n    }\n\n    static initSegment(tracks, duration, timescale) {\n        if (!MP4.types) {\n            MP4.init();\n        }\n        var movie = MP4.moov(tracks, duration, timescale), result;\n        result = new Uint8Array(MP4.FTYP.byteLength + movie.byteLength);\n        result.set(MP4.FTYP);\n        result.set(movie, MP4.FTYP.byteLength);\n        return result;\n    }\n}\n","import {EventEmitter} from '../../deps/bp_event.js';\nimport {getTagged} from '../../deps/bp_logger.js';\n//import {MP4Inspect} from '../iso-bmff/mp4-inspector.js';\n\nconst LOG_TAG = \"mse\";\nconst Log = getTagged(LOG_TAG);\n\nexport class MSEBuffer {\n    constructor(parent, codec) {\n        this.mediaSource = parent.mediaSource;\n        this.players = parent.players;\n        this.cleaning = false;\n        this.parent = parent;\n        this.queue = [];\n        this.cleanResolvers = [];\n        this.codec = codec;\n        this.cleanRanges = [];\n\n        Log.debug(`Use codec: ${codec}`);\n\n        this.sourceBuffer = this.mediaSource.addSourceBuffer(codec);\n        this.eventSource = new EventEmitter(this.sourceBuffer);\n\n        this.eventSource.addEventListener('updatestart', (e)=> {\n            // this.updating = true;\n            // Log.debug('update start');\n            if (this.cleaning) {\n                Log.debug(`${this.codec} cleaning start`);\n            }\n        });\n\n        this.eventSource.addEventListener('update', (e)=> {\n            // this.updating = true;\n            if (this.cleaning) {\n                Log.debug(`${this.codec} cleaning update`);\n            }\n        });\n\n        this.eventSource.addEventListener('updateend', (e)=> {\n            // Log.debug('update end');\n            // this.updating = false;\n            if (this.cleaning) {\n                Log.debug(`${this.codec} cleaning end`);\n\n                try {\n                    if (this.sourceBuffer.buffered.length && this.players[0].currentTime < this.sourceBuffer.buffered.start(0)) {\n                        this.players[0].currentTime = this.sourceBuffer.buffered.start(0);\n                    }\n                } catch (e) {\n                    // TODO: do something?\n                }\n                while (this.cleanResolvers.length) {\n                    let resolver = this.cleanResolvers.shift();\n                    resolver();\n                }\n                this.cleaning = false;\n\n                if (this.cleanRanges.length) {\n                    this.doCleanup();\n                    return;\n                }\n            } else {\n                // Log.debug(`buffered: ${this.sourceBuffer.buffered.end(0)}, current ${this.players[0].currentTime}`);\n            }\n            this.feedNext();\n        });\n\n        this.eventSource.addEventListener('error', (e)=> {\n            Log.debug(`Source buffer error: ${this.mediaSource.readyState}`);\n            if (this.mediaSource.sourceBuffers.length) {\n                this.mediaSource.removeSourceBuffer(this.sourceBuffer);\n            }\n            this.parent.eventSource.dispatchEvent('error');\n        });\n\n        this.eventSource.addEventListener('abort', (e)=> {\n            Log.debug(`Source buffer aborted: ${this.mediaSource.readyState}`);\n            if (this.mediaSource.sourceBuffers.length) {\n                this.mediaSource.removeSourceBuffer(this.sourceBuffer);\n            }\n            this.parent.eventSource.dispatchEvent('error');\n        });\n\n        if (!this.sourceBuffer.updating) {\n            this.feedNext();\n        }\n        // TODO: cleanup every hour for live streams\n    }\n\n    destroy() {\n        this.eventSource.destroy();\n        this.clear();\n        this.queue = [];\n        this.mediaSource.removeSourceBuffer(this.sourceBuffer);\n    }\n\n    clear() {\n        this.queue = [];\n        let promises = [];\n        for (let i=0; i< this.sourceBuffer.buffered.length; ++i) {\n            // TODO: await remove\n            this.cleaning = true;\n            promises.push(new Promise((resolve, reject)=>{\n                this.cleanResolvers.push(resolve);\n                if (!this.sourceBuffer.updating) {\n                    this.sourceBuffer.remove(this.sourceBuffer.buffered.start(i), this.sourceBuffer.buffered.end(i));\n                    resolve();\n                } else {\n                    this.sourceBuffer.onupdateend = () => {\n                        if (this.sourceBuffer) {\n                            this.sourceBuffer.remove(this.sourceBuffer.buffered.start(i), this.sourceBuffer.buffered.end(i));\n                        }\n                        resolve();\n                    };\n                }\n            }));\n        }\n        return Promise.all(promises);\n    }\n\n    setLive(is_live) {\n        this.is_live = is_live;\n    }\n\n    feedNext() {\n        // Log.debug(\"feed next \", this.sourceBuffer.updating);\n        if (!this.sourceBuffer.updating && !this.cleaning && this.queue.length) {\n            this.doAppend(this.queue.shift());\n            // TODO: if is live and current position > 1hr => clean all and restart\n        }\n    }\n\n    doCleanup() {\n        if (!this.cleanRanges.length) {\n            this.cleaning = false;\n            this.feedNext();\n            return;\n        }\n        let range = this.cleanRanges.shift();\n        Log.debug(`${this.codec} remove range [${range[0]} - ${range[1]}). \n                    \\nUpdating: ${this.sourceBuffer.updating}\n                    `);\n        this.cleaning = true;\n        this.sourceBuffer.remove(range[0], range[1]);\n    }\n\n    initCleanup() {\n        if (this.sourceBuffer.buffered.length && !this.sourceBuffer.updating && !this.cleaning) {\n            Log.debug(`${this.codec} cleanup`);\n            let removeBound = this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1) - 2;\n\n            for (let i=0; i< this.sourceBuffer.buffered.length; ++i) {\n                let removeStart = this.sourceBuffer.buffered.start(i);\n                let removeEnd = this.sourceBuffer.buffered.end(i);\n                if ((this.players[0].currentTime <= removeStart) || (removeBound <= removeStart)) continue;\n\n                if ((removeBound <= removeEnd) && (removeBound >= removeStart)) {\n                    Log.debug(`Clear [${removeStart}, ${removeBound}), leave [${removeBound}, ${removeEnd}]`);\n                    removeEnd = removeBound;\n                    if (removeEnd!=removeStart) {\n                        this.cleanRanges.push([removeStart, removeEnd]);\n                    }\n                    continue; // Do not cleanup buffered range after current position\n                }\n                this.cleanRanges.push([removeStart, removeEnd]);\n            }\n\n            this.doCleanup();\n\n            // let bufferStart = this.sourceBuffer.buffered.start(0);\n            // let removeEnd = this.sourceBuffer.buffered.start(0) + (this.sourceBuffer.buffered.end(0) - this.sourceBuffer.buffered.start(0))/2;\n            // if (this.players[0].currentTime < removeEnd) {\n            //     this.players[0].currentTime = removeEnd;\n            // }\n            // let removeEnd = Math.max(this.players[0].currentTime - 3, this.sourceBuffer.buffered.end(0) - 3);\n            //\n            // if (removeEnd < bufferStart) {\n            //     removeEnd = this.sourceBuffer.buffered.start(0) + (this.sourceBuffer.buffered.end(0) - this.sourceBuffer.buffered.start(0))/2;\n            //     if (this.players[0].currentTime < removeEnd) {\n            //         this.players[0].currentTime = removeEnd;\n            //     }\n            // }\n\n            // if (removeEnd > bufferStart && (removeEnd - bufferStart > 0.5 )) {\n            //     // try {\n            //         Log.debug(`${this.codec} remove range [${bufferStart} - ${removeEnd}).\n            //         \\nBuffered end: ${this.sourceBuffer.buffered.end(0)}\n            //         \\nUpdating: ${this.sourceBuffer.updating}\n            //         `);\n            //         this.cleaning = true;\n            //         this.sourceBuffer.remove(bufferStart, removeEnd);\n            //     // } catch (e) {\n            //     //     // TODO: implement\n            //     //     Log.error(e);\n            //     // }\n            // } else {\n            //     this.feedNext();\n            // }\n        } else {\n            this.feedNext();\n        }\n    }\n\n    doAppend(data) {\n        // console.log(MP4Inspect.mp4toJSON(data));\n        let err = this.players[0].error;\n        if (err) {\n            Log.error(`Error occured: ${MSE.ErrorNotes[err.code]}`);\n            try {\n                this.players.forEach((video)=>{video.stop();});\n                this.mediaSource.endOfStream();\n            } catch (e){\n\n            }\n            this.parent.eventSource.dispatchEvent('error');\n        } else {\n            try {\n                this.sourceBuffer.appendBuffer(data);\n            } catch (e) {\n                if (e.name === 'QuotaExceededError') {\n                    Log.debug(`${this.codec} quota fail`);\n                    this.queue.unshift(data);\n                    this.initCleanup();\n                    return;\n                }\n\n                // reconnect on fail\n                Log.error(`Error occured while appending buffer. ${e.name}: ${e.message}`);\n                this.parent.eventSource.dispatchEvent('error');\n            }\n        }\n\n    }\n\n    feed(data) {\n        this.queue = this.queue.concat(data);\n        // Log.debug(this.sourceBuffer.updating, this.updating, this.queue.length);\n        if (this.sourceBuffer && !this.sourceBuffer.updating && !this.cleaning) {\n            // Log.debug('enq feed');\n            this.feedNext();\n        }\n    }\n}\n\nexport class MSE {\n    // static CODEC_AVC_BASELINE = \"avc1.42E01E\";\n    // static CODEC_AVC_MAIN = \"avc1.4D401E\";\n    // static CODEC_AVC_HIGH = \"avc1.64001E\";\n    // static CODEC_VP8 = \"vp8\";\n    // static CODEC_AAC = \"mp4a.40.2\";\n    // static CODEC_VORBIS = \"vorbis\";\n    // static CODEC_THEORA = \"theora\";\n\n    static get ErrorNotes() {return  {\n        [MediaError.MEDIA_ERR_ABORTED]: 'fetching process aborted by user',\n        [MediaError.MEDIA_ERR_NETWORK]: 'error occurred when downloading',\n        [MediaError.MEDIA_ERR_DECODE]: 'error occurred when decoding',\n        [MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED]: 'audio/video not supported'\n    }};\n\n    static isSupported(codecs) {\n        return (window.MediaSource && window.MediaSource.isTypeSupported(`video/mp4; codecs=\"${codecs.join(',')}\"`));\n    }\n\n    constructor (players) {\n        this.players = players;\n        const playing = this.players.map((video, idx) => {\n            video.onplaying = function () {\n                playing[idx] = true;\n            };\n            video.onpause = function () {\n                playing[idx] = false;\n            };\n            return !video.paused;\n        });\n        this.playing = playing;\n        this.mediaSource = new MediaSource();\n        this.eventSource = new EventEmitter(this.mediaSource);\n        this.reset();\n    }\n\n    destroy() {\n        this.reset();\n        this.eventSource.destroy();\n        this.mediaSource = null;\n        this.eventSource = null;\n    }\n\n    play() {\n        this.players.forEach((video, idx)=>{\n            if (video.paused && !this.playing[idx]) {\n                Log.debug(`player ${idx}: play`);\n                video.play();\n            }\n        });\n    }\n\n    setLive(is_live) {\n        for (let idx in this.buffers) {\n            this.buffers[idx].setLive(is_live);\n        }\n        this.is_live = is_live;\n    }\n\n    resetBuffers() {\n        this.players.forEach((video, idx)=>{\n            if (!video.paused && this.playing[idx]) {\n                video.pause();\n                video.currentTime = 0;\n            }\n        });\n\n        let promises = [];\n        for (let buffer of this.buffers.values()) {\n            promises.push(buffer.clear());\n        }\n        return Promise.all(promises).then(()=>{\n            this.mediaSource.endOfStream();\n            this.mediaSource.duration = 0;\n            this.mediaSource.clearLiveSeekableRange();\n            this.play();\n        });\n    }\n\n    clear() {\n        this.reset();\n        this.players.forEach((video)=>{video.src = URL.createObjectURL(this.mediaSource)});\n\n        return this.setupEvents();\n    }\n\n    setupEvents() {\n        this.eventSource.clear();\n        this.resolved = false;\n        this.mediaReady = new Promise((resolve, reject)=> {\n            this._sourceOpen = ()=> {\n                Log.debug(`Media source opened: ${this.mediaSource.readyState}`);\n                if (!this.resolved) {\n                    this.resolved = true;\n                    resolve();\n                }\n            };\n            this._sourceEnded = ()=>{\n                Log.debug(`Media source ended: ${this.mediaSource.readyState}`);\n            };\n            this._sourceClose = ()=>{\n                Log.debug(`Media source closed: ${this.mediaSource.readyState}`);\n                if (this.resolved) {\n                    this.eventSource.dispatchEvent('sourceclosed');\n                }\n            };\n            this.eventSource.addEventListener('sourceopen', this._sourceOpen);\n            this.eventSource.addEventListener('sourceended', this._sourceEnded);\n            this.eventSource.addEventListener('sourceclose', this._sourceClose);\n        });\n        return this.mediaReady;\n    }\n\n    reset() {\n        this.ready = false;\n        for (let track in this.buffers) {\n            this.buffers[track].destroy();\n            delete this.buffers[track];\n        }\n        if (this.mediaSource.readyState == 'open') {\n            this.mediaSource.duration = 0;\n            this.mediaSource.endOfStream();\n        }\n        this.updating = false;\n        this.resolved = false;\n        this.buffers = {};\n        // this.players.forEach((video)=>{video.src = URL.createObjectURL(this.mediaSource)});\n        // TODO: remove event listeners for existing media source\n        // this.setupEvents();\n        // this.clear();\n    }\n\n    setCodec(track, mimeCodec) {\n        return this.mediaReady.then(()=>{\n            this.buffers[track] = new MSEBuffer(this, mimeCodec);\n            this.buffers[track].setLive(this.is_live);\n        });\n    }\n\n    feed(track, data) {\n        if (this.buffers[track]) {\n            this.buffers[track].feed(data);\n        }\n    }\n}\n","import {getTagged} from '../../deps/bp_logger.js';\n\nconst Log = getTagged('remuxer:base');\nlet track_id = 1;\nexport class BaseRemuxer {\n\n    static get MP4_TIMESCALE() { return 90000;}\n\n    // TODO: move to ts parser\n    // static PTSNormalize(value, reference) {\n    //\n    //     let offset;\n    //     if (reference === undefined) {\n    //         return value;\n    //     }\n    //     if (reference < value) {\n    //         // - 2^33\n    //         offset = -8589934592;\n    //     } else {\n    //         // + 2^33\n    //         offset = 8589934592;\n    //     }\n    //     /* PTS is 33bit (from 0 to 2^33 -1)\n    //      if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\n    //      PTS looping occured. fill the gap */\n    //     while (Math.abs(value - reference) > 4294967296) {\n    //         value += offset;\n    //     }\n    //     return value;\n    // }\n\n    static getTrackID() {\n        return track_id++;\n    }\n\n    constructor(timescale, scaleFactor, params) {\n        this.timeOffset = 0;\n        this.timescale = timescale;\n        this.scaleFactor = scaleFactor;\n        this.readyToDecode = false;\n        this.samples = [];\n        this.seq = 1;\n        this.tsAlign = 1;\n    }\n\n    scaled(timestamp) {\n        return timestamp / this.scaleFactor;\n    }\n\n    unscaled(timestamp) {\n        return timestamp * this.scaleFactor;\n    }\n\n    remux(unit) {\n        if (unit) {\n            this.samples.push({\n                unit: unit,\n                pts: unit.pts,\n                dts: unit.dts\n            });\n            return true;\n        }\n        return false;\n    }\n\n    static toMS(timestamp) {\n        return timestamp/90;\n    }\n    \n    setConfig(config) {\n        \n    }\n\n    insertDscontinuity() {\n        this.samples.push(null);\n    }\n\n    init(initPTS, initDTS, shouldInitialize=true) {\n        this.initPTS = Math.min(initPTS, this.samples[0].dts /*- this.unscaled(this.timeOffset)*/);\n        this.initDTS = Math.min(initDTS, this.samples[0].dts /*- this.unscaled(this.timeOffset)*/);\n        Log.debug(`Initial pts=${this.initPTS} dts=${this.initDTS} offset=${this.unscaled(this.timeOffset)}`);\n        this.initialized = shouldInitialize;\n    }\n\n    flush() {\n        this.seq++;\n        this.mp4track.len = 0;\n        this.mp4track.samples = [];\n    }\n\n    static dtsSortFunc(a,b) {\n        return (a.dts-b.dts);\n    }\n\n    getPayloadBase(sampleFunction, setupSample) {\n        if (!this.readyToDecode || !this.initialized || !this.samples.length) return null;\n        this.samples.sort(BaseRemuxer.dtsSortFunc);\n        return true;\n        //\n        // let payload = new Uint8Array(this.mp4track.len);\n        // let offset = 0;\n        // let samples=this.mp4track.samples;\n        // let mp4Sample, lastDTS, pts, dts;\n        //\n        // while (this.samples.length) {\n        //     let sample = this.samples.shift();\n        //     if (sample === null) {\n        //         // discontinuity\n        //         this.nextDts = undefined;\n        //         break;\n        //     }\n        //\n        //     let unit = sample.unit;\n        //\n        //     pts = Math.round((sample.pts - this.initDTS)/this.tsAlign)*this.tsAlign;\n        //     dts = Math.round((sample.dts - this.initDTS)/this.tsAlign)*this.tsAlign;\n        //     // ensure DTS is not bigger than PTS\n        //     dts = Math.min(pts, dts);\n        //\n        //     // sampleFunction(pts, dts);   // TODO:\n        //\n        //     // mp4Sample = setupSample(unit, pts, dts);    // TODO:\n        //\n        //     payload.set(unit.getData(), offset);\n        //     offset += unit.getSize();\n        //\n        //     samples.push(mp4Sample);\n        //     lastDTS = dts;\n        // }\n        // if (!samples.length) return null;\n        //\n        // // samplesPostFunction(samples); // TODO:\n        //\n        // return new Uint8Array(payload.buffer, 0, this.mp4track.len);\n    }\n}","import {getTagged} from '../../deps/bp_logger.js';\nimport {MSE} from '../presentation/mse.js';\nimport {BaseRemuxer} from './base.js';\n\nconst Log = getTagged(\"remuxer:aac\");\n// TODO: asm.js\nexport class AACRemuxer extends BaseRemuxer {\n\n    constructor(timescale, scaleFactor = 1, params={}) {\n        super(timescale, scaleFactor);\n\n        this.codecstring=MSE.CODEC_AAC;\n        this.units = [];\n        this.initDTS = undefined;\n        this.nextAacPts = undefined;\n        this.lastPts = 0;\n        this.firstDTS = 0;\n        this.firstPTS = 0;\n        this.duration = params.duration || 1;\n        this.initialized = false;\n\n        this.mp4track={\n            id:BaseRemuxer.getTrackID(),\n            type: 'audio',\n            fragmented:true,\n            channelCount:0,\n            audiosamplerate: this.timescale,\n            duration: 0,\n            timescale: this.timescale,\n            volume: 1,\n            samples: [],\n            config: '',\n            len: 0\n        };\n        if (params.config) {\n            this.setConfig(params.config);\n        }\n    }\n\n    setConfig(config) {\n        this.mp4track.channelCount = config.channels;\n        this.mp4track.audiosamplerate = config.samplerate;\n        if (!this.mp4track.duration) {\n            this.mp4track.duration = (this.duration?this.duration:1)*config.samplerate;\n        }\n        this.mp4track.timescale = config.samplerate;\n        this.mp4track.config = config.config;\n        this.mp4track.codec = config.codec;\n        this.timescale = config.samplerate;\n        this.scaleFactor = BaseRemuxer.MP4_TIMESCALE / config.samplerate;\n        this.expectedSampleDuration = 1024 * this.scaleFactor;\n        this.readyToDecode = true;\n    }\n\n    remux(aac) {\n        if (super.remux.call(this, aac)) {\n            this.mp4track.len += aac.getSize();\n        }\n    }\n\n    getPayload() {\n        if (!this.readyToDecode || !this.samples.length) return null;\n        this.samples.sort(function(a, b) {\n            return (a.dts-b.dts);\n        });\n\n        let payload = new Uint8Array(this.mp4track.len);\n        let offset = 0;\n        let samples=this.mp4track.samples;\n        let mp4Sample, lastDTS, pts, dts;\n\n        while (this.samples.length) {\n            let sample = this.samples.shift();\n            if (sample === null) {\n                // discontinuity\n                this.nextDts = undefined;\n                break;\n            }\n            let unit = sample.unit;\n            pts = sample.pts - this.initDTS;\n            dts = sample.dts - this.initDTS;\n\n            if (lastDTS === undefined) {\n                if (this.nextDts) {\n                    let delta = Math.round(this.scaled(pts - this.nextAacPts));\n                    // if fragment are contiguous, or delta less than 600ms, ensure there is no overlap/hole between fragments\n                    if (/*contiguous || */Math.abs(delta) < 600) {\n                        // log delta\n                        if (delta) {\n                            if (delta > 0) {\n                                Log.log(`${delta} ms hole between AAC samples detected,filling it`);\n                                // if we have frame overlap, overlapping for more than half a frame duraion\n                            } else if (delta < -12) {\n                                // drop overlapping audio frames... browser will deal with it\n                                Log.log(`${(-delta)} ms overlapping between AAC samples detected, drop frame`);\n                                this.mp4track.len -= unit.getSize();\n                                continue;\n                            }\n                            // set DTS to next DTS\n                            pts = dts = this.nextAacPts;\n                        }\n                    }\n                }\n                // remember first PTS of our aacSamples, ensure value is positive\n                this.firstDTS = Math.max(0, dts);\n            }\n\n            mp4Sample = {\n                size: unit.getSize(),\n                cts: 0,\n                duration:1024,\n                flags: {\n                    isLeading: 0,\n                    isDependedOn: 0,\n                    hasRedundancy: 0,\n                    degradPrio: 0,\n                    dependsOn: 1\n                }\n            };\n\n            payload.set(unit.getData(), offset);\n            offset += unit.getSize();\n            samples.push(mp4Sample);\n            lastDTS = dts;\n        }\n        if (!samples.length) return null;\n        this.nextDts =pts+this.expectedSampleDuration;\n        return new Uint8Array(payload.buffer, 0, this.mp4track.len);\n    }\n}\n//test.bundle.js:42 [remuxer:h264] skip frame from the past at DTS=18397972271140676 with expected DTS=18397998040950484","/**\n * Parser for exponential Golomb codes, a variable-bitwidth number encoding scheme used by h264.\n*/\n// TODO: asm.js\nimport {Log as logger} from '../../deps/bp_logger.js';\n\nexport class ExpGolomb {\n\n  constructor(data) {\n    this.data = data;\n    // the number of bytes left to examine in this.data\n    this.bytesAvailable = this.data.byteLength;\n    // the current word being examined\n    this.word = 0; // :uint\n    // the number of bits left to examine in the current word\n    this.bitsAvailable = 0; // :uint\n  }\n\n  // ():void\n  loadWord() {\n    var\n      position = this.data.byteLength - this.bytesAvailable,\n      workingBytes = new Uint8Array(4),\n      availableBytes = Math.min(4, this.bytesAvailable);\n    if (availableBytes === 0) {\n      throw new Error('no bytes available');\n    }\n    workingBytes.set(this.data.subarray(position, position + availableBytes));\n    this.word = new DataView(workingBytes.buffer, workingBytes.byteOffset, workingBytes.byteLength).getUint32(0);\n    // track the amount of this.data that has been processed\n    this.bitsAvailable = availableBytes * 8;\n    this.bytesAvailable -= availableBytes;\n  }\n\n  // (count:int):void\n  skipBits(count) {\n    var skipBytes; // :int\n    if (this.bitsAvailable > count) {\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    } else {\n      count -= this.bitsAvailable;\n      skipBytes = count >> 3;\n      count -= (skipBytes << 3);\n      this.bytesAvailable -= skipBytes;\n      this.loadWord();\n      this.word <<= count;\n      this.bitsAvailable -= count;\n    }\n  }\n\n  // (size:int):uint\n  readBits(size) {\n    var\n      bits = Math.min(this.bitsAvailable, size), // :uint\n      valu = this.word >>> (32 - bits); // :uint\n    if (size > 32) {\n      logger.error('Cannot read more than 32 bits at a time');\n    }\n    this.bitsAvailable -= bits;\n    if (this.bitsAvailable > 0) {\n      this.word <<= bits;\n    } else if (this.bytesAvailable > 0) {\n      this.loadWord();\n    }\n    bits = size - bits;\n    if (bits > 0) {\n      return valu << bits | this.readBits(bits);\n    } else {\n      return valu;\n    }\n  }\n\n  // ():uint\n  skipLZ() {\n    var leadingZeroCount; // :uint\n    for (leadingZeroCount = 0; leadingZeroCount < this.bitsAvailable; ++leadingZeroCount) {\n      if (0 !== (this.word & (0x80000000 >>> leadingZeroCount))) {\n        // the first bit of working word is 1\n        this.word <<= leadingZeroCount;\n        this.bitsAvailable -= leadingZeroCount;\n        return leadingZeroCount;\n      }\n    }\n    // we exhausted word and still have not found a 1\n    this.loadWord();\n    return leadingZeroCount + this.skipLZ();\n  }\n\n  // ():void\n  skipUEG() {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():void\n  skipEG() {\n    this.skipBits(1 + this.skipLZ());\n  }\n\n  // ():uint\n  readUEG() {\n    var clz = this.skipLZ(); // :uint\n    return this.readBits(clz + 1) - 1;\n  }\n\n  // ():int\n  readEG() {\n    var valu = this.readUEG(); // :int\n    if (0x01 & valu) {\n      // the number is odd if the low order bit is set\n      return (1 + valu) >>> 1; // add 1 to make it even, and divide by 2\n    } else {\n      return -1 * (valu >>> 1); // divide by two then make it negative\n    }\n  }\n\n  // Some convenience functions\n  // :Boolean\n  readBoolean() {\n    return 1 === this.readBits(1);\n  }\n\n  // ():int\n  readUByte() {\n    return this.readBits(8);\n  }\n\n  // ():int\n  readUShort() {\n    return this.readBits(16);\n  }\n    // ():int\n  readUInt() {\n    return this.readBits(32);\n  }  \n}\n","// TODO: asm.js\n\nexport function appendByteArray(buffer1, buffer2) {\n    let tmp = new Uint8Array((buffer1.byteLength|0) + (buffer2.byteLength|0));\n    tmp.set(buffer1, 0);\n    tmp.set(buffer2, buffer1.byteLength|0);\n    return tmp;\n}\n\nexport function appendByteArrayAsync(buffer1, buffer2) {\n    return new Promise((resolve, reject)=>{\n        let blob = new Blob([buffer1, buffer2]);\n        let reader = new FileReader();\n        reader.addEventListener(\"loadend\", function() {\n            resolve();\n        });\n        reader.readAsArrayBuffer(blob);\n    });\n}\nexport function base64ToArrayBuffer(base64) {\n    var binary_string =  window.atob(base64);\n    var len = binary_string.length;\n    var bytes = new Uint8Array( len );\n    for (var i = 0; i < len; i++)        {\n        bytes[i] = binary_string.charCodeAt(i);\n    }\n    return bytes.buffer;\n}\n\nexport function hexToByteArray(hex) {\n    let len = hex.length >> 1;\n    var bufView = new Uint8Array(len);\n    for (var i = 0; i < len; i++) {\n        bufView[i] = parseInt(hex.substr(i<<1,2),16);\n    }\n    return bufView;\n}\n\nexport function concatenate(resultConstructor, ...arrays) {\n    let totalLength = 0;\n    for (let arr of arrays) {\n        totalLength += arr.length;\n    }\n    let result = new resultConstructor(totalLength);\n    let offset = 0;\n    for (let arr of arrays) {\n        result.set(arr, offset);\n        offset += arr.length;\n    }\n    return result;\n}\n\nexport function bitSlice(bytearray, start=0, end=bytearray.byteLength*8) {\n    let byteLen = Math.ceil((end-start)/8);\n    let res = new Uint8Array(byteLen);\n    let startByte = start >>> 3;   // /8\n    let endByte = (end>>>3) - 1;    // /8\n    let bitOffset = start & 0x7;     // %8\n    let nBitOffset = 8 - bitOffset;\n    let endOffset = 8 - end & 0x7;   // %8\n    for (let i=0; i<byteLen; ++i) {\n        let tail = 0;\n        if (i<endByte) {\n            tail = bytearray[startByte+i+1] >> nBitOffset;\n            if (i == endByte-1 && endOffset < 8) {\n                tail >>= endOffset;\n                tail <<= endOffset;\n            }\n        }\n        res[i]=(bytearray[startByte+i]<<bitOffset) | tail;\n    }\n    return res;\n}\n\nexport class BitArray {\n\n    constructor(src) {\n        this.src    = new DataView(src.buffer, src.byteOffset, src.byteLength);\n        this.bitpos = 0;\n        this.byte   = this.src.getUint8(0); /* This should really be undefined, uint wont allow it though */\n        this.bytepos = 0;\n    }\n\n    readBits(length) {\n        if (32 < (length|0) || 0 === (length|0)) {\n            /* To big for an uint */\n            throw new Error(\"too big\");\n        }\n\n        let result = 0;\n        for (let i = length; i > 0; --i) {\n\n            /* Shift result one left to make room for another bit,\n             then add the next bit on the stream. */\n            result = ((result|0) << 1) | (((this.byte|0) >> (8 - (++this.bitpos))) & 0x01);\n            if ((this.bitpos|0)>=8) {\n                this.byte = this.src.getUint8(++this.bytepos);\n                this.bitpos &= 0x7;\n            }\n        }\n\n        return result;\n    }\n    skipBits(length) {\n        this.bitpos += (length|0) & 0x7; // %8\n        this.bytepos += (length|0) >>> 3;  // *8\n        if (this.bitpos > 7) {\n            this.bitpos &= 0x7;\n            ++this.bytepos;\n        }\n\n        if (!this.finished()) {\n            this.byte = this.src.getUint8(this.bytepos);\n            return 0;\n        } else {\n            return this.bytepos-this.src.byteLength-this.src.bitpos;\n        }\n    }\n    \n    finished() {\n        return this.bytepos >= this.src.byteLength;\n    }\n}","import {appendByteArray} from '../util/binary.js';\n\nexport class NALU {\n\n    static get NDR() {return 1;}\n    static get SLICE_PART_A() {return 2;}\n    static get SLICE_PART_B() {return 3;}\n    static get SLICE_PART_C() {return 4;}\n    static get IDR() {return 5;}\n    static get SEI() {return 6;}\n    static get SPS() {return 7;}\n    static get PPS() {return 8;}\n    static get DELIMITER() {return 9;}\n    static get EOSEQ() {return 10;}\n    static get EOSTR() {return 11;}\n    static get FILTER() {return 12;}\n    static get STAP_A() {return 24;}\n    static get STAP_B() {return 25;}\n    static get FU_A() {return 28;}\n    static get FU_B() {return 29;}\n\n    static get TYPES() {return {\n        [NALU.IDR]: 'IDR',\n        [NALU.SEI]: 'SEI',\n        [NALU.SPS]: 'SPS',\n        [NALU.PPS]: 'PPS',\n        [NALU.NDR]: 'NDR'\n    }};\n\n    static type(nalu) {\n        if (nalu.ntype in NALU.TYPES) {\n            return NALU.TYPES[nalu.ntype];\n        } else {\n            return 'UNKNOWN';\n        }\n    }\n\n    constructor(ntype, nri, data, dts, pts) {\n\n        this.data = data;\n        this.ntype = ntype;\n        this.nri = nri;\n        this.dts = dts;\n        this.pts = pts ? pts : this.dts;\n        this.sliceType = null;\n    }\n\n    appendData(idata) {\n        this.data = appendByteArray(this.data, idata);\n    }\n\n    toString() {\n        return `${NALU.type(this)}(${this.data.byteLength}): NRI: ${this.getNri()}, PTS: ${this.pts}, DTS: ${this.dts}`;\n    }\n\n    getNri() {\n        return this.nri >> 5;\n    }\n\n    type() {\n        return this.ntype;\n    }\n\n    isKeyframe() {\n        return this.ntype === NALU.IDR || this.sliceType === 7;\n    }\n\n    getSize() {\n        return 4 + 1 + this.data.byteLength;\n    }\n\n    getData() {\n        let header = new Uint8Array(5 + this.data.byteLength);\n        let view = new DataView(header.buffer);\n        view.setUint32(0, this.data.byteLength + 1);\n        view.setUint8(4, (0x0 & 0x80) | (this.nri & 0x60) | (this.ntype & 0x1F));\n        header.set(this.data, 5);\n        return header;\n    }\n}\n","import {ExpGolomb} from '../util/exp-golomb.js';\nimport {NALU} from '../elementary/NALU.js';\n\nexport class H264Parser {\n\n    constructor(remuxer) {\n        this.remuxer = remuxer;\n        this.track = remuxer.mp4track;\n        this.firstFound = false;\n    }\n\n    msToScaled(timestamp) {\n        return (timestamp - this.remuxer.timeOffset) * this.remuxer.scaleFactor;\n    }\n\n    parseSPS(sps) {\n        var config = H264Parser.readSPS(new Uint8Array(sps));\n\n        this.track.width = config.width;\n        this.track.height = config.height;\n        this.track.sps = [new Uint8Array(sps)];\n        // this.track.timescale = this.remuxer.timescale;\n        // this.track.duration = this.remuxer.timescale; // TODO: extract duration for non-live client\n        this.track.codec = 'avc1.';\n\n        let codecarray = new DataView(sps.buffer, sps.byteOffset+1, 4);\n        for (let i = 0; i < 3; ++i) {\n            var h = codecarray.getUint8(i).toString(16);\n            if (h.length < 2) {\n                h = '0' + h;\n            }\n            this.track.codec  += h;\n        }\n    }\n\n    parsePPS(pps) {\n        this.track.pps = [new Uint8Array(pps)];\n    }\n\n    parseNAL(unit) {\n        if (!unit) return false;\n        \n        let push = null;\n        // console.log(unit.toString());\n        switch (unit.type()) {\n            case NALU.NDR:\n            case NALU.IDR:\n                unit.sliceType = H264Parser.parceSliceHeader(unit.data);\n                if (unit.isKeyframe() && !this.firstFound)  {\n                    this.firstFound = true;\n                }\n                if (this.firstFound) {\n                    push = true;\n                } else {\n                    push = false;\n                }\n                break;\n            case NALU.PPS:\n                push = false;\n                if (!this.track.pps) {\n                    this.parsePPS(unit.getData().subarray(4));\n                    if (!this.remuxer.readyToDecode && this.track.pps && this.track.sps) {\n                        this.remuxer.readyToDecode = true;\n                    }\n                }\n                break;\n            case NALU.SPS:\n                push = false;\n                if(!this.track.sps) {\n                    this.parseSPS(unit.getData().subarray(4));\n                    if (!this.remuxer.readyToDecode && this.track.pps && this.track.sps) {\n                        this.remuxer.readyToDecode = true;\n                    }\n                }\n                break;\n            case NALU.SEI:\n                push = false;\n                let data = new DataView(unit.data.buffer, unit.data.byteOffset, unit.data.byteLength);\n                let byte_idx = 0;\n                let pay_type = data.getUint8(byte_idx);\n                ++byte_idx;\n                let pay_size = 0;\n                let sz = data.getUint8(byte_idx);\n                ++byte_idx;\n                while (sz === 255) {\n                    pay_size+=sz;\n                    sz = data.getUint8(byte_idx);\n                    ++byte_idx;\n                }\n                pay_size+=sz;\n\n                let uuid = unit.data.subarray(byte_idx, byte_idx+16);\n                byte_idx+=16;\n                console.log(`PT: ${pay_type}, PS: ${pay_size}, UUID: ${Array.from(uuid).map(function(i) {\n                    return ('0' + i.toString(16)).slice(-2);\n                }).join('')}`);\n                // debugger;\n                break;\n            case NALU.EOSEQ:\n            case NALU.EOSTR:\n                push = false;\n            default:\n        }\n        if (push === null && unit.getNri() > 0 ) {\n            push=true;\n        }\n        return push;\n    }\n\n    static parceSliceHeader(data) {\n        let decoder = new ExpGolomb(data);\n        let first_mb = decoder.readUEG();\n        let slice_type = decoder.readUEG();\n        let ppsid = decoder.readUEG();\n        let frame_num = decoder.readUByte();\n        // console.log(`first_mb: ${first_mb}, slice_type: ${slice_type}, ppsid: ${ppsid}, frame_num: ${frame_num}`);\n        return slice_type;\n    }\n\n    /**\n     * Advance the ExpGolomb decoder past a scaling list. The scaling\n     * list is optionally transmitted as part of a sequence parameter\n     * set and is not relevant to transmuxing.\n     * @param decoder {ExpGolomb} exp golomb decoder\n     * @param count {number} the number of entries in this scaling list\n     * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\n     */\n    static skipScalingList(decoder, count) {\n        let lastScale = 8,\n            nextScale = 8,\n            deltaScale;\n        for (let j = 0; j < count; j++) {\n            if (nextScale !== 0) {\n                deltaScale = decoder.readEG();\n                nextScale = (lastScale + deltaScale + 256) % 256;\n            }\n            lastScale = (nextScale === 0) ? lastScale : nextScale;\n        }\n    }\n\n    /**\n     * Read a sequence parameter set and return some interesting video\n     * properties. A sequence parameter set is the H264 metadata that\n     * describes the properties of upcoming video frames.\n     * @param data {Uint8Array} the bytes of a sequence parameter set\n     * @return {object} an object with configuration parsed from the\n     * sequence parameter set, including the dimensions of the\n     * associated video frames.\n     */\n    static readSPS(data) {\n        let decoder = new ExpGolomb(data);\n        let frameCropLeftOffset = 0,\n            frameCropRightOffset = 0,\n            frameCropTopOffset = 0,\n            frameCropBottomOffset = 0,\n            sarScale = 1,\n            profileIdc,profileCompat,levelIdc,\n            numRefFramesInPicOrderCntCycle, picWidthInMbsMinus1,\n            picHeightInMapUnitsMinus1,\n            frameMbsOnlyFlag,\n            scalingListCount;\n        decoder.readUByte();\n        profileIdc = decoder.readUByte(); // profile_idc\n        profileCompat = decoder.readBits(5); // constraint_set[0-4]_flag, u(5)\n        decoder.skipBits(3); // reserved_zero_3bits u(3),\n        levelIdc = decoder.readUByte(); //level_idc u(8)\n        decoder.skipUEG(); // seq_parameter_set_id\n        // some profiles have more optional data we don't need\n        if (profileIdc === 100 ||\n            profileIdc === 110 ||\n            profileIdc === 122 ||\n            profileIdc === 244 ||\n            profileIdc === 44  ||\n            profileIdc === 83  ||\n            profileIdc === 86  ||\n            profileIdc === 118 ||\n            profileIdc === 128) {\n            var chromaFormatIdc = decoder.readUEG();\n            if (chromaFormatIdc === 3) {\n                decoder.skipBits(1); // separate_colour_plane_flag\n            }\n            decoder.skipUEG(); // bit_depth_luma_minus8\n            decoder.skipUEG(); // bit_depth_chroma_minus8\n            decoder.skipBits(1); // qpprime_y_zero_transform_bypass_flag\n            if (decoder.readBoolean()) { // seq_scaling_matrix_present_flag\n                scalingListCount = (chromaFormatIdc !== 3) ? 8 : 12;\n                for (let i = 0; i < scalingListCount; ++i) {\n                    if (decoder.readBoolean()) { // seq_scaling_list_present_flag[ i ]\n                        if (i < 6) {\n                            H264Parser.skipScalingList(decoder, 16);\n                        } else {\n                            H264Parser.skipScalingList(decoder, 64);\n                        }\n                    }\n                }\n            }\n        }\n        decoder.skipUEG(); // log2_max_frame_num_minus4\n        var picOrderCntType = decoder.readUEG();\n        if (picOrderCntType === 0) {\n            decoder.readUEG(); //log2_max_pic_order_cnt_lsb_minus4\n        } else if (picOrderCntType === 1) {\n            decoder.skipBits(1); // delta_pic_order_always_zero_flag\n            decoder.skipEG(); // offset_for_non_ref_pic\n            decoder.skipEG(); // offset_for_top_to_bottom_field\n            numRefFramesInPicOrderCntCycle = decoder.readUEG();\n            for(let i = 0; i < numRefFramesInPicOrderCntCycle; ++i) {\n                decoder.skipEG(); // offset_for_ref_frame[ i ]\n            }\n        }\n        decoder.skipUEG(); // max_num_ref_frames\n        decoder.skipBits(1); // gaps_in_frame_num_value_allowed_flag\n        picWidthInMbsMinus1 = decoder.readUEG();\n        picHeightInMapUnitsMinus1 = decoder.readUEG();\n        frameMbsOnlyFlag = decoder.readBits(1);\n        if (frameMbsOnlyFlag === 0) {\n            decoder.skipBits(1); // mb_adaptive_frame_field_flag\n        }\n        decoder.skipBits(1); // direct_8x8_inference_flag\n        if (decoder.readBoolean()) { // frame_cropping_flag\n            frameCropLeftOffset = decoder.readUEG();\n            frameCropRightOffset = decoder.readUEG();\n            frameCropTopOffset = decoder.readUEG();\n            frameCropBottomOffset = decoder.readUEG();\n        }\n        if (decoder.readBoolean()) {\n            // vui_parameters_present_flag\n            if (decoder.readBoolean()) {\n                // aspect_ratio_info_present_flag\n                let sarRatio;\n                const aspectRatioIdc = decoder.readUByte();\n                switch (aspectRatioIdc) {\n                    case 1: sarRatio = [1,1]; break;\n                    case 2: sarRatio = [12,11]; break;\n                    case 3: sarRatio = [10,11]; break;\n                    case 4: sarRatio = [16,11]; break;\n                    case 5: sarRatio = [40,33]; break;\n                    case 6: sarRatio = [24,11]; break;\n                    case 7: sarRatio = [20,11]; break;\n                    case 8: sarRatio = [32,11]; break;\n                    case 9: sarRatio = [80,33]; break;\n                    case 10: sarRatio = [18,11]; break;\n                    case 11: sarRatio = [15,11]; break;\n                    case 12: sarRatio = [64,33]; break;\n                    case 13: sarRatio = [160,99]; break;\n                    case 14: sarRatio = [4,3]; break;\n                    case 15: sarRatio = [3,2]; break;\n                    case 16: sarRatio = [2,1]; break;\n                    case 255: {\n                        sarRatio = [decoder.readUByte() << 8 | decoder.readUByte(), decoder.readUByte() << 8 | decoder.readUByte()];\n                        break;\n                    }\n                }\n                if (sarRatio) {\n                    sarScale = sarRatio[0] / sarRatio[1];\n                }\n            }\n            if (decoder.readBoolean()) {decoder.skipBits(1);}\n\n            if (decoder.readBoolean()) {\n                decoder.skipBits(4);\n                if (decoder.readBoolean()) {\n                    decoder.skipBits(24);\n                }\n            }\n            if (decoder.readBoolean()) {\n                decoder.skipUEG();\n                decoder.skipUEG();\n            }\n            if (decoder.readBoolean()) {\n                let unitsInTick = decoder.readUInt();\n                let timeScale = decoder.readUInt();\n                let fixedFrameRate = decoder.readBoolean();\n                let frameDuration = timeScale/(2*unitsInTick);\n                console.log(`timescale: ${timeScale}; unitsInTick: ${unitsInTick}; fixedFramerate: ${fixedFrameRate}; avgFrameDuration: ${frameDuration}`);\n            }\n        }\n        return {\n            width: Math.ceil((((picWidthInMbsMinus1 + 1) * 16) - frameCropLeftOffset * 2 - frameCropRightOffset * 2) * sarScale),\n            height: ((2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16) - ((frameMbsOnlyFlag? 2 : 4) * (frameCropTopOffset + frameCropBottomOffset))\n        };\n    }\n\n    static readSliceType(decoder) {\n        // skip NALu type\n        decoder.readUByte();\n        // discard first_mb_in_slice\n        decoder.readUEG();\n        // return slice_type\n        return decoder.readUEG();\n    }\n}","import {getTagged} from '../../deps/bp_logger.js';\nimport {H264Parser} from '../parsers/h264.js';\nimport {BaseRemuxer} from './base.js';\n\nconst Log = getTagged(\"remuxer:h264\"); \n// TODO: asm.js\nexport class H264Remuxer extends BaseRemuxer {\n\n    constructor(timescale, scaleFactor=1, params={}) {\n        super(timescale, scaleFactor);\n\n        this.nextDts = undefined;\n        this.readyToDecode = false;\n        this.initialized = false;\n\n        this.firstDTS=0;\n        this.firstPTS=0;\n        this.lastDTS=undefined;\n        this.lastSampleDuration = 0;\n        this.lastDurations = [];\n        // this.timescale = 90000;\n        this.tsAlign = Math.round(this.timescale/60);\n\n        this.mp4track={\n            id:BaseRemuxer.getTrackID(),\n            type: 'video',\n            len:0,\n            fragmented:true,\n            sps:'',\n            pps:'',\n            width:0,\n            height:0,\n            timescale: timescale,\n            duration: timescale,\n            samples: []\n        };\n        this.samples = [];\n        this.lastGopDTS = -99999999999999;\n        this.gop=[];\n        this.firstUnit = true;\n\n        this.h264 = new H264Parser(this);\n\n        if (params.sps) {\n            let arr = new Uint8Array(params.sps);\n            if ((arr[0] & 0x1f) === 7) {\n                this.setSPS(arr);\n            } else {\n                Log.warn(\"bad SPS in SDP\")\n            }\n        }\n        if (params.pps) {\n            let arr = new Uint8Array(params.pps);\n            if ((arr[0] & 0x1f) === 8) {\n                this.setPPS(arr);\n            } else {\n                Log.warn(\"bad PPS in SDP\")\n            }\n        }\n\n        if (this.mp4track.pps && this.mp4track.sps) {\n            this.readyToDecode = true;\n        }\n    }\n\n    _scaled(timestamp) {\n        return timestamp >>> this.scaleFactor;\n    }\n\n    _unscaled(timestamp) {\n        return timestamp << this.scaleFactor;\n    }\n\n    setSPS(sps) {\n        this.h264.parseSPS(sps);\n    }\n\n    setPPS(pps) {\n        this.h264.parsePPS(pps);\n    }\n\n    remux(nalu) {\n        if (this.lastGopDTS < nalu.dts) {\n            this.gop.sort(BaseRemuxer.dtsSortFunc);\n            for (let unit of this.gop) {\n                // if (this.firstUnit) {\n                //     unit.ntype = 5;//NALU.IDR;\n                //     this.firstUnit = false;\n                // }\n                if (super.remux.call(this, unit)) {\n                    this.mp4track.len += unit.getSize();\n                }\n            }\n            this.gop = [];\n            this.lastGopDTS = nalu.dts\n        }\n        if (this.h264.parseNAL(nalu)) {\n            this.gop.push(nalu);\n        }\n    }\n\n    getPayload() {\n        if (!this.getPayloadBase()) {\n            return null;\n        }\n\n        let payload = new Uint8Array(this.mp4track.len);\n        let offset = 0;\n        let samples=this.mp4track.samples;\n        let mp4Sample, lastDTS, pts, dts;\n\n\n        // Log.debug(this.samples.map((e)=>{\n        //     return Math.round((e.dts - this.initDTS));\n        // }));\n\n        // let minDuration = Number.MAX_SAFE_INTEGER;\n        while (this.samples.length) {\n            let sample = this.samples.shift();\n            if (sample === null) {\n                // discontinuity\n                this.nextDts = undefined;\n                break;\n            }\n\n            let unit = sample.unit;\n            \n            pts = sample.pts- this.initDTS; // /*Math.round(*/(sample.pts - this.initDTS)/*/this.tsAlign)*this.tsAlign*/;\n            dts = sample.dts - this.initDTS; ///*Math.round(*/(sample.dts - this.initDTS)/*/this.tsAlign)*this.tsAlign*/;\n            // ensure DTS is not bigger than PTS\n            dts = Math.min(pts,dts);\n            // if not first AVC sample of video track, normalize PTS/DTS with previous sample value\n            // and ensure that sample duration is positive\n            if (lastDTS !== undefined) {\n                let sampleDuration = this.scaled(dts - lastDTS);\n                // Log.debug(`Sample duration: ${sampleDuration}`);\n                if (sampleDuration < 0) {\n                    Log.log(`invalid AVC sample duration at PTS/DTS: ${pts}/${dts}|lastDTS: ${lastDTS}:${sampleDuration}`);\n                    this.mp4track.len -= unit.getSize();\n                    continue;\n                }\n                // minDuration = Math.min(sampleDuration, minDuration);\n                this.lastDurations.push(sampleDuration);\n                if (this.lastDurations.length > 100) {\n                    this.lastDurations.shift();\n                }\n                mp4Sample.duration = sampleDuration;\n            } else {\n                if (this.nextDts) {\n                    let delta = dts - this.nextDts;\n                    // if fragment are contiguous, or delta less than 600ms, ensure there is no overlap/hole between fragments\n                    if (/*contiguous ||*/ Math.abs(Math.round(BaseRemuxer.toMS(delta))) < 600) {\n\n                        if (delta) {\n                            // set DTS to next DTS\n                            // Log.debug(`Video/PTS/DTS adjusted: ${pts}->${Math.max(pts - delta, this.nextDts)}/${dts}->${this.nextDts},delta:${delta}`);\n                            dts = this.nextDts;\n                            // offset PTS as well, ensure that PTS is smaller or equal than new DTS\n                            pts = Math.max(pts - delta, dts);\n                        }\n                    } else {\n                        if (delta < 0) {\n                            Log.log(`skip frame from the past at DTS=${dts} with expected DTS=${this.nextDts}`);\n                            this.mp4track.len -= unit.getSize();\n                            continue;\n                        }\n                    }\n                }\n                // remember first DTS of our avcSamples, ensure value is positive\n                this.firstDTS = Math.max(0, dts);\n            }\n\n            mp4Sample = {\n                size: unit.getSize(),\n                duration: 0,\n                cts: this.scaled(pts - dts),\n                flags: {\n                    isLeading: 0,\n                    isDependedOn: 0,\n                    hasRedundancy: 0,\n                    degradPrio: 0\n                }\n            };\n            let flags = mp4Sample.flags;\n            if (sample.unit.isKeyframe() === true) {\n                // the current sample is a key frame\n                flags.dependsOn = 2;\n                flags.isNonSync = 0;\n            } else {\n                flags.dependsOn = 1;\n                flags.isNonSync = 1;\n            }\n\n            payload.set(unit.getData(), offset);\n            offset += unit.getSize();\n\n            samples.push(mp4Sample);\n            lastDTS = dts;\n        }\n\n        if (!samples.length) return null;\n\n        let avgDuration = this.lastDurations.reduce(function(a, b) { return (a|0) + (b|0); }, 0) / (this.lastDurations.length||1)|0;\n        if (samples.length >= 2) {\n            this.lastSampleDuration = avgDuration;\n            mp4Sample.duration = avgDuration;\n        } else {\n            mp4Sample.duration = this.lastSampleDuration;\n        }\n\n        if(samples.length && (!this.nextDts || navigator.userAgent.toLowerCase().indexOf('chrome') > -1)) {\n            let flags = samples[0].flags;\n            // chrome workaround, mark first sample as being a Random Access Point to avoid sourcebuffer append issue\n            // https://code.google.com/p/chromium/issues/detail?id=229412\n            flags.dependsOn = 2;\n            flags.isNonSync = 0;\n        }\n\n        // next AVC sample DTS should be equal to last sample DTS + last sample duration\n        this.nextDts = dts + this.unscaled(this.lastSampleDuration);\n        // Log.debug(`next dts: ${this.nextDts}, last duration: ${this.lastSampleDuration}, last dts: ${dts}`);\n\n        return new Uint8Array(payload.buffer, 0, this.mp4track.len);\n    }\n}\n","export class StreamType {\n    static get VIDEO() {return 1;}\n    static get AUDIO() {return 2;}\n\n    static get map() {return {\n        [StreamType.VIDEO]: 'video',\n        [StreamType.AUDIO]: 'audio'\n    }};\n}\n\nexport class PayloadType {\n    static get H264() {return 1;}\n    static get AAC() {return 2;}\n\n    static get map() {return {\n        [PayloadType.H264]: 'video',\n        [PayloadType.AAC]: 'audio'\n    }};\n\n    static get string_map() {return  {\n        H264: PayloadType.H264,\n        AAC: PayloadType.AAC,\n        'MP4A-LATM': PayloadType.AAC,\n        'MPEG4-GENERIC': PayloadType.AAC\n    }}\n}","import {EventEmitter, EventSourceWrapper} from '../../deps/bp_event.js';\nimport {getTagged} from \"../../deps/bp_logger.js\";\nimport {MP4} from '../iso-bmff/mp4-generator.js';\nimport {AACRemuxer} from './aac.js';\nimport {H264Remuxer} from './h264.js';\nimport {MSE} from '../presentation/mse.js';\nimport {PayloadType} from \"../defs.js\";\n\nconst LOG_TAG = \"remuxer\";\nconst Log = getTagged(LOG_TAG);\n\nexport class Remuxer {\n    static get TrackConverters() {return {\n        [PayloadType.H264]: H264Remuxer,\n        [PayloadType.AAC]:  AACRemuxer\n    }};\n\n    static get TrackScaleFactor() {return {\n        [PayloadType.H264]: 1,//4,\n        [PayloadType.AAC]:  0\n    }};\n\n    static get TrackTimescale() {return {\n        [PayloadType.H264]: 90000,//22500,\n        [PayloadType.AAC]:  0\n    }};\n\n    constructor(mediaElement) {\n        this.mse = new MSE([mediaElement]);\n        this.eventSource = new EventEmitter();\n        this.mseEventSource = new EventSourceWrapper(this.mse.eventSource);\n        this.mse_ready = true;\n\n        this.reset();\n\n        this.errorListener = this.mseClose.bind(this);\n        this.closeListener = this.mseClose.bind(this);\n        this.errorDecodeListener = this.mseErrorDecode.bind(this);\n\n        this.eventSource.addEventListener('ready', this.init.bind(this));\n    }\n\n    initMSEHandlers() {\n        this.mseEventSource.on('error', this.errorListener);\n        this.mseEventSource.on('sourceclosed', this.closeListener);\n        this.mseEventSource.on('errordecode', this.errorDecodeListener);\n    }\n\n    async reset() {\n        this.tracks = {};\n        this.initialized = false;\n        this.initSegments = {};\n        this.codecs = [];\n        this.streams = {};\n        this.enabled = false;\n        await this.mse.clear();\n        this.initMSEHandlers();\n    }\n\n    destroy() {\n        this.mseEventSource.destroy();\n        this.mse.destroy();\n        this.mse = null;\n\n        this.detachClient();\n\n        this.eventSource.destroy();\n    }\n\n    onTracks(tracks) {\n        Log.debug(`ontracks: `, tracks.detail);\n        // store available track types\n        for (let track of tracks.detail) {\n            this.tracks[track.type] = new Remuxer.TrackConverters[track.type](Remuxer.TrackTimescale[track.type], Remuxer.TrackScaleFactor[track.type], track.params);\n            if (track.offset) {\n                this.tracks[track.type].timeOffset = track.offset;\n            }\n            if (track.duration) {\n                this.tracks[track.type].mp4track.duration = track.duration*(this.tracks[track.type].timescale || Remuxer.TrackTimescale[track.type]);\n                this.tracks[track.type].duration = track.duration;\n            } else {\n                this.tracks[track.type].duration = 1;\n            }\n\n            // this.tracks[track.type].duration\n        }\n        this.mse.setLive(!this.client.seekable);\n    }\n\n    setTimeOffset(timeOffset, track) {\n        if (this.tracks[track.type]) {\n            this.tracks[track.type].timeOffset = timeOffset;///this.tracks[track.type].scaleFactor;\n        }\n    }\n\n    init() {\n        let tracks = [];\n        this.codecs = [];\n        let initmse = [];\n        let initPts = Infinity;\n        let initDts = Infinity;\n        for (let track_type in this.tracks) {\n            let track = this.tracks[track_type];\n            if (!MSE.isSupported([track.mp4track.codec])) {\n                throw new Error(`${track.mp4track.type} codec ${track.mp4track.codec} is not supported`);\n            }\n            tracks.push(track.mp4track);\n            this.codecs.push(track.mp4track.codec);\n            track.init(initPts, initDts/*, false*/);\n            // initPts = Math.min(track.initPTS, initPts);\n            // initDts = Math.min(track.initDTS, initDts);\n        }\n\n        for (let track_type in this.tracks) {\n            let track = this.tracks[track_type];\n            //track.init(initPts, initDts);\n            this.initSegments[track_type] = MP4.initSegment([track.mp4track], track.duration*track.timescale, track.timescale);\n            initmse.push(this.initMSE(track_type, track.mp4track.codec));\n        }\n        this.initialized = true;\n        return Promise.all(initmse).then(()=>{\n            //this.mse.play();\n            this.enabled = true;\n        });\n        \n    }\n\n    initMSE(track_type, codec) {\n        if (MSE.isSupported(this.codecs)) {\n            return this.mse.setCodec(track_type, `${PayloadType.map[track_type]}/mp4; codecs=\"${codec}\"`).then(()=>{\n                this.mse.feed(track_type, this.initSegments[track_type]);\n                // this.mse.play();\n                // this.enabled = true;\n            });\n        } else {\n            throw new Error('Codecs are not supported');\n        }\n    }\n\n    mseClose() {\n        // this.mse.clear();\n        this.client.stop();\n        this.eventSource.dispatchEvent('stopped');\n    }\n\n    mseErrorDecode() {\n        if(this.tracks[2]) {\n            console.warn(this.tracks[2].mp4track.type);\n            this.mse.buffers[2].destroy();\n            delete this.tracks[2];\n        }\n    }\n\n    flush() {\n        this.onSamples();\n\n        if (!this.initialized) {\n            // Log.debug(`Initialize...`);\n            if (Object.keys(this.tracks).length) {\n                for (let track_type in this.tracks) {\n                    if (!this.tracks[track_type].readyToDecode || !this.tracks[track_type].samples.length) return;\n                    Log.debug(`Init MSE for track ${this.tracks[track_type].mp4track.type}`);\n                }\n                this.eventSource.dispatchEvent('ready');\n            }\n        } else {\n            for (let track_type in this.tracks) {\n                let track = this.tracks[track_type];\n                let pay = track.getPayload();\n                if (pay && pay.byteLength) {\n                    this.mse.feed(track_type, [MP4.moof(track.seq, track.scaled(track.firstDTS), track.mp4track), MP4.mdat(pay)]);\n                    track.flush();\n                }\n            }\n        }\n    }\n\n    onSamples(ev) {\n        // TODO: check format\n        // let data = ev.detail;\n        // if (this.tracks[data.pay] && this.client.sampleQueues[data.pay].length) {\n            // console.log(`video ${data.units[0].dts}`);\n        for (let qidx in this.client.sampleQueues) {\n            let queue = this.client.sampleQueues[qidx];\n            while (queue.length) {\n                let units = queue.shift();\n                if(units){\n                    for (let chunk of units) {\n                        if(this.tracks[qidx]) {\n                            this.tracks[qidx].remux(chunk);\n                        }\n                    }\n                } else {\n                    if (!this.initialized) {\n                        delete this.tracks[qidx];\n                    }\n                }\n            }\n        }\n        // }\n    }\n\n    onAudioConfig(ev) {\n        if (this.tracks[ev.detail.pay]) {\n            this.tracks[ev.detail.pay].setConfig(ev.detail.config);\n        }\n    }\n\n    attachClient(client) {\n        this.detachClient();\n        this.client = client;\n        this.clientEventSource = new EventSourceWrapper(this.client.eventSource);\n        this.clientEventSource.on('samples', this.samplesListener);\n        this.clientEventSource.on('audio_config', this.audioConfigListener);\n        this.clientEventSource.on('tracks', this.onTracks.bind(this));\n        this.clientEventSource.on('flush', this.flush.bind(this));\n        this.clientEventSource.on('clear', ()=>{\n            this.reset();\n            this.mse.clear().then(()=>{\n                //this.mse.play();\n                this.initMSEHandlers();\n            });\n        });\n    }\n\n    detachClient() {\n        if (this.client) {\n            this.clientEventSource.destroy();\n            // this.client.eventSource.removeEventListener('samples', this.onSamples.bind(this));\n            // this.client.eventSource.removeEventListener('audio_config', this.onAudioConfig.bind(this));\n            // // TODO: clear other listeners\n            // this.client.eventSource.removeEventListener('clear', this._clearListener);\n            // this.client.eventSource.removeEventListener('tracks', this._tracksListener);\n            // this.client.eventSource.removeEventListener('flush', this._flushListener);\n            this.client = null;\n        }\n    }\n}","class State {\n    constructor(name, stateMachine) {\n        this.stateMachine = stateMachine;\n        this.transitions = new Set();\n        this.name = name;\n    }\n\n\n    activate() {\n        return Promise.resolve(null);\n    }\n\n    finishTransition() {}\n\n    failHandler() {}\n\n    deactivate() {\n        return Promise.resolve(null);\n    }\n}\n\nexport class StateMachine {\n    constructor() {\n        this.storage = {};\n        this.currentState = null;\n        this.states = new Map();\n    }\n\n    addState(name, {activate, finishTransition, deactivate}) {\n        let state = new State(name, this);\n        if (activate) state.activate = activate;\n        if (finishTransition) state.finishTransition = finishTransition;\n        if (deactivate) state.deactivate = deactivate;\n        this.states.set(name, state);\n        return this;\n    }\n\n    addTransition(fromName, toName){\n        if (!this.states.has(fromName)) {\n            throw ReferenceError(`No such state: ${fromName} while connecting to ${toName}`);\n        }\n        if (!this.states.has(toName)) {\n            throw ReferenceError(`No such state: ${toName} while connecting from ${fromName}`);\n        }\n        this.states.get(fromName).transitions.add(toName);\n        return this;\n    }\n\n    _promisify(res) {\n        let promise;\n        try {\n            promise = res;\n            if (!promise.then) {\n                promise = Promise.resolve(promise);\n            }\n        } catch (e) {\n            promise = Promise.reject(e);\n        }\n        return promise;\n    }\n\n    transitionTo(stateName) {\n        if (this.currentState == null) {\n            let state = this.states.get(stateName);\n            return this._promisify(state.activate.call(this))\n                .then((data)=> {\n                    this.currentState = state;\n                    return data;\n                }).then(state.finishTransition.bind(this)).catch((e)=>{\n                    state.failHandler();\n                    throw e;\n                });\n        }\n        if (this.currentState.name == stateName) return Promise.resolve();\n        if (this.currentState.transitions.has(stateName)) {\n            let state = this.states.get(stateName);\n            return this._promisify(state.deactivate.call(this))\n                .then(state.activate.bind(this)).then((data)=> {\n                    this.currentState = state;\n                    return data;\n                }).then(state.finishTransition.bind(this)).catch((e)=>{\n                    state.failHandler();\n                    throw e;\n                });\n        } else {\n            return Promise.reject(`No such transition: ${this.currentState.name} to ${stateName}`);\n        }\n    }\n\n}\n","// export * from 'bp_statemachine';\nexport * from '../../node_modules/bp_statemachine/statemachine.js';","import {getTagged} from '../../deps/bp_logger';\nimport {PayloadType} from '../defs.js';\n\nconst Log = getTagged(\"parser:sdp\");\n\nexport class SDPParser {\n    constructor() {\n        this.version = -1;\n        this.origin = null;\n        this.sessionName = null;\n        this.timing = null;\n        this.sessionBlock = {};\n        this.media = {};\n        this.tracks = {};\n        this.mediaMap = {};\n    }\n\n    parse(content) {\n        // Log.debug(content);\n        return new Promise((resolve, reject) => {\n            var dataString = content;\n            var success = true;\n            var currentMediaBlock = this.sessionBlock;\n\n            // TODO: multiple audio/video tracks\n\n            for (let line of dataString.split(\"\\n\")) {\n                line = line.replace(/\\r/, '');\n                if (0 === line.length) {\n                    /* Empty row (last row perhaps?), skip to next */\n                    continue;\n                }\n\n                switch (line.charAt(0)) {\n                    case 'v':\n                        if (-1 !== this.version) {\n                            Log.log('Version present multiple times in SDP');\n                            reject();\n                            return false;\n                        }\n                        success = success && this._parseVersion(line);\n                        break;\n\n                    case 'o':\n                        if (null !== this.origin) {\n                            Log.log('Origin present multiple times in SDP');\n                            reject();\n                            return false;\n                        }\n                        success = success && this._parseOrigin(line);\n                        break;\n\n                    case 's':\n                        if (null !== this.sessionName) {\n                            Log.log('Session Name present multiple times in SDP');\n                            reject();\n                            return false;\n                        }\n                        success = success && this._parseSessionName(line);\n                        break;\n\n                    case 't':\n                        if (null !== this.timing) {\n                            Log.log('Timing present multiple times in SDP');\n                            reject();\n                            return false;\n                        }\n                        success = success && this._parseTiming(line);\n                        break;\n\n                    case 'm':\n                        if (null !== currentMediaBlock && this.sessionBlock !== currentMediaBlock) {\n                            /* Complete previous block and store it */\n                            this.media[currentMediaBlock.type] = currentMediaBlock;\n                        }\n\n                        /* A wild media block appears */\n                        currentMediaBlock = {};\n                        currentMediaBlock.rtpmap = {};\n                        this._parseMediaDescription(line, currentMediaBlock);\n                        break;\n\n                    case 'a':\n                        SDPParser._parseAttribute(line, currentMediaBlock);\n                        break;\n\n                    default:\n                        Log.log('Ignored unknown SDP directive: ' + line);\n                        break;\n                }\n\n                if (!success) {\n                    reject();\n                    return;\n                }\n            }\n\n            this.media[currentMediaBlock.type] = currentMediaBlock;\n\n            success ? resolve() : reject();\n        });\n    }\n\n    _parseVersion(line) {\n        let matches = line.match(/^v=([0-9]+)$/);\n        if (!matches || !matches.length) {\n            Log.log('\\'v=\\' (Version) formatted incorrectly: ' + line);\n            return false;\n        }\n\n        this.version = matches[1];\n        if (0 != this.version) {\n            Log.log('Unsupported SDP version:' + this.version);\n            return false;\n        }\n\n        return true;\n    }\n\n    _parseOrigin(line) {\n        let matches = line.match(/^o=([^ ]+) (-?[0-9]+) (-?[0-9]+) (IN) (IP4|IP6) ([^ ]+)$/);\n        if (!matches || !matches.length) {\n            Log.log('\\'o=\\' (Origin) formatted incorrectly: ' + line);\n            return false;\n        }\n\n        this.origin = {};\n        this.origin.username = matches[1];\n        this.origin.sessionid = matches[2];\n        this.origin.sessionversion = matches[3];\n        this.origin.nettype = matches[4];\n        this.origin.addresstype = matches[5];\n        this.origin.unicastaddress = matches[6];\n\n        return true;\n    }\n\n    _parseSessionName(line) {\n        let matches = line.match(/^s=([^\\r\\n]+)$/);\n        if (!matches || !matches.length) {\n            Log.log('\\'s=\\' (Session Name) formatted incorrectly: ' + line);\n            return false;\n        }\n\n        this.sessionName = matches[1];\n\n        return true;\n    }\n\n    _parseTiming(line) {\n        let matches = line.match(/^t=([0-9]+) ([0-9]+)$/);\n        if (!matches || !matches.length) {\n            Log.log('\\'t=\\' (Timing) formatted incorrectly: ' + line);\n            return false;\n        }\n\n        this.timing = {};\n        this.timing.start = matches[1];\n        this.timing.stop = matches[2];\n\n        return true;\n    }\n\n    _parseMediaDescription(line, media) {\n        let matches = line.match(/^m=([^ ]+) ([^ ]+) ([^ ]+)[ ]/);\n        if (!matches || !matches.length) {\n            Log.log('\\'m=\\' (Media) formatted incorrectly: ' + line);\n            return false;\n        }\n\n        media.type = matches[1];\n        media.port = matches[2];\n        media.proto = matches[3];\n        media.fmt = line.substr(matches[0].length).split(' ').map(function (fmt, index, array) {\n            return parseInt(fmt);\n        });\n\n        for (let fmt of media.fmt) {\n            this.mediaMap[fmt] = media;\n        }\n\n        return true;\n    }\n\n    static _parseAttribute(line, media) {\n        if (null === media) {\n            /* Not in a media block, can't be bothered parsing attributes for session */\n            return true;\n        }\n\n        var matches;\n        /* Used for some cases of below switch-case */\n        var separator = line.indexOf(':');\n        var attribute = line.substr(0, (-1 === separator) ? 0x7FFFFFFF : separator);\n        /* 0x7FF.. is default */\n\n        switch (attribute) {\n            case 'a=recvonly':\n            case 'a=sendrecv':\n            case 'a=sendonly':\n            case 'a=inactive':\n                media.mode = line.substr('a='.length);\n                break;\n            case 'a=range':\n                matches = line.match(/^a=range:\\s*([a-zA-Z-]+)=([0-9.]+|now)\\s*-\\s*([0-9.]*)$/);\n                media.range = [Number(matches[2] == \"now\" ? -1 : matches[2]), Number(matches[3]), matches[1]];\n                break;\n            case 'a=control':\n                media.control = line.substr('a=control:'.length);\n                break;\n\n            case 'a=rtpmap':\n                matches = line.match(/^a=rtpmap:(\\d+) (.*)$/);\n                if (null === matches) {\n                    Log.log('Could not parse \\'rtpmap\\' of \\'a=\\'');\n                    return false;\n                }\n\n                var payload = parseInt(matches[1]);\n                media.rtpmap[payload] = {};\n\n                var attrs = matches[2].split('/');\n                media.rtpmap[payload].name = attrs[0].toUpperCase();\n                media.rtpmap[payload].clock = attrs[1];\n                if (undefined !== attrs[2]) {\n                    media.rtpmap[payload].encparams = attrs[2];\n                }\n                media.ptype = PayloadType.string_map[attrs[0].toUpperCase()];\n\n                break;\n\n            case 'a=fmtp':\n                matches = line.match(/^a=fmtp:(\\d+) (.*)$/);\n                if (0 === matches.length) {\n                    Log.log('Could not parse \\'fmtp\\'  of \\'a=\\'');\n                    return false;\n                }\n\n                media.fmtp = {};\n                for (var param of matches[2].split(';')) {\n                    var idx = param.indexOf('=');\n                    media.fmtp[param.substr(0, idx).toLowerCase().trim()] = param.substr(idx + 1).trim();\n                }\n                break;\n        }\n\n        return true;\n    }\n\n    getSessionBlock() {\n        return this.sessionBlock;\n    }\n\n    hasMedia(mediaType) {\n        return this.media[mediaType] != undefined;\n    }\n\n    getMediaBlock(mediaType) {\n        return this.media[mediaType];\n    }\n\n    getMediaBlockByPayloadType(pt) {\n        // for (var m in this.media) {\n        //     if (-1 !== this.media[m].fmt.indexOf(pt)) {\n        //         return this.media[m];\n        //     }\n        // }\n        return this.mediaMap[pt] || null;\n\n        //ErrorManager.dispatchError(826, [pt], true);\n        // Log.error(`failed to find media with payload type ${pt}`);\n        //\n        // return null;\n    }\n\n    getMediaBlockList() {\n        var res = [];\n        for (var m in this.media) {\n            res.push(m);\n        }\n\n        return res;\n    }\n}","import {getTagged} from '../../deps/bp_logger.js';\n\nimport {RTSPClientSM as RTSPClient} from './client.js';\nimport {Url} from '../../core/util/url.js';\nimport {RTSPError} from \"./client\";\n\nconst LOG_TAG = \"rtsp:stream\";\nconst Log = getTagged(LOG_TAG);\n\nexport class RTSPStream {\n\n    constructor(client, track) {\n        this.state = null;\n        this.client = client;\n        this.track = track;\n        this.rtpChannel = 1;\n\n        this.stopKeepAlive();\n        this.keepaliveInterval = null;\n        this.keepaliveTime = 30000;\n    }\n\n    reset() {\n        this.stopKeepAlive();\n        this.client.forgetRTPChannel(this.rtpChannel);\n        this.client = null;\n        this.track = null;\n    }\n\n    start() {\n        return this.sendSetup();\n    }\n\n    stop() {\n        return this.sendTeardown();\n    }\n\n    getSetupURL(track) {\n        let sessionBlock = this.client.sdp.getSessionBlock();\n        if (Url.isAbsolute(track.control)) {\n            return track.control;\n        } else if (Url.isAbsolute(`${sessionBlock.control}${track.control}`)) {\n            return `${sessionBlock.control}${track.control}`;\n        } else if (Url.isAbsolute(`${this.client.contentBase}${track.control}`)) {\n            /* Should probably check session level control before this */\n            return `${this.client.contentBase}${track.control}`;\n        }\n        else {//need return default\n            return track.control;\n        }\n        Log.error('Can\\'t determine track URL from ' +\n            'block.control:' + track.control + ', ' +\n            'session.control:' + sessionBlock.control + ', and ' +\n            'content-base:' + this.client.contentBase);\n    }\n\n    getControlURL() {\n        let ctrl = this.client.sdp.getSessionBlock().control;\n        if (Url.isAbsolute(ctrl)) {\n            return ctrl;\n        } else if (!ctrl || '*' === ctrl) {\n            return this.client.contentBase;\n        } else {\n            return `${this.client.contentBase}${ctrl}`;\n        }\n    }\n\n    sendKeepalive() {\n        if (this.client.methods.includes('GET_PARAMETER')) {\n            return this.client.sendRequest('GET_PARAMETER', this.getSetupURL(this.track), {\n                'Session': this.session\n            });\n        } else {\n            return this.client.sendRequest('OPTIONS', '*');\n        }\n    }\n\n    stopKeepAlive() {\n        clearInterval(this.keepaliveInterval);\n    }\n\n    startKeepAlive() {\n        this.keepaliveInterval = setInterval(() => {\n            this.sendKeepalive().catch((e) => {\n                Log.error(e);\n                if (e instanceof RTSPError) {\n                    if (Number(e.data.parsed.code) == 501) {\n                        return;\n                    }\n                }\n                this.client.reconnect();\n            });\n        }, this.keepaliveTime);\n    }\n\n    sendRequest(_cmd, _params = {}) {\n        let params = {};\n        if (this.session) {\n            params['Session'] = this.session;\n        }\n        Object.assign(params, _params);\n        return this.client.sendRequest(_cmd, this.getControlURL(), params);\n    }\n\n    sendSetup(session = null) {\n        this.state = RTSPClient.STATE_SETUP;\n        this.rtpChannel = this.client.interleaveChannelIndex;\n        let interleavedChannels = this.client.interleaveChannelIndex++ + \"-\" + this.client.interleaveChannelIndex++;\n        let params = {\n            'Transport': `RTP/AVP/TCP;unicast;interleaved=${interleavedChannels}`,\n            'Date': new Date().toUTCString()\n        };\n        if(session){\n            params.Session = session;\n        }\n        return this.client.sendRequest('SETUP', this.getSetupURL(this.track), params).then((_data) => {\n            this.session = _data.headers['session'];\n            let transport = _data.headers['transport'];\n            if (transport) {\n                let interleaved = transport.match(/interleaved=([0-9]+)-([0-9]+)/)[1];\n                if (interleaved) {\n                    this.rtpChannel = Number(interleaved);\n                }\n            }\n            let sessionParamsChunks = this.session.split(';').slice(1);\n            let sessionParams = {};\n            for (let chunk of sessionParamsChunks) {\n                let kv = chunk.split('=');\n                sessionParams[kv[0]] = kv[1];\n            }\n            if (sessionParams['timeout']) {\n                this.keepaliveInterval = Number(sessionParams['timeout']) * 500; // * 1000 / 2\n            }\n            /*if (!/RTP\\/AVP\\/TCP;unicast;interleaved=/.test(_data.headers[\"transport\"])) {\n                // TODO: disconnect stream and notify client\n                throw new Error(\"Connection broken\");\n            }*/\n            this.client.useRTPChannel(this.rtpChannel);\n            this.startKeepAlive();\n            return {track: this.track, data: _data, session: this.session};\n        });\n    }\n}\n","/*\n * JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n\n\n/*\n* Add integers, wrapping at 2^32. This uses 16-bit operations internally\n* to work around bugs in some JS interpreters.\n*/\nfunction safeAdd(x, y) {\n    var lsw = (x & 0xFFFF) + (y & 0xFFFF)\n    var msw = (x >> 16) + (y >> 16) + (lsw >> 16)\n    return (msw << 16) | (lsw & 0xFFFF)\n}\n\n/*\n* Bitwise rotate a 32-bit number to the left.\n*/\nfunction bitRotateLeft(num, cnt) {\n    return (num << cnt) | (num >>> (32 - cnt))\n}\n\n/*\n* These functions implement the four basic operations the algorithm uses.\n*/\nfunction md5cmn(q, a, b, x, s, t) {\n    return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b)\n}\nfunction md5ff(a, b, c, d, x, s, t) {\n    return md5cmn((b & c) | ((~b) & d), a, b, x, s, t)\n}\nfunction md5gg(a, b, c, d, x, s, t) {\n    return md5cmn((b & d) | (c & (~d)), a, b, x, s, t)\n}\nfunction md5hh(a, b, c, d, x, s, t) {\n    return md5cmn(b ^ c ^ d, a, b, x, s, t)\n}\nfunction md5ii(a, b, c, d, x, s, t) {\n    return md5cmn(c ^ (b | (~d)), a, b, x, s, t)\n}\n\n/*\n* Calculate the MD5 of an array of little-endian words, and a bit length.\n*/\nfunction binlMD5(x, len) {\n    /* append padding */\n    x[len >> 5] |= 0x80 << (len % 32)\n    x[(((len + 64) >>> 9) << 4) + 14] = len\n\n    var i\n    var olda\n    var oldb\n    var oldc\n    var oldd\n    var a = 1732584193\n    var b = -271733879\n    var c = -1732584194\n    var d = 271733878\n\n    for (i = 0; i < x.length; i += 16) {\n        olda = a\n        oldb = b\n        oldc = c\n        oldd = d\n\n        a = md5ff(a, b, c, d, x[i], 7, -680876936)\n        d = md5ff(d, a, b, c, x[i + 1], 12, -389564586)\n        c = md5ff(c, d, a, b, x[i + 2], 17, 606105819)\n        b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330)\n        a = md5ff(a, b, c, d, x[i + 4], 7, -176418897)\n        d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426)\n        c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341)\n        b = md5ff(b, c, d, a, x[i + 7], 22, -45705983)\n        a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416)\n        d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417)\n        c = md5ff(c, d, a, b, x[i + 10], 17, -42063)\n        b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162)\n        a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682)\n        d = md5ff(d, a, b, c, x[i + 13], 12, -40341101)\n        c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290)\n        b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329)\n\n        a = md5gg(a, b, c, d, x[i + 1], 5, -165796510)\n        d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632)\n        c = md5gg(c, d, a, b, x[i + 11], 14, 643717713)\n        b = md5gg(b, c, d, a, x[i], 20, -373897302)\n        a = md5gg(a, b, c, d, x[i + 5], 5, -701558691)\n        d = md5gg(d, a, b, c, x[i + 10], 9, 38016083)\n        c = md5gg(c, d, a, b, x[i + 15], 14, -660478335)\n        b = md5gg(b, c, d, a, x[i + 4], 20, -405537848)\n        a = md5gg(a, b, c, d, x[i + 9], 5, 568446438)\n        d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690)\n        c = md5gg(c, d, a, b, x[i + 3], 14, -187363961)\n        b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501)\n        a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467)\n        d = md5gg(d, a, b, c, x[i + 2], 9, -51403784)\n        c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473)\n        b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734)\n\n        a = md5hh(a, b, c, d, x[i + 5], 4, -378558)\n        d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463)\n        c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562)\n        b = md5hh(b, c, d, a, x[i + 14], 23, -35309556)\n        a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060)\n        d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353)\n        c = md5hh(c, d, a, b, x[i + 7], 16, -155497632)\n        b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640)\n        a = md5hh(a, b, c, d, x[i + 13], 4, 681279174)\n        d = md5hh(d, a, b, c, x[i], 11, -358537222)\n        c = md5hh(c, d, a, b, x[i + 3], 16, -722521979)\n        b = md5hh(b, c, d, a, x[i + 6], 23, 76029189)\n        a = md5hh(a, b, c, d, x[i + 9], 4, -640364487)\n        d = md5hh(d, a, b, c, x[i + 12], 11, -421815835)\n        c = md5hh(c, d, a, b, x[i + 15], 16, 530742520)\n        b = md5hh(b, c, d, a, x[i + 2], 23, -995338651)\n\n        a = md5ii(a, b, c, d, x[i], 6, -198630844)\n        d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415)\n        c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905)\n        b = md5ii(b, c, d, a, x[i + 5], 21, -57434055)\n        a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571)\n        d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606)\n        c = md5ii(c, d, a, b, x[i + 10], 15, -1051523)\n        b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799)\n        a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359)\n        d = md5ii(d, a, b, c, x[i + 15], 10, -30611744)\n        c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380)\n        b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649)\n        a = md5ii(a, b, c, d, x[i + 4], 6, -145523070)\n        d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379)\n        c = md5ii(c, d, a, b, x[i + 2], 15, 718787259)\n        b = md5ii(b, c, d, a, x[i + 9], 21, -343485551)\n\n        a = safeAdd(a, olda)\n        b = safeAdd(b, oldb)\n        c = safeAdd(c, oldc)\n        d = safeAdd(d, oldd)\n    }\n    return [a, b, c, d]\n}\n\n/*\n* Convert an array of little-endian words to a string\n*/\nfunction binl2rstr(input) {\n    var i\n    var output = ''\n    var length32 = input.length * 32\n    for (i = 0; i < length32; i += 8) {\n        output += String.fromCharCode((input[i >> 5] >>> (i % 32)) & 0xFF)\n    }\n    return output\n}\n\n/*\n* Convert a raw string to an array of little-endian words\n* Characters >255 have their high-byte silently ignored.\n*/\nfunction rstr2binl(input) {\n    var i\n    var output = []\n    output[(input.length >> 2) - 1] = undefined\n    for (i = 0; i < output.length; i += 1) {\n        output[i] = 0\n    }\n    var length8 = input.length * 8\n    for (i = 0; i < length8; i += 8) {\n        output[i >> 5] |= (input.charCodeAt(i / 8) & 0xFF) << (i % 32)\n    }\n    return output\n}\n\n/*\n* Calculate the MD5 of a raw string\n*/\nfunction rstrMD5(s) {\n    return binl2rstr(binlMD5(rstr2binl(s), s.length * 8))\n}\n\n/*\n* Calculate the HMAC-MD5, of a key and some data (raw strings)\n*/\nfunction rstrHMACMD5(key, data) {\n    var i\n    var bkey = rstr2binl(key)\n    var ipad = []\n    var opad = []\n    var hash\n    ipad[15] = opad[15] = undefined\n    if (bkey.length > 16) {\n        bkey = binlMD5(bkey, key.length * 8)\n    }\n    for (i = 0; i < 16; i += 1) {\n        ipad[i] = bkey[i] ^ 0x36363636\n        opad[i] = bkey[i] ^ 0x5C5C5C5C\n    }\n    hash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8)\n    return binl2rstr(binlMD5(opad.concat(hash), 512 + 128))\n}\n\n/*\n* Convert a raw string to a hex string\n*/\nfunction rstr2hex(input) {\n    var hexTab = '0123456789abcdef'\n    var output = ''\n    var x\n    var i\n    for (i = 0; i < input.length; i += 1) {\n        x = input.charCodeAt(i)\n        output += hexTab.charAt((x >>> 4) & 0x0F) +\n            hexTab.charAt(x & 0x0F)\n    }\n    return output\n}\n\n/*\n* Encode a string as utf-8\n*/\nfunction str2rstrUTF8(input) {\n    return unescape(encodeURIComponent(input))\n}\n\n/*\n* Take string arguments and return either raw or hex encoded strings\n*/\nfunction rawMD5(s) {\n    return rstrMD5(str2rstrUTF8(s))\n}\nfunction hexMD5(s) {\n    return rstr2hex(rawMD5(s))\n}\nfunction rawHMACMD5(k, d) {\n    return rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d))\n}\nfunction hexHMACMD5(k, d) {\n    return rstr2hex(rawHMACMD5(k, d))\n}\n\nexport default function md5(string, key, raw) {\n    if (!key) {\n        if (!raw) {\n            return hexMD5(string)\n        }\n        return rawMD5(string)\n    }\n    if (!raw) {\n        return hexHMACMD5(key, string)\n    }\n    return rawHMACMD5(key, string)\n}\n","// TODO: asm.js\nimport {Log} from '../../../deps/bp_logger.js';\nexport default class RTP {\n    constructor(pkt/*uint8array*/, sdp) {\n        let bytes = new DataView(pkt.buffer, pkt.byteOffset, pkt.byteLength);\n\n        this.version   = bytes.getUint8(0) >>> 6;\n        this.padding   = bytes.getUint8(0) & 0x20 >>> 5;\n        this.has_extension = bytes.getUint8(0) & 0x10 >>> 4;\n        this.csrc      = bytes.getUint8(0) & 0x0F;\n        this.marker    = bytes.getUint8(1) >>> 7;\n        this.pt        = bytes.getUint8(1) & 0x7F;\n        this.sequence  = bytes.getUint16(2) ;\n        this.timestamp = bytes.getUint32(4);\n        this.ssrc      = bytes.getUint32(8);\n        this.csrcs     = [];\n\n        let pktIndex=12;\n        if (this.csrc>0) {\n            this.csrcs.push(bytes.getUint32(pktIndex));\n            pktIndex+=4;\n        }\n        if (this.has_extension==1) {\n            this.extension = bytes.getUint16(pktIndex);\n            this.ehl = bytes.getUint16(pktIndex+2);\n            pktIndex+=4;\n            this.header_data = pkt.slice(pktIndex, this.ehl);\n            pktIndex += this.ehl;\n        }\n\n        this.headerLength = pktIndex;\n        let padLength = 0;\n        if (this.padding) {\n            padLength = bytes.getUint8(pkt.byteLength-1);\n        }\n\n        // this.bodyLength   = pkt.byteLength-this.headerLength-padLength;\n\n        this.media = sdp.getMediaBlockByPayloadType(this.pt);\n        if (null === this.media) {\n            Log.log(`Media description for payload type: ${this.pt} not provided.`);\n        } else {\n            this.type = this.media.ptype;//PayloadType.string_map[this.media.rtpmap[this.media.fmt[0]].name];\n        }\n\n        this.data = pkt.subarray(pktIndex);\n        // this.timestamp = 1000 * (this.timestamp / this.media.rtpmap[this.pt].clock);\n        // console.log(this);\n    }\n    getPayload() {\n        return this.data;\n    }\n\n    getTimestampMS() {\n        return this.timestamp; //1000 * (this.timestamp / this.media.rtpmap[this.pt].clock);\n    }\n\n    toString() {\n        return \"RTP(\" +\n            \"version:\"   + this.version   + \", \" +\n            \"padding:\"   + this.padding   + \", \" +\n            \"has_extension:\" + this.has_extension + \", \" +\n            \"csrc:\"      + this.csrc      + \", \" +\n            \"marker:\"    + this.marker    + \", \" +\n            \"pt:\"        + this.pt        + \", \" +\n            \"sequence:\"  + this.sequence  + \", \" +\n            \"timestamp:\" + this.timestamp + \", \" +\n            \"ssrc:\"      + this.ssrc      + \")\";\n    }\n\n    isVideo(){return this.media.type == 'video';}\n    isAudio(){return this.media.type == 'audio';}\n\n    \n}","import RTP from './rtp.js';\n\nexport default class RTPFactory {\n    constructor(sdp) {\n        this.tsOffsets={};\n        for (let pay in sdp.media) {\n            for (let pt of sdp.media[pay].fmt) {\n                this.tsOffsets[pt] = {last: 0, overflow: 0};\n            }\n        }\n    }\n\n    build(pkt/*uint8array*/, sdp) {\n        let rtp = new RTP(pkt, sdp);\n\n        let tsOffset = this.tsOffsets[rtp.pt];\n        if (tsOffset) {\n            rtp.timestamp += tsOffset.overflow;\n            if (tsOffset.last && Math.abs(rtp.timestamp - tsOffset.last) > 0x7fffffff) {\n                console.log(`\\nlast ts: ${tsOffset.last}\\n\n                            new ts: ${rtp.timestamp}\\n\n                            new ts adjusted: ${rtp.timestamp+0xffffffff}\\n\n                            last overflow: ${tsOffset.overflow}\\n\n                            new overflow: ${tsOffset.overflow+0xffffffff}\\n\n                            `);\n                tsOffset.overflow += 0xffffffff;\n                rtp.timestamp += 0xffffffff;\n            }\n            /*if (rtp.timestamp>0xffffffff) {\n                console.log(`ts: ${rtp.timestamp}, seq: ${rtp.sequence}`);\n            }*/\n            tsOffset.last = rtp.timestamp;\n        }\n\n        return rtp;\n    }\n}","export class RTSPMessage {\n    static get RTSP_1_0() {return  \"RTSP/1.0\";}\n\n    constructor(_rtsp_version) {\n        this.version = _rtsp_version;\n    }\n\n    build(_cmd, _host, _params={}, _payload=null) {\n        let requestString = `${_cmd} ${_host} ${this.version}\\r\\n`;\n        for (let param in _params) {\n            requestString+=`${param}: ${_params[param]}\\r\\n`\n        }\n        // TODO: binary payload\n        if (_payload) {\n            requestString+=`Content-Length: ${_payload.length}\\r\\n`\n        }\n        requestString+='\\r\\n';\n        if (_payload) {\n            requestString+=_payload;\n        }\n        return requestString;\n    }\n\n    parse(_data) {\n        let lines = _data.split('\\r\\n');\n        let parsed = {\n            headers:{},\n            body:null,\n            code: 0,\n            statusLine: ''\n        };\n\n        let match;\n        [match, parsed.code, parsed.statusLine] = lines[0].match(new RegExp(`${this.version}[ ]+([0-9]{3})[ ]+(.*)`));\n        parsed.code = Number(parsed.code);\n        let lineIdx = 1;\n\n        while (lines[lineIdx]) {\n            let [k,v] = lines[lineIdx].split(/:(.+)/);\n            parsed.headers[k.toLowerCase()] = v.trim();\n            lineIdx++;\n        }\n\n        parsed.body = lines.slice(lineIdx).join('\\n\\r');\n\n        return parsed;\n    }\n\n}\n\nexport const MessageBuilder = new RTSPMessage(RTSPMessage.RTSP_1_0);","import {Log} from '../../deps/bp_logger.js';\nimport {NALU} from './NALU.js';\n\n// TODO: asm.js\nexport class NALUAsm {\n\n    constructor() {\n        this.fragmented_nalu = null;\n    }\n\n\n    static parseNALHeader(hdr) {\n        return {\n            nri: hdr & 0x60,\n            type: hdr & 0x1F\n        }\n    }\n\n    parseSingleNALUPacket(rawData, header, dts, pts) {\n        return new NALU(header.type,  header.nri, rawData.subarray(0), dts, pts);\n    }\n\n    parseAggregationPacket(rawData, header, dts, pts) {\n        let data = new DataView(rawData.buffer, rawData.byteOffset, rawData.byteLength);\n        let nal_start_idx = 0;\n        let don = null;\n        if (NALU.STAP_B === header.type) {\n            don = data.getUint16(nal_start_idx);\n            nal_start_idx += 2;\n        }\n        let ret = [];\n        while (nal_start_idx < data.byteLength) {\n            let size = data.getUint16(nal_start_idx);\n            nal_start_idx += 2;\n            let header = NALUAsm.parseNALHeader(data.getInt8(nal_start_idx));\n            nal_start_idx++;\n            let nalu = this.parseSingleNALUPacket(rawData.subarray(nal_start_idx, nal_start_idx+size), header, dts, pts);\n            if (nalu !== null) {\n                ret.push(nalu);\n            }\n            nal_start_idx+=size;\n        }\n        return ret;\n    }\n\n    parseFragmentationUnit(rawData, header, dts, pts) {\n        let data = new DataView(rawData.buffer, rawData.byteOffset, rawData.byteLength);\n        let nal_start_idx = 0;\n        let fu_header = data.getUint8(nal_start_idx);\n        let is_start = (fu_header & 0x80) >>> 7;\n        let is_end = (fu_header & 0x40) >>> 6;\n        let payload_type = fu_header & 0x1F;\n        let ret = null;\n\n        nal_start_idx++;\n        let don = 0;\n        if (NALU.FU_B === header.type) {\n            don = data.getUint16(nal_start_idx);\n            nal_start_idx += 2;\n        }\n\n        if (is_start) {\n            this.fragmented_nalu = new NALU(payload_type, header.nri, rawData.subarray(nal_start_idx), dts, pts);\n        }\n        if (this.fragmented_nalu && this.fragmented_nalu.ntype === payload_type) {\n            if (!is_start) {\n                this.fragmented_nalu.appendData(rawData.subarray(nal_start_idx));\n            }\n            if (is_end) {\n                ret = this.fragmented_nalu;\n                this.fragmented_nalu = null;\n                return ret;\n            }\n        }\n        return null;\n    }\n\n    onNALUFragment(rawData, dts, pts) {\n\n        let data = new DataView(rawData.buffer, rawData.byteOffset, rawData.byteLength);\n\n        let header = NALUAsm.parseNALHeader(data.getUint8(0));\n\n        let nal_start_idx = 1;\n\n        let unit = null;\n        if (header.type > 0 && header.type < 24) {\n            unit = this.parseSingleNALUPacket(rawData.subarray(nal_start_idx), header, dts, pts);\n        } else if (NALU.FU_A ===  header.type || NALU.FU_B ===  header.type) {\n            unit = this.parseFragmentationUnit(rawData.subarray(nal_start_idx), header, dts, pts);\n        } else if (NALU.STAP_A === header.type || NALU.STAP_B === header.type) {\n            return this.parseAggregationPacket(rawData.subarray(nal_start_idx), header, dts, pts);\n        } else {\n            /* 30 - 31 is undefined, ignore those (RFC3984). */\n            Log.log('Undefined NAL unit, type: ' + header.type);\n            return null;\n        }\n        if (unit) {\n            return [unit];\n        }\n        return null;\n    }\n}\n","export class AACFrame {\n\n    constructor(data, dts, pts) {\n        this.dts = dts;\n        this.pts = pts ? pts : this.dts;\n\n        this.data=data;//.subarray(offset);\n    }\n\n    getData() {\n        return this.data;\n    }\n\n    getSize() {\n        return this.data.byteLength;\n    }\n}","import {AACFrame} from './AACFrame.js';\nimport {BitArray} from '../util/binary';\n// import {AACParser} from \"../parsers/aac.js\";\n// TODO: asm.js\nexport class AACAsm {\n    constructor() {\n        this.config = null;\n    }\n\n    onAACFragment(pkt) {\n        let rawData = pkt.getPayload();\n        if (!pkt.media) {\n            return null;\n        }\n        let data = new DataView(rawData.buffer, rawData.byteOffset, rawData.byteLength);\n\n        let sizeLength = Number(pkt.media.fmtp['sizelength'] || 0);\n        let indexLength = Number(pkt.media.fmtp['indexlength'] || 0);\n        let indexDeltaLength = Number(pkt.media.fmtp['indexdeltalength'] || 0);\n        let CTSDeltaLength = Number(pkt.media.fmtp['ctsdeltalength'] || 0);\n        let DTSDeltaLength = Number(pkt.media.fmtp['dtsdeltalength'] || 0);\n        let RandomAccessIndication = Number(pkt.media.fmtp['randomaccessindication'] || 0);\n        let StreamStateIndication = Number(pkt.media.fmtp['streamstateindication'] || 0);\n        let AuxiliaryDataSizeLength = Number(pkt.media.fmtp['auxiliarydatasizelength'] || 0);\n\n        let configHeaderLength =\n            sizeLength + Math.max(indexLength, indexDeltaLength) + CTSDeltaLength + DTSDeltaLength +\n            RandomAccessIndication + StreamStateIndication + AuxiliaryDataSizeLength;\n\n\n        let auHeadersLengthPadded = 0;\n        let offset = 0;\n        let ts = (Math.round(pkt.getTimestampMS()/1024) << 10) * 90000 / this.config.samplerate;\n        if (0 !== configHeaderLength) {\n            /* The AU header section is not empty, read it from payload */\n            let auHeadersLengthInBits = data.getUint16(0); // Always 2 octets, without padding\n            auHeadersLengthPadded = 2 + (auHeadersLengthInBits>>>3) + ((auHeadersLengthInBits & 0x7)?1:0); // Add padding\n\n            //this.config = AACParser.parseAudioSpecificConfig(new Uint8Array(rawData, 0 , auHeadersLengthPadded));\n            // TODO: parse config\n            let frames = [];\n            let frameOffset=0;\n            let bits = new BitArray(rawData.subarray(2 + offset));\n            let cts = 0;\n            let dts = 0;\n            for (let offset=0; offset<auHeadersLengthInBits;) {\n                let size = bits.readBits(sizeLength);\n                let idx = bits.readBits(offset?indexDeltaLength:indexLength);\n                offset+=sizeLength+(offset?indexDeltaLength:indexLength)/*+2*/;\n                if (/*ctsPresent &&*/ CTSDeltaLength) {\n                    let ctsPresent = bits.readBits(1);\n                    cts = bits.readBits(CTSDeltaLength);\n                    offset+=CTSDeltaLength;\n                }\n                if (/*dtsPresent && */DTSDeltaLength) {\n                    let dtsPresent = bits.readBits(1);\n                    dts = bits.readBits(DTSDeltaLength);\n                    offset+=CTSDeltaLength;\n                }\n                if (RandomAccessIndication) {\n                    bits.skipBits(1);\n                    offset+=1;\n                }\n                if (StreamStateIndication) {\n                    bits.skipBits(StreamStateIndication);\n                    offset+=StreamStateIndication;\n                }\n                frames.push(new AACFrame(rawData.subarray(auHeadersLengthPadded + frameOffset, auHeadersLengthPadded + frameOffset + size), ts+dts, ts+cts));\n                frameOffset+=size;\n            }\n            return frames;\n        } else {\n            let aacData = rawData.subarray(auHeadersLengthPadded);\n            while (true) {\n                if (aacData[offset] !=255) break;\n                ++offset;\n            }\n            ++offset;\n            return [new AACFrame(rawData.subarray(auHeadersLengthPadded+offset), ts)];\n        }\n    }\n}","import {NALUAsm} from \"../../../../core/elementary/NALUAsm.js\";\nimport {AACAsm} from \"../../../../core/elementary/AACAsm.js\";\n\nexport class RTPPayloadParser {\n\n    constructor() {\n        this.h264parser = new RTPH264Parser();\n        this.aacparser = new RTPAACParser();\n    }\n\n    parse(rtp) {\n        if (rtp.media.type=='video') {\n            return this.h264parser.parse(rtp);\n        } else if (rtp.media.type == 'audio') {\n            return this.aacparser.parse(rtp);\n        }\n        return null;\n    }\n}\n\nclass RTPH264Parser {\n    constructor() {\n        this.naluasm = new NALUAsm();\n    }\n\n    parse(rtp) {\n        return this.naluasm.onNALUFragment(rtp.getPayload(), rtp.getTimestampMS());\n    }\n}\n\nclass RTPAACParser {\n\n    constructor() {\n        this.scale = 1;\n        this.asm = new AACAsm();\n    }\n\n    setConfig(conf) {\n        this.asm.config = conf;\n    }\n\n    parse(rtp) {\n        return this.asm.onAACFragment(rtp);\n    }\n}","import {Log} from '../deps/bp_logger.js';\nimport {EventEmitter} from '../deps/bp_event.js';\n\nexport class BaseClient {\n    constructor(options={flush: 100}) {\n        this.options = options;\n        this.eventSource = new EventEmitter();\n\n        Object.defineProperties(this, {\n            sourceUrl: {value: null, writable: true},   // TODO: getter with validator\n            paused: {value: true, writable: true},\n            seekable: {value: false, writable: true},\n            connected: {value: false, writable: true}\n        });\n\n        this._onData = ()=>{\n            if (this.connected) {\n                while (this.transport.dataQueue.length) {\n                    this.onData(this.transport.dataQueue.pop());\n                }\n            }\n        };\n        this._onConnect = this.onConnected.bind(this);\n        this._onDisconnect = this.onDisconnected.bind(this);\n    }\n\n    static streamType() {\n        return null;    \n    }\n    \n    destroy() {\n        this.detachTransport();\n    }\n\n    attachTransport(transport) {\n        if (this.transport) {\n            this.detachTransport();\n        }\n        this.transport = transport;\n        this.transport.eventSource.addEventListener('data', this._onData);\n        this.transport.eventSource.addEventListener('connected', this._onConnect);\n        this.transport.eventSource.addEventListener('disconnected', this._onDisconnect);\n    }\n\n    detachTransport() {\n        if (this.transport) {\n            this.transport.eventSource.removeEventListener('data', this._onData);\n            this.transport.eventSource.removeEventListener('connected', this._onConnect);\n            this.transport.eventSource.removeEventListener('disconnected', this._onDisconnect);\n            this.transport = null;\n        }\n    }\n    reset() {\n\n    }\n\n    start() {\n        Log.log('Client started');\n        this.paused = false;\n        // this.startStreamFlush();\n    }\n\n    stop() {\n        Log.log('Client paused');\n        this.paused = true;\n        // this.stopStreamFlush();\n    }\n\n    seek(timeOffset) {\n\n    }\n\n    setSource(source) {\n        this.stop();\n        this.endpoint = source;\n        this.sourceUrl = source.urlpath;\n    }\n\n    startStreamFlush() {\n        this.flushInterval = setInterval(()=>{\n            if (!this.paused) {\n                this.eventSource.dispatchEvent('flush');\n            }\n        }, this.options.flush);\n    }\n\n    stopStreamFlush() {\n        clearInterval(this.flushInterval);\n    }\n\n    onData(data) {\n\n    }\n\n    onConnected() {\n        if (!this.seekable) {\n            this.transport.dataQueue = [];\n            this.eventSource.dispatchEvent('clear');\n        }\n        this.connected = true;\n    }\n\n    onDisconnected() {\n        this.connected = false;\n    }\n\n    queryCredentials() {\n        return Promise.resolve();\n    }\n\n    setCredentials(user, password) {\n        this.endpoint.user = user;\n        this.endpoint.pass = password;\n        this.endpoint.auth = `${user}:${password}`;\n    }\n}","import {BitArray, bitSlice} from '../util/binary.js';\n\nexport class AACParser {\n    static get SampleRates() {return  [\n        96000, 88200,\n        64000, 48000,\n        44100, 32000,\n        24000, 22050,\n        16000, 12000,\n        11025, 8000,\n        7350];}\n\n    // static Profile = [\n    //     0: Null\n    //     1: AAC Main\n    //     2: AAC LC (Low Complexity)\n    //     3: AAC SSR (Scalable Sample Rate)\n    //     4: AAC LTP (Long Term Prediction)\n    //     5: SBR (Spectral Band Replication)\n    //     6: AAC Scalable\n    // ]\n\n    static parseAudioSpecificConfig(bytesOrBits) {\n        let config;\n        if (bytesOrBits.byteLength) { // is byteArray\n            config = new BitArray(bytesOrBits);\n        } else {\n            config = bytesOrBits;\n        }\n\n        let bitpos = config.bitpos+(config.src.byteOffset+config.bytepos)*8;\n        let prof = config.readBits(5);\n        this.codec = `mp4a.40.${prof}`;\n        let sfi = config.readBits(4);\n        if (sfi == 0xf) config.skipBits(24);\n        let channels = config.readBits(4);\n\n        return {\n            config: bitSlice(new Uint8Array(config.src.buffer), bitpos, bitpos+16),\n            codec: `mp4a.40.${prof}`,\n            samplerate: AACParser.SampleRates[sfi],\n            channels: channels\n        }\n    }\n\n    static parseStreamMuxConfig(bytes) {\n        // ISO_IEC_14496-3 Part 3 Audio. StreamMuxConfig\n        let config = new BitArray(bytes);\n\n        if (!config.readBits(1)) {\n            config.skipBits(14);\n            return AACParser.parseAudioSpecificConfig(config);\n        }\n    }\n}\n","import {getTagged} from '../../deps/bp_logger.js';\n\nimport {RTSPClientSM as RTSPClient} from './client.js';\nimport {Url} from '../../core/util/url.js';\nimport {RTSPError} from \"./client\";\n\nconst LOG_TAG = \"rtsp:session\";\nconst Log = getTagged(LOG_TAG);\n\nexport class RTSPSession {\n\n    constructor(client, sessionId) {\n        this.state = null;\n        this.client = client;\n        this.sessionId = sessionId;\n        this.url = this.getControlURL();\n    }\n\n    reset() {\n        this.client = null;\n    }\n\n    start() {\n        return this.sendPlay();\n    }\n\n    stop() {\n        return this.sendTeardown();\n    }\n\n    getControlURL() {\n        let ctrl = this.client.sdp.getSessionBlock().control;\n        if (Url.isAbsolute(ctrl)) {\n            return ctrl;\n        } else if (!ctrl || '*' === ctrl) {\n            return this.client.contentBase;\n        } else {\n            return `${this.client.contentBase}${ctrl}`;\n        }\n    }\n\n    sendRequest(_cmd, _params = {}) {\n        let params = {};\n        if (this.sessionId) {\n            params['Session'] = this.sessionId;\n        }\n        Object.assign(params, _params);\n        return this.client.sendRequest(_cmd, this.getControlURL(), params);\n    }\n\n    async sendPlay(pos = 0) {\n        this.state = RTSPClient.STATE_PLAY;\n        let params = {};\n        let range = this.client.sdp.sessionBlock.range;\n        if (range) {\n            // TODO: seekable\n            if (range[0] == -1) {\n                range[0] = 0;// Do not handle now at the moment\n            }\n            // params['Range'] = `${range[2]}=${range[0]}-`;\n        }\n        let data = await this.sendRequest('PLAY', params);\n        this.state = RTSPClient.STATE_PLAYING;\n        return {data: data};\n    }\n\n    async sendPause() {\n        if (!this.client.supports(\"PAUSE\")) {\n            return;\n        }\n        this.state = RTSPClient.STATE_PAUSE;\n        await this.sendRequest(\"PAUSE\");\n        this.state = RTSPClient.STATE_PAUSED;\n    }\n\n    async sendTeardown() {\n        if (this.state != RTSPClient.STATE_TEARDOWN) {\n            this.state = RTSPClient.STATE_TEARDOWN;\n            await this.sendRequest(\"TEARDOWN\");\n            Log.log('RTSPClient: STATE_TEARDOWN');\n            ///this.client.connection.disconnect();\n            // TODO: Notify client\n        }\n    }\n}\n","import {getTagged} from '../../deps/bp_logger.js';\nimport {StateMachine} from '../../deps/bp_statemachine.js';\nimport {SDPParser} from '../../core/parsers/sdp.js';\nimport {RTSPStream} from './stream.js';\nimport md5 from '../../core/util/md5';\n// import {RTP} from './rtp/rtp';\nimport RTPFactory from './rtp/factory.js';\nimport {MessageBuilder} from './message.js';\nimport {RTPPayloadParser} from './rtp/payload/parser.js';\nimport {BaseClient} from '../../core/base_client.js';\nimport {PayloadType} from '../../core/defs.js';\nimport {base64ToArrayBuffer, hexToByteArray} from '../../core/util/binary.js';\nimport {AACParser} from '../../core/parsers/aac.js';\nimport {RTSPSession} from \"./session\";\n\nconst LOG_TAG = \"client:rtsp\";\nconst Log = getTagged(LOG_TAG);\n\nexport class RTPError {\n    constructor(message, file, line) {\n        //super(message, file, line);\n    }\n}\n\nexport default class RTSPClient extends BaseClient {\n    constructor(options={flush: 200}) {\n        super(options);\n        this.clientSM = new RTSPClientSM(this);\n        this.clientSM.ontracks = (tracks) => {\n            this.eventSource.dispatchEvent('tracks', tracks);\n            this.startStreamFlush();\n        };\n        this.sampleQueues={};\n    }\n    \n    static streamType() {\n        return 'rtsp';\n    }\n\n    setSource(url) {\n        super.setSource(url);\n        this.clientSM.setSource(url);\n    }\n    attachTransport(transport) {\n        super.attachTransport(transport);\n        this.clientSM.transport = transport;\n    }\n\n    detachTransport() {\n        super.detachTransport();\n        this.clientSM.transport = null;\n    }\n\n    reset() {\n        super.reset();\n        this.sampleQueues={};\n    }\n\n    destroy() {\n        this.clientSM.destroy();\n        return super.destroy();\n    }\n\n    start() {\n        super.start();\n        if (this.transport) {\n            return this.transport.ready.then(() => {\n                return this.clientSM.start();\n            });\n        } else {\n            return Promise.reject(\"no transport attached\");\n        }\n    }\n\n    stop() {\n        super.stop();\n        return this.clientSM.stop();\n    }\n\n    onData(data) {\n        this.clientSM.onData(data);\n    }\n\n    onConnected() {\n        this.clientSM.onConnected();\n        super.onConnected();\n    }\n\n    onDisconnected() {\n        super.onDisconnected();\n        this.clientSM.onDisconnected();\n    }\n}\n\nclass AuthError extends Error {\n    constructor(msg) {\n        super(msg);\n    }\n}\n\nexport class RTSPError extends Error {\n    constructor(data) {\n        super(data.msg);\n        this.data = data;\n    }\n}\n\nexport class RTSPClientSM extends StateMachine {\n    static get USER_AGENT() {return 'SFRtsp 0.3';}\n    static get STATE_INITIAL() {return  1 << 0;}\n    static get STATE_OPTIONS() {return 1 << 1;}\n    static get STATE_DESCRIBE () {return  1 << 2;}\n    static get STATE_SETUP() {return  1 << 3;}\n    static get STATE_STREAMS() {return 1 << 4;}\n    static get STATE_TEARDOWN() {return  1 << 5;}\n    static get STATE_PLAY() {return  1 << 6;}\n    static get STATE_PLAYING() {return  1 << 7;}\n    static get STATE_PAUSE() {return  1 << 8;}\n    static get STATE_PAUSED() {return  1 << 9;}\n    // static STATE_PAUSED = 1 << 6;\n\n    constructor(parent) {\n        super();\n\n        this.parent = parent;\n        this.transport = null;\n        this.payParser = new RTPPayloadParser();\n        this.rtp_channels = new Set();\n        this.sessions = {};\n        this.ontracks = null;\n\n        this.addState(RTSPClientSM.STATE_INITIAL,{\n        }).addState(RTSPClientSM.STATE_OPTIONS, {\n            activate: this.sendOptions,\n            finishTransition: this.onOptions\n        }).addState(RTSPClientSM.STATE_DESCRIBE, {\n            activate: this.sendDescribe,\n            finishTransition: this.onDescribe\n        }).addState(RTSPClientSM.STATE_SETUP, {\n            activate: this.sendSetup,\n            finishTransition: this.onSetup\n        }).addState(RTSPClientSM.STATE_STREAMS, {\n\n        }).addState(RTSPClientSM.STATE_TEARDOWN, {\n            activate: ()=>{\n                this.started = false;\n            },\n            finishTransition: ()=>{\n                return this.transitionTo(RTSPClientSM.STATE_INITIAL)\n            }\n        }).addTransition(RTSPClientSM.STATE_INITIAL, RTSPClientSM.STATE_OPTIONS)\n            .addTransition(RTSPClientSM.STATE_INITIAL, RTSPClientSM.STATE_TEARDOWN)\n            .addTransition(RTSPClientSM.STATE_OPTIONS, RTSPClientSM.STATE_DESCRIBE)\n            .addTransition(RTSPClientSM.STATE_DESCRIBE, RTSPClientSM.STATE_SETUP)\n            .addTransition(RTSPClientSM.STATE_SETUP, RTSPClientSM.STATE_STREAMS)\n            .addTransition(RTSPClientSM.STATE_TEARDOWN, RTSPClientSM.STATE_INITIAL)\n            // .addTransition(RTSPClientSM.STATE_STREAMS, RTSPClientSM.STATE_PAUSED)\n            // .addTransition(RTSPClientSM.STATE_PAUSED, RTSPClientSM.STATE_STREAMS)\n            .addTransition(RTSPClientSM.STATE_STREAMS, RTSPClientSM.STATE_TEARDOWN)\n            // .addTransition(RTSPClientSM.STATE_PAUSED, RTSPClientSM.STATE_TEARDOWN)\n            .addTransition(RTSPClientSM.STATE_SETUP, RTSPClientSM.STATE_TEARDOWN)\n            .addTransition(RTSPClientSM.STATE_DESCRIBE, RTSPClientSM.STATE_TEARDOWN)\n            .addTransition(RTSPClientSM.STATE_OPTIONS, RTSPClientSM.STATE_TEARDOWN);\n\n        this.reset();\n\n        this.shouldReconnect = false;\n\n        // TODO: remove listeners\n        // this.connection.eventSource.addEventListener('connected', ()=>{\n        //     if (this.shouldReconnect) {\n        //         this.reconnect();\n        //     }\n        // });\n        // this.connection.eventSource.addEventListener('disconnected', ()=>{\n        //     if (this.started) {\n        //         this.shouldReconnect = true;\n        //     }\n        // });\n        // this.connection.eventSource.addEventListener('data', (data)=>{\n        //     let channel = new DataView(data).getUint8(1);\n        //     if (this.rtp_channels.has(channel)) {\n        //         this.onRTP({packet: new Uint8Array(data, 4), type: channel});\n        //     }\n        //\n        // });\n    }\n\n    destroy() {\n        this.parent = null;\n    }\n\n    setSource(url) {\n        this.reset();\n        this.endpoint = url;\n        this.url = `${url.protocol}://${url.location}${url.urlpath}`;\n    }\n\n    onConnected() {\n        if (this.rtpFactory) {\n            this.rtpFactory = null;\n        }\n        if (this.shouldReconnect) {\n            this.start();\n        }\n    }\n\n    async onDisconnected() {\n        this.reset();\n        this.shouldReconnect = true;\n        await this.transitionTo(RTSPClientSM.STATE_TEARDOWN);\n        await this.transitionTo(RTSPClientSM.STATE_INITIAL);\n    }\n\n    start() {\n        if (this.currentState.name !== RTSPClientSM.STATE_STREAMS) {\n            return this.transitionTo(RTSPClientSM.STATE_OPTIONS);\n        } else {\n            // TODO: seekable\n            let promises = [];\n            for (let session in this.sessions) {\n                promises.push(this.sessions[session].sendPlay());\n            }\n            return Promise.all(promises);\n        }\n    }\n\n    onData(data) {\n        let channel = data[1];\n        if (this.rtp_channels.has(channel)) {\n            this.onRTP({packet: data.subarray(4), type: channel});\n        }\n    }\n\n    useRTPChannel(channel) {\n        this.rtp_channels.add(channel);\n    }\n\n    forgetRTPChannel(channel) {\n        this.rtp_channels.delete(channel);\n    }\n\n    stop() {\n        this.shouldReconnect = false;\n        let promises = [];\n        for (let session in this.sessions) {\n            promises.push(this.sessions[session].sendPause());\n        }\n        return Promise.all(promises);\n        // this.mse = null;\n    }\n\n    async reset() {\n        this.authenticator = '';\n        this.methods = [];\n        this.tracks = [];\n        this.rtpBuffer={};\n        for (let stream in this.streams) {\n            this.streams[stream].reset();\n        }\n        for (let session in this.sessions) {\n            this.sessions[session].reset();\n        }\n        this.streams={};\n        this.sessions={};\n        this.contentBase = \"\";\n        if (this.currentState) {\n            if (this.currentState.name != RTSPClientSM.STATE_INITIAL) {\n                await this.transitionTo(RTSPClientSM.STATE_TEARDOWN);\n                await this.transitionTo(RTSPClientSM.STATE_INITIAL);\n            }\n        } else {\n            await this.transitionTo(RTSPClientSM.STATE_INITIAL);\n        }\n        this.sdp = null;\n        this.interleaveChannelIndex = 0;\n        this.session = null;\n        this.timeOffset = {};\n        this.lastTimestamp = {};\n    }\n\n    async reconnect() {\n        //this.parent.eventSource.dispatchEvent('clear');\n        await this.reset();\n        if (this.currentState.name != RTSPClientSM.STATE_INITIAL) {\n            await this.transitionTo(RTSPClientSM.STATE_TEARDOWN);\n            return this.transitionTo(RTSPClientSM.STATE_OPTIONS);\n        } else {\n            return this.transitionTo(RTSPClientSM.STATE_OPTIONS);\n        }\n    }\n\n    supports(method) {\n        return this.methods.includes(method)\n    }\n\n    parse(_data) {\n        Log.debug(_data.payload);\n        let d=_data.payload.split('\\r\\n\\r\\n');\n        let parsed =  MessageBuilder.parse(d[0]);\n        let len = Number(parsed.headers['content-length']);\n        if (len) {\n            let d=_data.payload.split('\\r\\n\\r\\n');\n            parsed.body = d[1];\n        } else {\n            parsed.body=\"\";\n        }\n        return parsed\n    }\n\n    sendRequest(_cmd, _host, _params={}, _payload=null) {\n        this.cSeq++;\n        Object.assign(_params, {\n            CSeq: this.cSeq,\n            'User-Agent': RTSPClientSM.USER_AGENT\n        });\n        if (this.authenticator) {\n            _params['Authorization'] = this.authenticator(_cmd);\n        }\n        return this.send(MessageBuilder.build(_cmd, _host, _params, _payload), _cmd).catch((e)=>{\n            if ((e instanceof AuthError) && !_params['Authorization'] ) {\n                return this.sendRequest(_cmd, _host, _params, _payload);\n            } else {\n                throw e;\n            }\n        });\n    }\n\n    async send(_data, _method) {\n        if (this.transport) {\n            try {\n                await this.transport.ready;\n            } catch(e) {\n                this.onDisconnected();\n                throw e;\n            }\n            Log.debug(_data);\n            let response = await this.transport.send(_data);\n            let parsed = this.parse(response);\n            // TODO: parse status codes\n            if (parsed.code == 401 /*&& !this.authenticator */) {\n                Log.debug(parsed.headers['www-authenticate']);\n                let auth = parsed.headers['www-authenticate'];\n                let method = auth.substring(0, auth.indexOf(' '));\n                auth = auth.substr(method.length+1);\n                let chunks = auth.split(',');\n\n                let ep = this.parent.endpoint;\n                if (!ep.user || !ep.pass) {\n                    try {\n                        await this.parent.queryCredentials.call(this.parent);\n                    } catch (e) {\n                        throw new AuthError();\n                    }\n                }\n\n                if (method.toLowerCase() == 'digest') {\n                    let parsedChunks = {};\n                    for (let chunk of chunks) {\n                        let c = chunk.trim();\n                        let [k,v] = c.split('=');\n                        parsedChunks[k] = v.substr(1, v.length-2);\n                    }\n                    this.authenticator = (_method)=>{\n                        let ep = this.parent.endpoint;\n                        let ha1 = md5(`${ep.user}:${parsedChunks.realm}:${ep.pass}`);\n                        let ha2 = md5(`${_method}:${this.url}`);\n                        let response = md5(`${ha1}:${parsedChunks.nonce}:${ha2}`);\n                        let tail=''; // TODO: handle other params\n                        return `Digest username=\"${ep.user}\", realm=\"${parsedChunks.realm}\", nonce=\"${parsedChunks.nonce}\", uri=\"${this.url}\", response=\"${response}\"${tail}`;\n                    }\n                } else {\n                    this.authenticator = ()=>{return `Basic ${btoa(this.parent.endpoint.auth)}`;};\n                }\n\n                throw new AuthError(parsed);\n            }\n            if (parsed.code >= 300) {\n                Log.error(parsed.statusLine);\n                throw new RTSPError({msg: `RTSP error: ${parsed.code} ${parsed.statusLine}`, parsed: parsed});\n            }\n            return parsed;\n        } else {\n            return Promise.reject(\"No transport attached\");\n        }\n    }\n\n    sendOptions() {\n        this.reset();\n        this.started = true;\n        this.cSeq = 0;\n        return this.sendRequest('OPTIONS', '*', {});\n    }\n\n    onOptions(data) {\n        this.methods = data.headers['public'].split(',').map((e)=>e.trim());\n        this.transitionTo(RTSPClientSM.STATE_DESCRIBE);\n    }\n\n    sendDescribe() {\n        return this.sendRequest('DESCRIBE', this.url, {\n            'Accept': 'application/sdp'\n        }).then((data)=>{\n            this.sdp = new SDPParser();\n            return this.sdp.parse(data.body).catch(()=>{\n                throw new Error(\"Failed to parse SDP\");\n            }).then(()=>{return data;});\n        });\n    }\n\n    onDescribe(data) {\n        this.contentBase = data.headers['content-base'] || this.url;// `${this.endpoint.protocol}://${this.endpoint.location}${this.endpoint.urlpath}/`;\n        this.tracks = this.sdp.getMediaBlockList();\n        this.rtpFactory = new RTPFactory(this.sdp);\n\n        Log.log('SDP contained ' + this.tracks.length + ' track(s). Calling SETUP for each.');\n\n        if (data.headers['session']) {\n            this.session = data.headers['session'];\n        }\n\n        if (!this.tracks.length) {\n            throw new Error(\"No tracks in SDP\");\n        }\n\n        this.transitionTo(RTSPClientSM.STATE_SETUP);\n    }\n\n    sendSetup() {\n        let streams=[];\n\n        // TODO: select first video and first audio tracks\n        for (let track_type of this.tracks) {\n            Log.log(\"setup track: \"+track_type);\n            // if (track_type=='audio') continue;\n            // if (track_type=='video') continue;\n            let track = this.sdp.getMediaBlock(track_type);\n            if (!PayloadType.string_map[track.rtpmap[track.fmt[0]].name]) continue;\n\n            this.streams[track_type] = new RTSPStream(this, track);\n            let setupPromise = this.streams[track_type].start();\n            this.parent.sampleQueues[PayloadType.string_map[track.rtpmap[track.fmt[0]].name]]=[];\n            this.rtpBuffer[track.fmt[0]]=[];\n            streams.push(setupPromise.then(({track, data})=>{\n                let timeOffset = 0;\n                this.timeOffset[track.fmt[0]] = 0;\n                try {\n                    let rtp_info = data.headers[\"rtp-info\"].split(';');\n                    for (let chunk of rtp_info) {\n                        let [key, val] = chunk.split(\"=\");\n                        if (key === \"rtptime\") {\n                            this.timeOffset[track.fmt[0]] = 0;//Number(val);\n                        }\n                    }\n                } catch (e) {\n                    // new Date().getTime();\n                }\n                let params = {\n                    timescale: 0,\n                    scaleFactor: 0\n                };\n                if (track.fmtp['sprop-parameter-sets']) {\n                    let sps_pps = track.fmtp['sprop-parameter-sets'].split(',');\n                    params = {\n                        sps:base64ToArrayBuffer(sps_pps[0]),\n                        pps:base64ToArrayBuffer(sps_pps[1])\n                    };\n                } else if (track.fmtp['config']) {\n                    let config = track.fmtp['config'];\n                    this.has_config = track.fmtp['cpresent']!='0';\n                    let generic = track.rtpmap[track.fmt[0]].name == 'MPEG4-GENERIC';\n                    if (generic) {\n                        params={config:\n                            AACParser.parseAudioSpecificConfig(hexToByteArray(config))\n                        };\n                        this.payParser.aacparser.setConfig(params.config);\n                    } else if (config) {\n                        // todo: parse audio specific config for mpeg4-generic\n                        params={config:\n                            AACParser.parseStreamMuxConfig(hexToByteArray(config))\n                        };\n                        this.payParser.aacparser.setConfig(params.config);\n                    }\n                }\n                params.duration = this.sdp.sessionBlock.range?this.sdp.sessionBlock.range[1]-this.sdp.sessionBlock.range[0]:1;\n                this.parent.seekable = (params.duration > 1);\n                let res = {\n                    track: track,\n                    offset: this.timeOffset[track.fmt[0]],\n                    type: PayloadType.string_map[track.rtpmap[track.fmt[0]].name],\n                    params: params,\n                    duration: params.duration\n                };\n                console.log(res, this.timeOffset);\n                let session = data.headers.session.split(';')[0];\n                if (!this.sessions[session]) {\n                    this.sessions[session] = new RTSPSession(this, session);\n                }\n                return res;\n            }));\n        }\n        return Promise.all(streams).then((tracks)=>{\n            let sessionPromises = [];\n            for (let session in this.sessions) {\n                sessionPromises.push(this.sessions[session].start());\n            }\n            return Promise.all(sessionPromises).then(()=>{\n                if (this.ontracks) {\n                    this.ontracks(tracks);\n                }\n            })\n        }).catch((e)=>{\n            console.error(e);\n            this.stop();\n            this.reset();\n        });\n    }\n\n    onSetup() {\n        this.transitionTo(RTSPClientSM.STATE_STREAMS);\n    }\n\n    onRTP(_data) {\n        if (!this.rtpFactory) return;\n\n        let rtp = this.rtpFactory.build(_data.packet, this.sdp);\n        if (!rtp.type) {\n            return;\n        }\n\n        if (this.timeOffset[rtp.pt] === undefined) {\n            //console.log(rtp.pt, this.timeOffset[rtp.pt]);\n            this.rtpBuffer[rtp.pt].push(rtp);\n            return;\n        }\n\n        if (this.lastTimestamp[rtp.pt] === undefined) {\n            this.lastTimestamp[rtp.pt] = rtp.timestamp-this.timeOffset[rtp.pt];\n        }\n\n        let queue = this.rtpBuffer[rtp.pt];\n        queue.push(rtp);\n\n        while (queue.length) {\n            let rtp = queue.shift();\n\n            rtp.timestamp = rtp.timestamp-this.timeOffset[rtp.pt]-this.lastTimestamp[rtp.pt];\n            // TODO: overflow\n            // if (rtp.timestamp < 0) {\n            //     rtp.timestamp = (rtp.timestamp + Number.MAX_SAFE_INTEGER) % 0x7fffffff;\n            // }\n            if (rtp.media) {\n                let pay = this.payParser.parse(rtp);\n                if (pay) {\n                    // if (typeof pay == typeof []) {\n                    this.parent.sampleQueues[rtp.type].push(pay);\n                    // } else {\n                    //     this.parent.sampleQueues[rtp.type].push([pay]);\n                    // }\n                }\n            }\n        }\n        // this.remuxer.feedRTP();\n    }\n}","// ASN.1 JavaScript decoder\r\n// Copyright (c) 2008-2013 Lapo Luchini <lapo@lapo.it>\r\n\r\n// Permission to use, copy, modify, and/or distribute this software for any\r\n// purpose with or without fee is hereby granted, provided that the above\r\n// copyright notice and this permission notice appear in all copies.\r\n// \r\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\r\n// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\r\n// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\r\n// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\r\n// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\r\n// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\r\n// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n\r\n/*jshint browser: true, strict: true, immed: true, latedef: true, undef: true, regexdash: false */\r\n/*global oids */\r\n\r\nvar hardLimit = 100,\r\n    ellipsis = \"\\u2026\",\r\n    DOM = {\r\n        tag: function (tagName, className) {\r\n            var t = document.createElement(tagName);\r\n            t.className = className;\r\n            return t;\r\n        },\r\n        text: function (str) {\r\n            return document.createTextNode(str);\r\n        }\r\n    };\r\n\r\nclass Stream {\r\n    static get hexDigits() {\r\n        return \"0123456789ABCDEF\";\r\n    };\r\n\r\n    static get reTime() {\r\n        return /^((?:1[89]|2\\d)?\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/;\r\n    }\r\n\r\n\r\n    constructor(enc, pos) {\r\n        if (enc instanceof Stream) {\r\n            this.enc = enc.enc;\r\n            this.pos = enc.pos;\r\n        } else {\r\n            this.enc = enc;\r\n            this.pos = pos;\r\n        }\r\n    }\r\n\r\n    get(pos) {\r\n        if (pos === undefined)\r\n            pos = this.pos++;\r\n        if (pos >= this.enc.length)\r\n            throw 'Requesting byte offset ' + pos + ' on a stream of length ' + this.enc.length;\r\n        return this.enc[pos];\r\n    };\r\n\r\n    hexByte(b) {\r\n        return Stream.hexDigits.charAt((b >> 4) & 0xF) + Stream.hexDigits.charAt(b & 0xF);\r\n    };\r\n\r\n    hexDump(start, end, raw) {\r\n        var s = \"\";\r\n        for (var i = start; i < end; ++i) {\r\n            s += this.hexByte(this.get(i));\r\n            if (raw !== true)\r\n                switch (i & 0xF) {\r\n                    case 0x7:\r\n                        s += \"  \";\r\n                        break;\r\n                    case 0xF:\r\n                        s += \"\\n\";\r\n                        break;\r\n                    default:\r\n                        s += \" \";\r\n                }\r\n        }\r\n        return s;\r\n    };\r\n\r\n    parseStringISO(start, end) {\r\n        var s = \"\";\r\n        for (var i = start; i < end; ++i)\r\n            s += String.fromCharCode(this.get(i));\r\n        return s;\r\n    };\r\n\r\n    parseStringUTF(start, end) {\r\n        var s = \"\";\r\n        for (var i = start; i < end;) {\r\n            var c = this.get(i++);\r\n            if (c < 128)\r\n                s += String.fromCharCode(c);\r\n            else if ((c > 191) && (c < 224))\r\n                s += String.fromCharCode(((c & 0x1F) << 6) | (this.get(i++) & 0x3F));\r\n            else\r\n                s += String.fromCharCode(((c & 0x0F) << 12) | ((this.get(i++) & 0x3F) << 6) | (this.get(i++) & 0x3F));\r\n        }\r\n        return s;\r\n    };\r\n\r\n    parseStringBMP(start, end) {\r\n        var str = \"\"\r\n        for (var i = start; i < end; i += 2) {\r\n            var high_byte = this.get(i);\r\n            var low_byte = this.get(i + 1);\r\n            str += String.fromCharCode((high_byte << 8) + low_byte);\r\n        }\r\n\r\n        return str;\r\n    };\r\n\r\n    parseTime(start, end) {\r\n        var s = this.parseStringISO(start, end),\r\n            m = Stream.reTime.exec(s);\r\n        if (!m)\r\n            return \"Unrecognized time: \" + s;\r\n        s = m[1] + \"-\" + m[2] + \"-\" + m[3] + \" \" + m[4];\r\n        if (m[5]) {\r\n            s += \":\" + m[5];\r\n            if (m[6]) {\r\n                s += \":\" + m[6];\r\n                if (m[7])\r\n                    s += \".\" + m[7];\r\n            }\r\n        }\r\n        if (m[8]) {\r\n            s += \" UTC\";\r\n            if (m[8] != 'Z') {\r\n                s += m[8];\r\n                if (m[9])\r\n                    s += \":\" + m[9];\r\n            }\r\n        }\r\n        return s;\r\n    };\r\n\r\n    parseInteger(start, end) {\r\n        //TODO support negative numbers\r\n        var len = end - start;\r\n        if (len > 4) {\r\n            len <<= 3;\r\n            var s = this.get(start);\r\n            if (s === 0)\r\n                len -= 8;\r\n            else\r\n                while (s < 128) {\r\n                    s <<= 1;\r\n                    --len;\r\n                }\r\n            return \"(\" + len + \" bit)\";\r\n        }\r\n        var n = 0;\r\n        for (var i = start; i < end; ++i)\r\n            n = (n << 8) | this.get(i);\r\n        return n;\r\n    };\r\n\r\n    parseBitString(start, end) {\r\n        var unusedBit = this.get(start),\r\n            lenBit = ((end - start - 1) << 3) - unusedBit,\r\n            s = \"(\" + lenBit + \" bit)\";\r\n        if (lenBit <= 20) {\r\n            var skip = unusedBit;\r\n            s += \" \";\r\n            for (var i = end - 1; i > start; --i) {\r\n                var b = this.get(i);\r\n                for (var j = skip; j < 8; ++j)\r\n                    s += (b >> j) & 1 ? \"1\" : \"0\";\r\n                skip = 0;\r\n            }\r\n        }\r\n        return s;\r\n    };\r\n\r\n    parseOctetString(start, end) {\r\n        var len = end - start,\r\n            s = \"(\" + len + \" byte) \";\r\n        if (len > hardLimit)\r\n            end = start + hardLimit;\r\n        for (var i = start; i < end; ++i)\r\n            s += this.hexByte(this.get(i)); //TODO: also try Latin1?\r\n        if (len > hardLimit)\r\n            s += ellipsis;\r\n        return s;\r\n    };\r\n\r\n    parseOID(start, end) {\r\n        var s = '',\r\n            n = 0,\r\n            bits = 0;\r\n        for (var i = start; i < end; ++i) {\r\n            var v = this.get(i);\r\n            n = (n << 7) | (v & 0x7F);\r\n            bits += 7;\r\n            if (!(v & 0x80)) { // finished\r\n                if (s === '') {\r\n                    var m = n < 80 ? n < 40 ? 0 : 1 : 2;\r\n                    s = m + \".\" + (n - m * 40);\r\n                } else\r\n                    s += \".\" + ((bits >= 31) ? \"bigint\" : n);\r\n                n = bits = 0;\r\n            }\r\n        }\r\n        return s;\r\n    };\r\n}\r\n\r\nexport class ASN1 {\r\n    static get reSeemsASCII() {\r\n        return /^[ -~]+$/;\r\n    }\r\n\r\n    constructor(stream, header, length, tag, sub) {\r\n        this.stream = stream;\r\n        this.header = header;\r\n        this.length = length;\r\n        this.tag = tag;\r\n        this.sub = sub;\r\n    }\r\n\r\n    typeName() {\r\n        if (this.tag === undefined)\r\n            return \"unknown\";\r\n        var tagClass = this.tag >> 6,\r\n            tagConstructed = (this.tag >> 5) & 1,\r\n            tagNumber = this.tag & 0x1F;\r\n        switch (tagClass) {\r\n            case 0: // universal\r\n                switch (tagNumber) {\r\n                    case 0x00:\r\n                        return \"EOC\";\r\n                    case 0x01:\r\n                        return \"BOOLEAN\";\r\n                    case 0x02:\r\n                        return \"INTEGER\";\r\n                    case 0x03:\r\n                        return \"BIT_STRING\";\r\n                    case 0x04:\r\n                        return \"OCTET_STRING\";\r\n                    case 0x05:\r\n                        return \"NULL\";\r\n                    case 0x06:\r\n                        return \"OBJECT_IDENTIFIER\";\r\n                    case 0x07:\r\n                        return \"ObjectDescriptor\";\r\n                    case 0x08:\r\n                        return \"EXTERNAL\";\r\n                    case 0x09:\r\n                        return \"REAL\";\r\n                    case 0x0A:\r\n                        return \"ENUMERATED\";\r\n                    case 0x0B:\r\n                        return \"EMBEDDED_PDV\";\r\n                    case 0x0C:\r\n                        return \"UTF8String\";\r\n                    case 0x10:\r\n                        return \"SEQUENCE\";\r\n                    case 0x11:\r\n                        return \"SET\";\r\n                    case 0x12:\r\n                        return \"NumericString\";\r\n                    case 0x13:\r\n                        return \"PrintableString\"; // ASCII subset\r\n                    case 0x14:\r\n                        return \"TeletexString\"; // aka T61String\r\n                    case 0x15:\r\n                        return \"VideotexString\";\r\n                    case 0x16:\r\n                        return \"IA5String\"; // ASCII\r\n                    case 0x17:\r\n                        return \"UTCTime\";\r\n                    case 0x18:\r\n                        return \"GeneralizedTime\";\r\n                    case 0x19:\r\n                        return \"GraphicString\";\r\n                    case 0x1A:\r\n                        return \"VisibleString\"; // ASCII subset\r\n                    case 0x1B:\r\n                        return \"GeneralString\";\r\n                    case 0x1C:\r\n                        return \"UniversalString\";\r\n                    case 0x1E:\r\n                        return \"BMPString\";\r\n                    default:\r\n                        return \"Universal_\" + tagNumber.toString(16);\r\n                }\r\n            case 1:\r\n                return \"Application_\" + tagNumber.toString(16);\r\n            case 2:\r\n                return \"[\" + tagNumber + \"]\"; // Context\r\n            case 3:\r\n                return \"Private_\" + tagNumber.toString(16);\r\n        }\r\n    }\r\n\r\n    content() {\r\n        if (this.tag === undefined)\r\n            return null;\r\n        var tagClass = this.tag >> 6,\r\n            tagNumber = this.tag & 0x1F,\r\n            content = this.posContent(),\r\n            len = Math.abs(this.length);\r\n        if (tagClass !== 0) { // universal\r\n            if (this.sub !== null)\r\n                return \"(\" + this.sub.length + \" elem)\";\r\n            //TODO: TRY TO PARSE ASCII STRING\r\n            var s = this.stream.parseStringISO(content, content + Math.min(len, hardLimit));\r\n            if (ASN1.reSeemsASCII.test(s))\r\n                return s.substring(0, 2 * hardLimit) + ((s.length > 2 * hardLimit) ? ellipsis : \"\");\r\n            else\r\n                return this.stream.parseOctetString(content, content + len);\r\n        }\r\n        switch (tagNumber) {\r\n            case 0x01: // BOOLEAN\r\n                return (this.stream.get(content) === 0) ? \"false\" : \"true\";\r\n            case 0x02: // INTEGER\r\n                return this.stream.parseInteger(content, content + len);\r\n            case 0x03: // BIT_STRING\r\n                return this.sub ? \"(\" + this.sub.length + \" elem)\" :\r\n                    this.stream.parseBitString(content, content + len);\r\n            case 0x04: // OCTET_STRING\r\n                return this.sub ? \"(\" + this.sub.length + \" elem)\" :\r\n                    this.stream.parseOctetString(content, content + len);\r\n            //case 0x05: // NULL\r\n            case 0x06: // OBJECT_IDENTIFIER\r\n                return this.stream.parseOID(content, content + len);\r\n            //case 0x07: // ObjectDescriptor\r\n            //case 0x08: // EXTERNAL\r\n            //case 0x09: // REAL\r\n            //case 0x0A: // ENUMERATED\r\n            //case 0x0B: // EMBEDDED_PDV\r\n            case 0x10: // SEQUENCE\r\n            case 0x11: // SET\r\n                return \"(\" + this.sub.length + \" elem)\";\r\n            case 0x0C: // UTF8String\r\n                return this.stream.parseStringUTF(content, content + len);\r\n            case 0x12: // NumericString\r\n            case 0x13: // PrintableString\r\n            case 0x14: // TeletexString\r\n            case 0x15: // VideotexString\r\n            case 0x16: // IA5String\r\n            //case 0x19: // GraphicString\r\n            case 0x1A: // VisibleString\r\n                //case 0x1B: // GeneralString\r\n                //case 0x1C: // UniversalString\r\n                return this.stream.parseStringISO(content, content + len);\r\n            case 0x1E: // BMPString\r\n                return this.stream.parseStringBMP(content, content + len);\r\n            case 0x17: // UTCTime\r\n            case 0x18: // GeneralizedTime\r\n                return this.stream.parseTime(content, content + len);\r\n        }\r\n        return null;\r\n    };\r\n\r\n    toString() {\r\n        return this.typeName() + \"@\" + this.stream.pos + \"[header:\" + this.header + \",length:\" + this.length + \",sub:\" + ((this.sub === null) ? 'null' : this.sub.length) + \"]\";\r\n    };\r\n\r\n    print(indent) {\r\n        if (indent === undefined) indent = '';\r\n        document.writeln(indent + this);\r\n        if (this.sub !== null) {\r\n            indent += '  ';\r\n            for (var i = 0, max = this.sub.length; i < max; ++i)\r\n                this.sub[i].print(indent);\r\n        }\r\n    };\r\n\r\n    toPrettyString(indent) {\r\n        if (indent === undefined) indent = '';\r\n        var s = indent + this.typeName() + \" @\" + this.stream.pos;\r\n        if (this.length >= 0)\r\n            s += \"+\";\r\n        s += this.length;\r\n        if (this.tag & 0x20)\r\n            s += \" (constructed)\";\r\n        else if (((this.tag == 0x03) || (this.tag == 0x04)) && (this.sub !== null))\r\n            s += \" (encapsulates)\";\r\n        s += \"\\n\";\r\n        if (this.sub !== null) {\r\n            indent += '  ';\r\n            for (var i = 0, max = this.sub.length; i < max; ++i)\r\n                s += this.sub[i].toPrettyString(indent);\r\n        }\r\n        return s;\r\n    };\r\n\r\n    toDOM() {\r\n        var node = DOM.tag(\"div\", \"node\");\r\n        node.asn1 = this;\r\n        var head = DOM.tag(\"div\", \"head\");\r\n        var s = this.typeName().replace(/_/g, \" \");\r\n        head.innerHTML = s;\r\n        var content = this.content();\r\n        if (content !== null) {\r\n            content = String(content).replace(/</g, \"&lt;\");\r\n            var preview = DOM.tag(\"span\", \"preview\");\r\n            preview.appendChild(DOM.text(content));\r\n            head.appendChild(preview);\r\n        }\r\n        node.appendChild(head);\r\n        this.node = node;\r\n        this.head = head;\r\n        var value = DOM.tag(\"div\", \"value\");\r\n        s = \"Offset: \" + this.stream.pos + \"<br/>\";\r\n        s += \"Length: \" + this.header + \"+\";\r\n        if (this.length >= 0)\r\n            s += this.length;\r\n        else\r\n            s += (-this.length) + \" (undefined)\";\r\n        if (this.tag & 0x20)\r\n            s += \"<br/>(constructed)\";\r\n        else if (((this.tag == 0x03) || (this.tag == 0x04)) && (this.sub !== null))\r\n            s += \"<br/>(encapsulates)\";\r\n        //TODO if (this.tag == 0x03) s += \"Unused bits: \"\r\n        if (content !== null) {\r\n            s += \"<br/>Value:<br/><b>\" + content + \"</b>\";\r\n            if ((typeof oids === 'object') && (this.tag == 0x06)) {\r\n                var oid = oids[content];\r\n                if (oid) {\r\n                    if (oid.d) s += \"<br/>\" + oid.d;\r\n                    if (oid.c) s += \"<br/>\" + oid.c;\r\n                    if (oid.w) s += \"<br/>(warning!)\";\r\n                }\r\n            }\r\n        }\r\n        value.innerHTML = s;\r\n        node.appendChild(value);\r\n        var sub = DOM.tag(\"div\", \"sub\");\r\n        if (this.sub !== null) {\r\n            for (var i = 0, max = this.sub.length; i < max; ++i)\r\n                sub.appendChild(this.sub[i].toDOM());\r\n        }\r\n        node.appendChild(sub);\r\n        head.onclick = function () {\r\n            node.className = (node.className == \"node collapsed\") ? \"node\" : \"node collapsed\";\r\n        };\r\n        return node;\r\n    };\r\n\r\n    posStart() {\r\n        return this.stream.pos;\r\n    };\r\n\r\n    posContent() {\r\n        return this.stream.pos + this.header;\r\n    };\r\n\r\n    posEnd() {\r\n        return this.stream.pos + this.header + Math.abs(this.length);\r\n    };\r\n\r\n    fakeHover(current) {\r\n        this.node.className += \" hover\";\r\n        if (current)\r\n            this.head.className += \" hover\";\r\n    };\r\n\r\n    fakeOut(current) {\r\n        var re = / ?hover/;\r\n        this.node.className = this.node.className.replace(re, \"\");\r\n        if (current)\r\n            this.head.className = this.head.className.replace(re, \"\");\r\n    };\r\n\r\n    toHexDOM_sub(node, className, stream, start, end) {\r\n        if (start >= end)\r\n            return;\r\n        var sub = DOM.tag(\"span\", className);\r\n        sub.appendChild(DOM.text(\r\n            stream.hexDump(start, end)));\r\n        node.appendChild(sub);\r\n    };\r\n\r\n    toHexDOM(root) {\r\n        var node = DOM.tag(\"span\", \"hex\");\r\n        if (root === undefined) root = node;\r\n        this.head.hexNode = node;\r\n        this.head.onmouseover = function () {\r\n            this.hexNode.className = \"hexCurrent\";\r\n        };\r\n        this.head.onmouseout = function () {\r\n            this.hexNode.className = \"hex\";\r\n        };\r\n        node.asn1 = this;\r\n        node.onmouseover = function () {\r\n            var current = !root.selected;\r\n            if (current) {\r\n                root.selected = this.asn1;\r\n                this.className = \"hexCurrent\";\r\n            }\r\n            this.asn1.fakeHover(current);\r\n        };\r\n        node.onmouseout = function () {\r\n            var current = (root.selected == this.asn1);\r\n            this.asn1.fakeOut(current);\r\n            if (current) {\r\n                root.selected = null;\r\n                this.className = \"hex\";\r\n            }\r\n        };\r\n        this.toHexDOM_sub(node, \"tag\", this.stream, this.posStart(), this.posStart() + 1);\r\n        this.toHexDOM_sub(node, (this.length >= 0) ? \"dlen\" : \"ulen\", this.stream, this.posStart() + 1, this.posContent());\r\n        if (this.sub === null)\r\n            node.appendChild(DOM.text(\r\n                this.stream.hexDump(this.posContent(), this.posEnd())));\r\n        else if (this.sub.length > 0) {\r\n            var first = this.sub[0];\r\n            var last = this.sub[this.sub.length - 1];\r\n            this.toHexDOM_sub(node, \"intro\", this.stream, this.posContent(), first.posStart());\r\n            for (var i = 0, max = this.sub.length; i < max; ++i)\r\n                node.appendChild(this.sub[i].toHexDOM(root));\r\n            this.toHexDOM_sub(node, \"outro\", this.stream, last.posEnd(), this.posEnd());\r\n        }\r\n        return node;\r\n    };\r\n\r\n    toHexString(root) {\r\n        return this.stream.hexDump(this.posStart(), this.posEnd(), true);\r\n    };\r\n\r\n}\r\n\r\nASN1.decodeLength = function (stream) {\r\n    var buf = stream.get(),\r\n        len = buf & 0x7F;\r\n    if (len == buf)\r\n        return len;\r\n    if (len > 3)\r\n        throw \"Length over 24 bits not supported at position \" + (stream.pos - 1);\r\n    if (len === 0)\r\n        return -1; // undefined\r\n    buf = 0;\r\n    for (var i = 0; i < len; ++i)\r\n        buf = (buf << 8) | stream.get();\r\n    return buf;\r\n};\r\nASN1.hasContent = function (tag, len, stream) {\r\n    if (tag & 0x20) // constructed\r\n        return true;\r\n    if ((tag < 0x03) || (tag > 0x04))\r\n        return false;\r\n    var p = new Stream(stream);\r\n    if (tag == 0x03) p.get(); // BitString unused bits, must be in [0, 7]\r\n    var subTag = p.get();\r\n    if ((subTag >> 6) & 0x01) // not (universal or context)\r\n        return false;\r\n    try {\r\n        var subLength = ASN1.decodeLength(p);\r\n        return ((p.pos - stream.pos) + subLength == len);\r\n    } catch (exception) {\r\n        return false;\r\n    }\r\n};\r\nASN1.decode = function (stream) {\r\n    if (!(stream instanceof Stream))\r\n        stream = new Stream(stream, 0);\r\n    var streamStart = new Stream(stream),\r\n        tag = stream.get(),\r\n        len = ASN1.decodeLength(stream),\r\n        header = stream.pos - streamStart.pos,\r\n        sub = null;\r\n    if (ASN1.hasContent(tag, len, stream)) {\r\n        // it has content, so we decode it\r\n        var start = stream.pos;\r\n        if (tag == 0x03) stream.get(); // skip BitString unused bits, must be in [0, 7]\r\n        sub = [];\r\n        if (len >= 0) {\r\n            // definite length\r\n            var end = start + len;\r\n            while (stream.pos < end)\r\n                sub[sub.length] = ASN1.decode(stream);\r\n            if (stream.pos != end)\r\n                throw \"Content size is not correct for container starting at offset \" + start;\r\n        } else {\r\n            // undefined length\r\n            try {\r\n                for (; ;) {\r\n                    var s = ASN1.decode(stream);\r\n                    if (s.tag === 0)\r\n                        break;\r\n                    sub[sub.length] = s;\r\n                }\r\n                len = start - stream.pos;\r\n            } catch (e) {\r\n                throw \"Exception while decoding undefined length content: \" + e;\r\n            }\r\n        }\r\n    } else\r\n        stream.pos += len; // skip content\r\n    return new ASN1(streamStart, header, len, tag, sub);\r\n};\r\nASN1.test = function () {\r\n    var test = [\r\n        {value: [0x27], expected: 0x27},\r\n        {value: [0x81, 0xC9], expected: 0xC9},\r\n        {value: [0x83, 0xFE, 0xDC, 0xBA], expected: 0xFEDCBA}\r\n    ];\r\n    for (var i = 0, max = test.length; i < max; ++i) {\r\n        var pos = 0,\r\n            stream = new Stream(test[i].value, 0),\r\n            res = ASN1.decodeLength(stream);\r\n        if (res != test[i].expected)\r\n            document.write(\"In test[\" + i + \"] expected \" + test[i].expected + \" got \" + res + \"\\n\");\r\n    }\r\n};","// prng4.js - uses Arcfour as a PRNG\r\n\r\nexport class Arcfour {\r\n  constructor() {\r\n    this.i = 0;\r\n    this.j = 0;\r\n    this.S = [];\r\n  }\r\n}\r\n\r\n// Initialize arcfour context from key, an array of ints, each from [0..255]\r\nfunction ARC4init(key) {\r\n  var i, j, t;\r\n  for(i = 0; i < 256; ++i)\r\n    this.S[i] = i;\r\n  j = 0;\r\n  for(i = 0; i < 256; ++i) {\r\n    j = (j + this.S[i] + key[i % key.length]) & 255;\r\n    t = this.S[i];\r\n    this.S[i] = this.S[j];\r\n    this.S[j] = t;\r\n  }\r\n  this.i = 0;\r\n  this.j = 0;\r\n}\r\n\r\nfunction ARC4next() {\r\n  var t;\r\n  this.i = (this.i + 1) & 255;\r\n  this.j = (this.j + this.S[this.i]) & 255;\r\n  t = this.S[this.i];\r\n  this.S[this.i] = this.S[this.j];\r\n  this.S[this.j] = t;\r\n  return this.S[(t + this.S[this.i]) & 255];\r\n}\r\n\r\nArcfour.prototype.init = ARC4init;\r\nArcfour.prototype.next = ARC4next;\r\n\r\n// Plug in your RNG constructor here\r\nexport function prng_newstate() {\r\n  return new Arcfour();\r\n}\r\n\r\n// Pool size must be a multiple of 4 and greater than 32.\r\n// An array of bytes the size of the pool will be passed to init()\r\nexport var rng_psize = 256;\r\n","import {rng_psize} from \"./prng4\";\r\nimport {prng_newstate} from \"./prng4\";\r\n// Random number generator - requires a PRNG backend, e.g. prng4.js\r\nvar rng_state;\r\nvar rng_pool;\r\nvar rng_pptr;\r\n\r\n// Initialize the pool with junk if needed.\r\nif(rng_pool == null) {\r\n  rng_pool = new Array();\r\n  rng_pptr = 0;\r\n  var t;\r\n  if(window.crypto && window.crypto.getRandomValues) {\r\n    // Extract entropy (2048 bits) from RNG if available\r\n    var z = new Uint32Array(256);\r\n    window.crypto.getRandomValues(z);\r\n    for (t = 0; t < z.length; ++t)\r\n      rng_pool[rng_pptr++] = z[t] & 255;\r\n  }\r\n\r\n  // Use mouse events for entropy, if we do not have enough entropy by the time\r\n  // we need it, entropy will be generated by Math.random.\r\n  var onMouseMoveListener = function(ev) {\r\n    this.count = this.count || 0;\r\n    if (this.count >= 256 || rng_pptr >= rng_psize) {\r\n      if (window.removeEventListener)\r\n        window.removeEventListener(\"mousemove\", onMouseMoveListener, false);\r\n      else if (window.detachEvent)\r\n        window.detachEvent(\"onmousemove\", onMouseMoveListener);\r\n      return;\r\n    }\r\n    try {\r\n      var mouseCoordinates = ev.x + ev.y;\r\n      rng_pool[rng_pptr++] = mouseCoordinates & 255;\r\n      this.count += 1;\r\n    } catch (e) {\r\n      // Sometimes Firefox will deny permission to access event properties for some reason. Ignore.\r\n    }\r\n  };\r\n  if (window.addEventListener)\r\n    window.addEventListener(\"mousemove\", onMouseMoveListener, false);\r\n  else if (window.attachEvent)\r\n    window.attachEvent(\"onmousemove\", onMouseMoveListener);\r\n\r\n}\r\n\r\nfunction rng_get_byte() {\r\n  if(rng_state == null) {\r\n    rng_state = prng_newstate();\r\n    // At this point, we may not have collected enough entropy.  If not, fall back to Math.random\r\n    while (rng_pptr < rng_psize) {\r\n      var random = Math.floor(65536 * Math.random());\r\n      rng_pool[rng_pptr++] = random & 255;\r\n    }\r\n    rng_state.init(rng_pool);\r\n    for(rng_pptr = 0; rng_pptr < rng_pool.length; ++rng_pptr)\r\n      rng_pool[rng_pptr] = 0;\r\n    rng_pptr = 0;\r\n  }\r\n  // TODO: allow reseeding after first request\r\n  return rng_state.next();\r\n}\r\n\r\nfunction rng_get_bytes(ba) {\r\n  var i;\r\n  for(i = 0; i < ba.length; ++i) ba[i] = rng_get_byte();\r\n}\r\n\r\nexport class SecureRandom {\r\n  constructor(){}\r\n}\r\n\r\nSecureRandom.prototype.nextBytes = rng_get_bytes;\r\n","// Copyright (c) 2005  Tom Wu\r\n// All Rights Reserved.\r\n// See \"LICENSE\" for details.\r\n\r\n// Basic JavaScript BN library - subset useful for RSA encryption.\r\n\r\n// Bits per digit\r\nvar dbits;\r\n\r\n// JavaScript engine analysis\r\nvar canary = 0xdeadbeefcafe;\r\nvar j_lm = ((canary&0xffffff)==0xefcafe);\r\n\r\n// (public) Constructor\r\nexport class BigInteger {\r\n  constructor(a,b,c) {\r\n    if (a != null)\r\n      if (\"number\" == typeof a) this.fromNumber(a, b, c);\r\n      else if (b == null && \"string\" != typeof a) this.fromString(a, 256);\r\n      else this.fromString(a, b);\r\n  }\r\n}\r\n\r\n// return new, unset BigInteger\r\nexport function nbi() { return new BigInteger(null); }\r\n\r\n// am: Compute w_j += (x*this_i), propagate carries,\r\n// c is initial carry, returns final carry.\r\n// c < 3*dvalue, x < 2*dvalue, this_i < dvalue\r\n// We need to select the fastest one that works in this environment.\r\n\r\n// am1: use a single mult and divide to get the high bits,\r\n// max digit bits should be 26 because\r\n// max internal value = 2*dvalue^2-2*dvalue (< 2^53)\r\nfunction am1(i,x,w,j,c,n) {\r\n  while(--n >= 0) {\r\n    var v = x*this[i++]+w[j]+c;\r\n    c = Math.floor(v/0x4000000);\r\n    w[j++] = v&0x3ffffff;\r\n  }\r\n  return c;\r\n}\r\n// am2 avoids a big mult-and-extract completely.\r\n// Max digit bits should be <= 30 because we do bitwise ops\r\n// on values up to 2*hdvalue^2-hdvalue-1 (< 2^31)\r\nfunction am2(i,x,w,j,c,n) {\r\n  var xl = x&0x7fff, xh = x>>15;\r\n  while(--n >= 0) {\r\n    var l = this[i]&0x7fff;\r\n    var h = this[i++]>>15;\r\n    var m = xh*l+h*xl;\r\n    l = xl*l+((m&0x7fff)<<15)+w[j]+(c&0x3fffffff);\r\n    c = (l>>>30)+(m>>>15)+xh*h+(c>>>30);\r\n    w[j++] = l&0x3fffffff;\r\n  }\r\n  return c;\r\n}\r\n// Alternately, set max digit bits to 28 since some\r\n// browsers slow down when dealing with 32-bit numbers.\r\nfunction am3(i,x,w,j,c,n) {\r\n  var xl = x&0x3fff, xh = x>>14;\r\n  while(--n >= 0) {\r\n    var l = this[i]&0x3fff;\r\n    var h = this[i++]>>14;\r\n    var m = xh*l+h*xl;\r\n    l = xl*l+((m&0x3fff)<<14)+w[j]+c;\r\n    c = (l>>28)+(m>>14)+xh*h;\r\n    w[j++] = l&0xfffffff;\r\n  }\r\n  return c;\r\n}\r\nif(j_lm && (navigator.appName == \"Microsoft Internet Explorer\")) {\r\n  BigInteger.prototype.am = am2;\r\n  dbits = 30;\r\n}\r\nelse if(j_lm && (navigator.appName != \"Netscape\")) {\r\n  BigInteger.prototype.am = am1;\r\n  dbits = 26;\r\n}\r\nelse { // Mozilla/Netscape seems to prefer am3\r\n  BigInteger.prototype.am = am3;\r\n  dbits = 28;\r\n}\r\n\r\nBigInteger.prototype.DB = dbits;\r\nBigInteger.prototype.DM = ((1<<dbits)-1);\r\nBigInteger.prototype.DV = (1<<dbits);\r\n\r\nvar BI_FP = 52;\r\nBigInteger.prototype.FV = Math.pow(2,BI_FP);\r\nBigInteger.prototype.F1 = BI_FP-dbits;\r\nBigInteger.prototype.F2 = 2*dbits-BI_FP;\r\n\r\n// Digit conversions\r\nvar BI_RM = \"0123456789abcdefghijklmnopqrstuvwxyz\";\r\nvar BI_RC = [];\r\nvar rr,vv;\r\nrr = \"0\".charCodeAt(0);\r\nfor(vv = 0; vv <= 9; ++vv) BI_RC[rr++] = vv;\r\nrr = \"a\".charCodeAt(0);\r\nfor(vv = 10; vv < 36; ++vv) BI_RC[rr++] = vv;\r\nrr = \"A\".charCodeAt(0);\r\nfor(vv = 10; vv < 36; ++vv) BI_RC[rr++] = vv;\r\n\r\nexport function int2char(n) { return BI_RM.charAt(n); }\r\nexport function intAt(s,i) {\r\n  var c = BI_RC[s.charCodeAt(i)];\r\n  return (c==null)?-1:c;\r\n}\r\n\r\n// (protected) copy this to r\r\nfunction bnpCopyTo(r) {\r\n  for(var i = this.t-1; i >= 0; --i) r[i] = this[i];\r\n  r.t = this.t;\r\n  r.s = this.s;\r\n}\r\n\r\n// (protected) set from integer value x, -DV <= x < DV\r\nfunction bnpFromInt(x) {\r\n  this.t = 1;\r\n  this.s = (x<0)?-1:0;\r\n  if(x > 0) this[0] = x;\r\n  else if(x < -1) this[0] = x+this.DV;\r\n  else this.t = 0;\r\n}\r\n\r\n// return bigint initialized to value\r\nexport function nbv(i) { var r = nbi(); r.fromInt(i); return r; }\r\n\r\n// (protected) set from string and radix\r\nfunction bnpFromString(s,b) {\r\n  var k;\r\n  if(b == 16) k = 4;\r\n  else if(b == 8) k = 3;\r\n  else if(b == 256) k = 8; // byte array\r\n  else if(b == 2) k = 1;\r\n  else if(b == 32) k = 5;\r\n  else if(b == 4) k = 2;\r\n  else { this.fromRadix(s,b); return; }\r\n  this.t = 0;\r\n  this.s = 0;\r\n  var i = s.length, mi = false, sh = 0;\r\n  while(--i >= 0) {\r\n    var x = (k==8)?s[i]&0xff:intAt(s,i);\r\n    if(x < 0) {\r\n      if(s.charAt(i) == \"-\") mi = true;\r\n      continue;\r\n    }\r\n    mi = false;\r\n    if(sh == 0)\r\n      this[this.t++] = x;\r\n    else if(sh+k > this.DB) {\r\n      this[this.t-1] |= (x&((1<<(this.DB-sh))-1))<<sh;\r\n      this[this.t++] = (x>>(this.DB-sh));\r\n    }\r\n    else\r\n      this[this.t-1] |= x<<sh;\r\n    sh += k;\r\n    if(sh >= this.DB) sh -= this.DB;\r\n  }\r\n  if(k == 8 && (s[0]&0x80) != 0) {\r\n    this.s = -1;\r\n    if(sh > 0) this[this.t-1] |= ((1<<(this.DB-sh))-1)<<sh;\r\n  }\r\n  this.clamp();\r\n  if(mi) BigInteger.ZERO.subTo(this,this);\r\n}\r\n\r\n// (protected) clamp off excess high words\r\nfunction bnpClamp() {\r\n  var c = this.s&this.DM;\r\n  while(this.t > 0 && this[this.t-1] == c) --this.t;\r\n}\r\n\r\n// (public) return string representation in given radix\r\nfunction bnToString(b) {\r\n  if(this.s < 0) return \"-\"+this.negate().toString(b);\r\n  var k;\r\n  if(b == 16) k = 4;\r\n  else if(b == 8) k = 3;\r\n  else if(b == 2) k = 1;\r\n  else if(b == 32) k = 5;\r\n  else if(b == 4) k = 2;\r\n  else return this.toRadix(b);\r\n  var km = (1<<k)-1, d, m = false, r = \"\", i = this.t;\r\n  var p = this.DB-(i*this.DB)%k;\r\n  if(i-- > 0) {\r\n    if(p < this.DB && (d = this[i]>>p) > 0) { m = true; r = int2char(d); }\r\n    while(i >= 0) {\r\n      if(p < k) {\r\n        d = (this[i]&((1<<p)-1))<<(k-p);\r\n        d |= this[--i]>>(p+=this.DB-k);\r\n      }\r\n      else {\r\n        d = (this[i]>>(p-=k))&km;\r\n        if(p <= 0) { p += this.DB; --i; }\r\n      }\r\n      if(d > 0) m = true;\r\n      if(m) r += int2char(d);\r\n    }\r\n  }\r\n  return m?r:\"0\";\r\n}\r\n\r\n// (public) -this\r\nfunction bnNegate() { var r = nbi(); BigInteger.ZERO.subTo(this,r); return r; }\r\n\r\n// (public) |this|\r\nfunction bnAbs() { return (this.s<0)?this.negate():this; }\r\n\r\n// (public) return + if this > a, - if this < a, 0 if equal\r\nfunction bnCompareTo(a) {\r\n  var r = this.s-a.s;\r\n  if(r != 0) return r;\r\n  var i = this.t;\r\n  r = i-a.t;\r\n  if(r != 0) return (this.s<0)?-r:r;\r\n  while(--i >= 0) if((r=this[i]-a[i]) != 0) return r;\r\n  return 0;\r\n}\r\n\r\n// returns bit length of the integer x\r\nexport function nbits(x) {\r\n  var r = 1, t;\r\n  if((t=x>>>16) != 0) { x = t; r += 16; }\r\n  if((t=x>>8) != 0) { x = t; r += 8; }\r\n  if((t=x>>4) != 0) { x = t; r += 4; }\r\n  if((t=x>>2) != 0) { x = t; r += 2; }\r\n  if((t=x>>1) != 0) { x = t; r += 1; }\r\n  return r;\r\n}\r\n\r\n// (public) return the number of bits in \"this\"\r\nfunction bnBitLength() {\r\n  if(this.t <= 0) return 0;\r\n  return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM));\r\n}\r\n\r\n// (protected) r = this << n*DB\r\nfunction bnpDLShiftTo(n,r) {\r\n  var i;\r\n  for(i = this.t-1; i >= 0; --i) r[i+n] = this[i];\r\n  for(i = n-1; i >= 0; --i) r[i] = 0;\r\n  r.t = this.t+n;\r\n  r.s = this.s;\r\n}\r\n\r\n// (protected) r = this >> n*DB\r\nfunction bnpDRShiftTo(n,r) {\r\n  for(var i = n; i < this.t; ++i) r[i-n] = this[i];\r\n  r.t = Math.max(this.t-n,0);\r\n  r.s = this.s;\r\n}\r\n\r\n// (protected) r = this << n\r\nfunction bnpLShiftTo(n,r) {\r\n  var bs = n%this.DB;\r\n  var cbs = this.DB-bs;\r\n  var bm = (1<<cbs)-1;\r\n  var ds = Math.floor(n/this.DB), c = (this.s<<bs)&this.DM, i;\r\n  for(i = this.t-1; i >= 0; --i) {\r\n    r[i+ds+1] = (this[i]>>cbs)|c;\r\n    c = (this[i]&bm)<<bs;\r\n  }\r\n  for(i = ds-1; i >= 0; --i) r[i] = 0;\r\n  r[ds] = c;\r\n  r.t = this.t+ds+1;\r\n  r.s = this.s;\r\n  r.clamp();\r\n}\r\n\r\n// (protected) r = this >> n\r\nfunction bnpRShiftTo(n,r) {\r\n  r.s = this.s;\r\n  var ds = Math.floor(n/this.DB);\r\n  if(ds >= this.t) { r.t = 0; return; }\r\n  var bs = n%this.DB;\r\n  var cbs = this.DB-bs;\r\n  var bm = (1<<bs)-1;\r\n  r[0] = this[ds]>>bs;\r\n  for(var i = ds+1; i < this.t; ++i) {\r\n    r[i-ds-1] |= (this[i]&bm)<<cbs;\r\n    r[i-ds] = this[i]>>bs;\r\n  }\r\n  if(bs > 0) r[this.t-ds-1] |= (this.s&bm)<<cbs;\r\n  r.t = this.t-ds;\r\n  r.clamp();\r\n}\r\n\r\n// (protected) r = this - a\r\nfunction bnpSubTo(a,r) {\r\n  var i = 0, c = 0, m = Math.min(a.t,this.t);\r\n  while(i < m) {\r\n    c += this[i]-a[i];\r\n    r[i++] = c&this.DM;\r\n    c >>= this.DB;\r\n  }\r\n  if(a.t < this.t) {\r\n    c -= a.s;\r\n    while(i < this.t) {\r\n      c += this[i];\r\n      r[i++] = c&this.DM;\r\n      c >>= this.DB;\r\n    }\r\n    c += this.s;\r\n  }\r\n  else {\r\n    c += this.s;\r\n    while(i < a.t) {\r\n      c -= a[i];\r\n      r[i++] = c&this.DM;\r\n      c >>= this.DB;\r\n    }\r\n    c -= a.s;\r\n  }\r\n  r.s = (c<0)?-1:0;\r\n  if(c < -1) r[i++] = this.DV+c;\r\n  else if(c > 0) r[i++] = c;\r\n  r.t = i;\r\n  r.clamp();\r\n}\r\n\r\n// (protected) r = this * a, r != this,a (HAC 14.12)\r\n// \"this\" should be the larger one if appropriate.\r\nfunction bnpMultiplyTo(a,r) {\r\n  var x = this.abs(), y = a.abs();\r\n  var i = x.t;\r\n  r.t = i+y.t;\r\n  while(--i >= 0) r[i] = 0;\r\n  for(i = 0; i < y.t; ++i) r[i+x.t] = x.am(0,y[i],r,i,0,x.t);\r\n  r.s = 0;\r\n  r.clamp();\r\n  if(this.s != a.s) BigInteger.ZERO.subTo(r,r);\r\n}\r\n\r\n// (protected) r = this^2, r != this (HAC 14.16)\r\nfunction bnpSquareTo(r) {\r\n  var x = this.abs();\r\n  var i = r.t = 2*x.t;\r\n  while(--i >= 0) r[i] = 0;\r\n  for(i = 0; i < x.t-1; ++i) {\r\n    var c = x.am(i,x[i],r,2*i,0,1);\r\n    if((r[i+x.t]+=x.am(i+1,2*x[i],r,2*i+1,c,x.t-i-1)) >= x.DV) {\r\n      r[i+x.t] -= x.DV;\r\n      r[i+x.t+1] = 1;\r\n    }\r\n  }\r\n  if(r.t > 0) r[r.t-1] += x.am(i,x[i],r,2*i,0,1);\r\n  r.s = 0;\r\n  r.clamp();\r\n}\r\n\r\n// (protected) divide this by m, quotient and remainder to q, r (HAC 14.20)\r\n// r != q, this != m.  q or r may be null.\r\nfunction bnpDivRemTo(m,q,r) {\r\n  var pm = m.abs();\r\n  if(pm.t <= 0) return;\r\n  var pt = this.abs();\r\n  if(pt.t < pm.t) {\r\n    if(q != null) q.fromInt(0);\r\n    if(r != null) this.copyTo(r);\r\n    return;\r\n  }\r\n  if(r == null) r = nbi();\r\n  var y = nbi(), ts = this.s, ms = m.s;\r\n  var nsh = this.DB-nbits(pm[pm.t-1]);\t// normalize modulus\r\n  if(nsh > 0) { pm.lShiftTo(nsh,y); pt.lShiftTo(nsh,r); }\r\n  else { pm.copyTo(y); pt.copyTo(r); }\r\n  var ys = y.t;\r\n  var y0 = y[ys-1];\r\n  if(y0 == 0) return;\r\n  var yt = y0*(1<<this.F1)+((ys>1)?y[ys-2]>>this.F2:0);\r\n  var d1 = this.FV/yt, d2 = (1<<this.F1)/yt, e = 1<<this.F2;\r\n  var i = r.t, j = i-ys, t = (q==null)?nbi():q;\r\n  y.dlShiftTo(j,t);\r\n  if(r.compareTo(t) >= 0) {\r\n    r[r.t++] = 1;\r\n    r.subTo(t,r);\r\n  }\r\n  BigInteger.ONE.dlShiftTo(ys,t);\r\n  t.subTo(y,y);\t// \"negative\" y so we can replace sub with am later\r\n  while(y.t < ys) y[y.t++] = 0;\r\n  while(--j >= 0) {\r\n    // Estimate quotient digit\r\n    var qd = (r[--i]==y0)?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2);\r\n    if((r[i]+=y.am(0,qd,r,j,0,ys)) < qd) {\t// Try it out\r\n      y.dlShiftTo(j,t);\r\n      r.subTo(t,r);\r\n      while(r[i] < --qd) r.subTo(t,r);\r\n    }\r\n  }\r\n  if(q != null) {\r\n    r.drShiftTo(ys,q);\r\n    if(ts != ms) BigInteger.ZERO.subTo(q,q);\r\n  }\r\n  r.t = ys;\r\n  r.clamp();\r\n  if(nsh > 0) r.rShiftTo(nsh,r);\t// Denormalize remainder\r\n  if(ts < 0) BigInteger.ZERO.subTo(r,r);\r\n}\r\n\r\n// (public) this mod a\r\nfunction bnMod(a) {\r\n  var r = nbi();\r\n  this.abs().divRemTo(a,null,r);\r\n  if(this.s < 0 && r.compareTo(BigInteger.ZERO) > 0) a.subTo(r,r);\r\n  return r;\r\n}\r\n\r\n// Modular reduction using \"classic\" algorithm\r\nexport class Classic{\r\n  constructor(m){\r\n    this.m = m;\r\n  }\r\n}\r\nfunction cConvert(x) {\r\n  if(x.s < 0 || x.compareTo(this.m) >= 0) return x.mod(this.m);\r\n  else return x;\r\n}\r\nfunction cRevert(x) { return x; }\r\nfunction cReduce(x) { x.divRemTo(this.m,null,x); }\r\nfunction cMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); }\r\nfunction cSqrTo(x,r) { x.squareTo(r); this.reduce(r); }\r\n\r\nClassic.prototype.convert = cConvert;\r\nClassic.prototype.revert = cRevert;\r\nClassic.prototype.reduce = cReduce;\r\nClassic.prototype.mulTo = cMulTo;\r\nClassic.prototype.sqrTo = cSqrTo;\r\n\r\n// (protected) return \"-1/this % 2^DB\"; useful for Mont. reduction\r\n// justification:\r\n//         xy == 1 (mod m)\r\n//         xy =  1+km\r\n//   xy(2-xy) = (1+km)(1-km)\r\n// x[y(2-xy)] = 1-k^2m^2\r\n// x[y(2-xy)] == 1 (mod m^2)\r\n// if y is 1/x mod m, then y(2-xy) is 1/x mod m^2\r\n// should reduce x and y(2-xy) by m^2 at each step to keep size bounded.\r\n// JS multiply \"overflows\" differently from C/C++, so care is needed here.\r\nfunction bnpInvDigit() {\r\n  if(this.t < 1) return 0;\r\n  var x = this[0];\r\n  if((x&1) == 0) return 0;\r\n  var y = x&3;\t\t// y == 1/x mod 2^2\r\n  y = (y*(2-(x&0xf)*y))&0xf;\t// y == 1/x mod 2^4\r\n  y = (y*(2-(x&0xff)*y))&0xff;\t// y == 1/x mod 2^8\r\n  y = (y*(2-(((x&0xffff)*y)&0xffff)))&0xffff;\t// y == 1/x mod 2^16\r\n  // last step - calculate inverse mod DV directly;\r\n  // assumes 16 < DB <= 32 and assumes ability to handle 48-bit ints\r\n  y = (y*(2-x*y%this.DV))%this.DV;\t\t// y == 1/x mod 2^dbits\r\n  // we really want the negative inverse, and -DV < y < DV\r\n  return (y>0)?this.DV-y:-y;\r\n}\r\n\r\n// Montgomery reduction\r\nexport class Montgomery {\r\n  constructor(m) {\r\n    this.m = m;\r\n    this.mp = m.invDigit();\r\n    this.mpl = this.mp & 0x7fff;\r\n    this.mph = this.mp >> 15;\r\n    this.um = (1 << (m.DB - 15)) - 1;\r\n    this.mt2 = 2 * m.t;\r\n  }\r\n}\r\n\r\n// xR mod m\r\nfunction montConvert(x) {\r\n  var r = nbi();\r\n  x.abs().dlShiftTo(this.m.t,r);\r\n  r.divRemTo(this.m,null,r);\r\n  if(x.s < 0 && r.compareTo(BigInteger.ZERO) > 0) this.m.subTo(r,r);\r\n  return r;\r\n}\r\n\r\n// x/R mod m\r\nfunction montRevert(x) {\r\n  var r = nbi();\r\n  x.copyTo(r);\r\n  this.reduce(r);\r\n  return r;\r\n}\r\n\r\n// x = x/R mod m (HAC 14.32)\r\nfunction montReduce(x) {\r\n  while(x.t <= this.mt2)\t// pad x so am has enough room later\r\n    x[x.t++] = 0;\r\n  for(var i = 0; i < this.m.t; ++i) {\r\n    // faster way of calculating u0 = x[i]*mp mod DV\r\n    var j = x[i]&0x7fff;\r\n    var u0 = (j*this.mpl+(((j*this.mph+(x[i]>>15)*this.mpl)&this.um)<<15))&x.DM;\r\n    // use am to combine the multiply-shift-add into one call\r\n    j = i+this.m.t;\r\n    x[j] += this.m.am(0,u0,x,i,0,this.m.t);\r\n    // propagate carry\r\n    while(x[j] >= x.DV) { x[j] -= x.DV; x[++j]++; }\r\n  }\r\n  x.clamp();\r\n  x.drShiftTo(this.m.t,x);\r\n  if(x.compareTo(this.m) >= 0) x.subTo(this.m,x);\r\n}\r\n\r\n// r = \"x^2/R mod m\"; x != r\r\nfunction montSqrTo(x,r) { x.squareTo(r); this.reduce(r); }\r\n\r\n// r = \"xy/R mod m\"; x,y != r\r\nfunction montMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); }\r\n\r\nMontgomery.prototype.convert = montConvert;\r\nMontgomery.prototype.revert = montRevert;\r\nMontgomery.prototype.reduce = montReduce;\r\nMontgomery.prototype.mulTo = montMulTo;\r\nMontgomery.prototype.sqrTo = montSqrTo;\r\n\r\n// (protected) true iff this is even\r\nfunction bnpIsEven() { return ((this.t>0)?(this[0]&1):this.s) == 0; }\r\n\r\n// (protected) this^e, e < 2^32, doing sqr and mul with \"r\" (HAC 14.79)\r\nfunction bnpExp(e,z) {\r\n  if(e > 0xffffffff || e < 1) return BigInteger.ONE;\r\n  var r = nbi(), r2 = nbi(), g = z.convert(this), i = nbits(e)-1;\r\n  g.copyTo(r);\r\n  while(--i >= 0) {\r\n    z.sqrTo(r,r2);\r\n    if((e&(1<<i)) > 0) z.mulTo(r2,g,r);\r\n    else { var t = r; r = r2; r2 = t; }\r\n  }\r\n  return z.revert(r);\r\n}\r\n\r\n// (public) this^e % m, 0 <= e < 2^32\r\nfunction bnModPowInt(e,m) {\r\n  var z;\r\n  if(e < 256 || m.isEven()) z = new Classic(m); else z = new Montgomery(m);\r\n  return this.exp(e,z);\r\n}\r\n\r\n// protected\r\nBigInteger.prototype.copyTo = bnpCopyTo;\r\nBigInteger.prototype.fromInt = bnpFromInt;\r\nBigInteger.prototype.fromString = bnpFromString;\r\nBigInteger.prototype.clamp = bnpClamp;\r\nBigInteger.prototype.dlShiftTo = bnpDLShiftTo;\r\nBigInteger.prototype.drShiftTo = bnpDRShiftTo;\r\nBigInteger.prototype.lShiftTo = bnpLShiftTo;\r\nBigInteger.prototype.rShiftTo = bnpRShiftTo;\r\nBigInteger.prototype.subTo = bnpSubTo;\r\nBigInteger.prototype.multiplyTo = bnpMultiplyTo;\r\nBigInteger.prototype.squareTo = bnpSquareTo;\r\nBigInteger.prototype.divRemTo = bnpDivRemTo;\r\nBigInteger.prototype.invDigit = bnpInvDigit;\r\nBigInteger.prototype.isEven = bnpIsEven;\r\nBigInteger.prototype.exp = bnpExp;\r\n\r\n// public\r\nBigInteger.prototype.toString = bnToString;\r\nBigInteger.prototype.negate = bnNegate;\r\nBigInteger.prototype.abs = bnAbs;\r\nBigInteger.prototype.compareTo = bnCompareTo;\r\nBigInteger.prototype.bitLength = bnBitLength;\r\nBigInteger.prototype.mod = bnMod;\r\nBigInteger.prototype.modPowInt = bnModPowInt;\r\n\r\n// \"constants\"\r\nBigInteger.ZERO = nbv(0);\r\nBigInteger.ONE = nbv(1);\r\n","// Copyright (c) 2005-2009  Tom Wu\r\n// All Rights Reserved.\r\n// See \"LICENSE\" for details.\r\n\r\n// Extended JavaScript BN functions, required for RSA private ops.\r\n\r\n// Version 1.1: new BigInteger(\"0\", 10) returns \"proper\" zero\r\n// Version 1.2: square() API, isProbablePrime fix\r\n\r\nimport {BigInteger, nbi, nbv, nbits, intAt, Classic, Montgomery} from \"./jsbn\";\r\nexport {BigInteger} from \"./jsbn\";\r\n// (public)\r\nfunction bnClone() { var r = nbi(); this.copyTo(r); return r; }\r\n\r\n// (public) return value as integer\r\nfunction bnIntValue() {\r\n  if(this.s < 0) {\r\n    if(this.t == 1) return this[0]-this.DV;\r\n    else if(this.t == 0) return -1;\r\n  }\r\n  else if(this.t == 1) return this[0];\r\n  else if(this.t == 0) return 0;\r\n  // assumes 16 < DB < 32\r\n  return ((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0];\r\n}\r\n\r\n// (public) return value as byte\r\nfunction bnByteValue() { return (this.t==0)?this.s:(this[0]<<24)>>24; }\r\n\r\n// (public) return value as short (assumes DB>=16)\r\nfunction bnShortValue() { return (this.t==0)?this.s:(this[0]<<16)>>16; }\r\n\r\n// (protected) return x s.t. r^x < DV\r\nfunction bnpChunkSize(r) { return Math.floor(Math.LN2*this.DB/Math.log(r)); }\r\n\r\n// (public) 0 if this == 0, 1 if this > 0\r\nfunction bnSigNum() {\r\n  if(this.s < 0) return -1;\r\n  else if(this.t <= 0 || (this.t == 1 && this[0] <= 0)) return 0;\r\n  else return 1;\r\n}\r\n\r\n// (protected) convert to radix string\r\nfunction bnpToRadix(b) {\r\n  if(b == null) b = 10;\r\n  if(this.signum() == 0 || b < 2 || b > 36) return \"0\";\r\n  var cs = this.chunkSize(b);\r\n  var a = Math.pow(b,cs);\r\n  var d = nbv(a), y = nbi(), z = nbi(), r = \"\";\r\n  this.divRemTo(d,y,z);\r\n  while(y.signum() > 0) {\r\n    r = (a+z.intValue()).toString(b).substr(1) + r;\r\n    y.divRemTo(d,y,z);\r\n  }\r\n  return z.intValue().toString(b) + r;\r\n}\r\n\r\n// (protected) convert from radix string\r\nfunction bnpFromRadix(s,b) {\r\n  this.fromInt(0);\r\n  if(b == null) b = 10;\r\n  var cs = this.chunkSize(b);\r\n  var d = Math.pow(b,cs), mi = false, j = 0, w = 0;\r\n  for(var i = 0; i < s.length; ++i) {\r\n    var x = intAt(s,i);\r\n    if(x < 0) {\r\n      if(s.charAt(i) == \"-\" && this.signum() == 0) mi = true;\r\n      continue;\r\n    }\r\n    w = b*w+x;\r\n    if(++j >= cs) {\r\n      this.dMultiply(d);\r\n      this.dAddOffset(w,0);\r\n      j = 0;\r\n      w = 0;\r\n    }\r\n  }\r\n  if(j > 0) {\r\n    this.dMultiply(Math.pow(b,j));\r\n    this.dAddOffset(w,0);\r\n  }\r\n  if(mi) BigInteger.ZERO.subTo(this,this);\r\n}\r\n\r\n// (protected) alternate constructor\r\nfunction bnpFromNumber(a,b,c) {\r\n  if(\"number\" == typeof b) {\r\n    // new BigInteger(int,int,RNG)\r\n    if(a < 2) this.fromInt(1);\r\n    else {\r\n      this.fromNumber(a,c);\r\n      if(!this.testBit(a-1))\t// force MSB set\r\n        this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this);\r\n      if(this.isEven()) this.dAddOffset(1,0); // force odd\r\n      while(!this.isProbablePrime(b)) {\r\n        this.dAddOffset(2,0);\r\n        if(this.bitLength() > a) this.subTo(BigInteger.ONE.shiftLeft(a-1),this);\r\n      }\r\n    }\r\n  }\r\n  else {\r\n    // new BigInteger(int,RNG)\r\n    var x = [], t = a&7;\r\n    x.length = (a>>3)+1;\r\n    b.nextBytes(x);\r\n    if(t > 0) x[0] &= ((1<<t)-1); else x[0] = 0;\r\n    this.fromString(x,256);\r\n  }\r\n}\r\n\r\n// (public) convert to bigendian byte array\r\nfunction bnToByteArray() {\r\n  var i = this.t, r = [];\r\n  r[0] = this.s;\r\n  var p = this.DB-(i*this.DB)%8, d, k = 0;\r\n  if(i-- > 0) {\r\n    if(p < this.DB && (d = this[i]>>p) != (this.s&this.DM)>>p)\r\n      r[k++] = d|(this.s<<(this.DB-p));\r\n    while(i >= 0) {\r\n      if(p < 8) {\r\n        d = (this[i]&((1<<p)-1))<<(8-p);\r\n        d |= this[--i]>>(p+=this.DB-8);\r\n      }\r\n      else {\r\n        d = (this[i]>>(p-=8))&0xff;\r\n        if(p <= 0) { p += this.DB; --i; }\r\n      }\r\n      if((d&0x80) != 0) d |= -256;\r\n      if(k == 0 && (this.s&0x80) != (d&0x80)) ++k;\r\n      if(k > 0 || d != this.s) r[k++] = d;\r\n    }\r\n  }\r\n  return r;\r\n}\r\n\r\nfunction bnEquals(a) { return(this.compareTo(a)==0); }\r\nfunction bnMin(a) { return(this.compareTo(a)<0)?this:a; }\r\nfunction bnMax(a) { return(this.compareTo(a)>0)?this:a; }\r\n\r\n// (protected) r = this op a (bitwise)\r\nfunction bnpBitwiseTo(a,op,r) {\r\n  var i, f, m = Math.min(a.t,this.t);\r\n  for(i = 0; i < m; ++i) r[i] = op(this[i],a[i]);\r\n  if(a.t < this.t) {\r\n    f = a.s&this.DM;\r\n    for(i = m; i < this.t; ++i) r[i] = op(this[i],f);\r\n    r.t = this.t;\r\n  }\r\n  else {\r\n    f = this.s&this.DM;\r\n    for(i = m; i < a.t; ++i) r[i] = op(f,a[i]);\r\n    r.t = a.t;\r\n  }\r\n  r.s = op(this.s,a.s);\r\n  r.clamp();\r\n}\r\n\r\n// (public) this & a\r\nfunction op_and(x,y) { return x&y; }\r\nfunction bnAnd(a) { var r = nbi(); this.bitwiseTo(a,op_and,r); return r; }\r\n\r\n// (public) this | a\r\nfunction op_or(x,y) { return x|y; }\r\nfunction bnOr(a) { var r = nbi(); this.bitwiseTo(a,op_or,r); return r; }\r\n\r\n// (public) this ^ a\r\nfunction op_xor(x,y) { return x^y; }\r\nfunction bnXor(a) { var r = nbi(); this.bitwiseTo(a,op_xor,r); return r; }\r\n\r\n// (public) this & ~a\r\nfunction op_andnot(x,y) { return x&~y; }\r\nfunction bnAndNot(a) { var r = nbi(); this.bitwiseTo(a,op_andnot,r); return r; }\r\n\r\n// (public) ~this\r\nfunction bnNot() {\r\n  var r = nbi();\r\n  for(var i = 0; i < this.t; ++i) r[i] = this.DM&~this[i];\r\n  r.t = this.t;\r\n  r.s = ~this.s;\r\n  return r;\r\n}\r\n\r\n// (public) this << n\r\nfunction bnShiftLeft(n) {\r\n  var r = nbi();\r\n  if(n < 0) this.rShiftTo(-n,r); else this.lShiftTo(n,r);\r\n  return r;\r\n}\r\n\r\n// (public) this >> n\r\nfunction bnShiftRight(n) {\r\n  var r = nbi();\r\n  if(n < 0) this.lShiftTo(-n,r); else this.rShiftTo(n,r);\r\n  return r;\r\n}\r\n\r\n// return index of lowest 1-bit in x, x < 2^31\r\nfunction lbit(x) {\r\n  if(x == 0) return -1;\r\n  var r = 0;\r\n  if((x&0xffff) == 0) { x >>= 16; r += 16; }\r\n  if((x&0xff) == 0) { x >>= 8; r += 8; }\r\n  if((x&0xf) == 0) { x >>= 4; r += 4; }\r\n  if((x&3) == 0) { x >>= 2; r += 2; }\r\n  if((x&1) == 0) ++r;\r\n  return r;\r\n}\r\n\r\n// (public) returns index of lowest 1-bit (or -1 if none)\r\nfunction bnGetLowestSetBit() {\r\n  for(var i = 0; i < this.t; ++i)\r\n    if(this[i] != 0) return i*this.DB+lbit(this[i]);\r\n  if(this.s < 0) return this.t*this.DB;\r\n  return -1;\r\n}\r\n\r\n// return number of 1 bits in x\r\nfunction cbit(x) {\r\n  var r = 0;\r\n  while(x != 0) { x &= x-1; ++r; }\r\n  return r;\r\n}\r\n\r\n// (public) return number of set bits\r\nfunction bnBitCount() {\r\n  var r = 0, x = this.s&this.DM;\r\n  for(var i = 0; i < this.t; ++i) r += cbit(this[i]^x);\r\n  return r;\r\n}\r\n\r\n// (public) true iff nth bit is set\r\nfunction bnTestBit(n) {\r\n  var j = Math.floor(n/this.DB);\r\n  if(j >= this.t) return(this.s!=0);\r\n  return((this[j]&(1<<(n%this.DB)))!=0);\r\n}\r\n\r\n// (protected) this op (1<<n)\r\nfunction bnpChangeBit(n,op) {\r\n  var r = BigInteger.ONE.shiftLeft(n);\r\n  this.bitwiseTo(r,op,r);\r\n  return r;\r\n}\r\n\r\n// (public) this | (1<<n)\r\nfunction bnSetBit(n) { return this.changeBit(n,op_or); }\r\n\r\n// (public) this & ~(1<<n)\r\nfunction bnClearBit(n) { return this.changeBit(n,op_andnot); }\r\n\r\n// (public) this ^ (1<<n)\r\nfunction bnFlipBit(n) { return this.changeBit(n,op_xor); }\r\n\r\n// (protected) r = this + a\r\nfunction bnpAddTo(a,r) {\r\n  var i = 0, c = 0, m = Math.min(a.t,this.t);\r\n  while(i < m) {\r\n    c += this[i]+a[i];\r\n    r[i++] = c&this.DM;\r\n    c >>= this.DB;\r\n  }\r\n  if(a.t < this.t) {\r\n    c += a.s;\r\n    while(i < this.t) {\r\n      c += this[i];\r\n      r[i++] = c&this.DM;\r\n      c >>= this.DB;\r\n    }\r\n    c += this.s;\r\n  }\r\n  else {\r\n    c += this.s;\r\n    while(i < a.t) {\r\n      c += a[i];\r\n      r[i++] = c&this.DM;\r\n      c >>= this.DB;\r\n    }\r\n    c += a.s;\r\n  }\r\n  r.s = (c<0)?-1:0;\r\n  if(c > 0) r[i++] = c;\r\n  else if(c < -1) r[i++] = this.DV+c;\r\n  r.t = i;\r\n  r.clamp();\r\n}\r\n\r\n// (public) this + a\r\nfunction bnAdd(a) { var r = nbi(); this.addTo(a,r); return r; }\r\n\r\n// (public) this - a\r\nfunction bnSubtract(a) { var r = nbi(); this.subTo(a,r); return r; }\r\n\r\n// (public) this * a\r\nfunction bnMultiply(a) { var r = nbi(); this.multiplyTo(a,r); return r; }\r\n\r\n// (public) this^2\r\nfunction bnSquare() { var r = nbi(); this.squareTo(r); return r; }\r\n\r\n// (public) this / a\r\nfunction bnDivide(a) { var r = nbi(); this.divRemTo(a,r,null); return r; }\r\n\r\n// (public) this % a\r\nfunction bnRemainder(a) { var r = nbi(); this.divRemTo(a,null,r); return r; }\r\n\r\n// (public) [this/a,this%a]\r\nfunction bnDivideAndRemainder(a) {\r\n  var q = nbi(), r = nbi();\r\n  this.divRemTo(a,q,r);\r\n  return new Array(q,r);\r\n}\r\n\r\n// (protected) this *= n, this >= 0, 1 < n < DV\r\nfunction bnpDMultiply(n) {\r\n  this[this.t] = this.am(0,n-1,this,0,0,this.t);\r\n  ++this.t;\r\n  this.clamp();\r\n}\r\n\r\n// (protected) this += n << w words, this >= 0\r\nfunction bnpDAddOffset(n,w) {\r\n  if(n == 0) return;\r\n  while(this.t <= w) this[this.t++] = 0;\r\n  this[w] += n;\r\n  while(this[w] >= this.DV) {\r\n    this[w] -= this.DV;\r\n    if(++w >= this.t) this[this.t++] = 0;\r\n    ++this[w];\r\n  }\r\n}\r\n\r\n// A \"null\" reducer\r\nfunction NullExp() {}\r\nfunction nNop(x) { return x; }\r\nfunction nMulTo(x,y,r) { x.multiplyTo(y,r); }\r\nfunction nSqrTo(x,r) { x.squareTo(r); }\r\n\r\nNullExp.prototype.convert = nNop;\r\nNullExp.prototype.revert = nNop;\r\nNullExp.prototype.mulTo = nMulTo;\r\nNullExp.prototype.sqrTo = nSqrTo;\r\n\r\n// (public) this^e\r\nfunction bnPow(e) { return this.exp(e,new NullExp()); }\r\n\r\n// (protected) r = lower n words of \"this * a\", a.t <= n\r\n// \"this\" should be the larger one if appropriate.\r\nfunction bnpMultiplyLowerTo(a,n,r) {\r\n  var i = Math.min(this.t+a.t,n);\r\n  r.s = 0; // assumes a,this >= 0\r\n  r.t = i;\r\n  while(i > 0) r[--i] = 0;\r\n  var j;\r\n  for(j = r.t-this.t; i < j; ++i) r[i+this.t] = this.am(0,a[i],r,i,0,this.t);\r\n  for(j = Math.min(a.t,n); i < j; ++i) this.am(0,a[i],r,i,0,n-i);\r\n  r.clamp();\r\n}\r\n\r\n// (protected) r = \"this * a\" without lower n words, n > 0\r\n// \"this\" should be the larger one if appropriate.\r\nfunction bnpMultiplyUpperTo(a,n,r) {\r\n  --n;\r\n  var i = r.t = this.t+a.t-n;\r\n  r.s = 0; // assumes a,this >= 0\r\n  while(--i >= 0) r[i] = 0;\r\n  for(i = Math.max(n-this.t,0); i < a.t; ++i)\r\n    r[this.t+i-n] = this.am(n-i,a[i],r,0,0,this.t+i-n);\r\n  r.clamp();\r\n  r.drShiftTo(1,r);\r\n}\r\n\r\n// Barrett modular reduction\r\nfunction Barrett(m) {\r\n  // setup Barrett\r\n  this.r2 = nbi();\r\n  this.q3 = nbi();\r\n  BigInteger.ONE.dlShiftTo(2*m.t,this.r2);\r\n  this.mu = this.r2.divide(m);\r\n  this.m = m;\r\n}\r\n\r\nfunction barrettConvert(x) {\r\n  if(x.s < 0 || x.t > 2*this.m.t) return x.mod(this.m);\r\n  else if(x.compareTo(this.m) < 0) return x;\r\n  else { var r = nbi(); x.copyTo(r); this.reduce(r); return r; }\r\n}\r\n\r\nfunction barrettRevert(x) { return x; }\r\n\r\n// x = x mod m (HAC 14.42)\r\nfunction barrettReduce(x) {\r\n  x.drShiftTo(this.m.t-1,this.r2);\r\n  if(x.t > this.m.t+1) { x.t = this.m.t+1; x.clamp(); }\r\n  this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);\r\n  this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);\r\n  while(x.compareTo(this.r2) < 0) x.dAddOffset(1,this.m.t+1);\r\n  x.subTo(this.r2,x);\r\n  while(x.compareTo(this.m) >= 0) x.subTo(this.m,x);\r\n}\r\n\r\n// r = x^2 mod m; x != r\r\nfunction barrettSqrTo(x,r) { x.squareTo(r); this.reduce(r); }\r\n\r\n// r = x*y mod m; x,y != r\r\nfunction barrettMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); }\r\n\r\nBarrett.prototype.convert = barrettConvert;\r\nBarrett.prototype.revert = barrettRevert;\r\nBarrett.prototype.reduce = barrettReduce;\r\nBarrett.prototype.mulTo = barrettMulTo;\r\nBarrett.prototype.sqrTo = barrettSqrTo;\r\n\r\n// (public) this^e % m (HAC 14.85)\r\nfunction bnModPow(e,m) {\r\n  var i = e.bitLength(), k, r = nbv(1), z;\r\n  if(i <= 0) return r;\r\n  else if(i < 18) k = 1;\r\n  else if(i < 48) k = 3;\r\n  else if(i < 144) k = 4;\r\n  else if(i < 768) k = 5;\r\n  else k = 6;\r\n  if(i < 8)\r\n    z = new Classic(m);\r\n  else if(m.isEven())\r\n    z = new Barrett(m);\r\n  else\r\n    z = new Montgomery(m);\r\n\r\n  // precomputation\r\n  var g = [], n = 3, k1 = k-1, km = (1<<k)-1;\r\n  g[1] = z.convert(this);\r\n  if(k > 1) {\r\n    var g2 = nbi();\r\n    z.sqrTo(g[1],g2);\r\n    while(n <= km) {\r\n      g[n] = nbi();\r\n      z.mulTo(g2,g[n-2],g[n]);\r\n      n += 2;\r\n    }\r\n  }\r\n\r\n  var j = e.t-1, w, is1 = true, r2 = nbi(), t;\r\n  i = nbits(e[j])-1;\r\n  while(j >= 0) {\r\n    if(i >= k1) w = (e[j]>>(i-k1))&km;\r\n    else {\r\n      w = (e[j]&((1<<(i+1))-1))<<(k1-i);\r\n      if(j > 0) w |= e[j-1]>>(this.DB+i-k1);\r\n    }\r\n\r\n    n = k;\r\n    while((w&1) == 0) { w >>= 1; --n; }\r\n    if((i -= n) < 0) { i += this.DB; --j; }\r\n    if(is1) {\t// ret == 1, don't bother squaring or multiplying it\r\n      g[w].copyTo(r);\r\n      is1 = false;\r\n    }\r\n    else {\r\n      while(n > 1) { z.sqrTo(r,r2); z.sqrTo(r2,r); n -= 2; }\r\n      if(n > 0) z.sqrTo(r,r2); else { t = r; r = r2; r2 = t; }\r\n      z.mulTo(r2,g[w],r);\r\n    }\r\n\r\n    while(j >= 0 && (e[j]&(1<<i)) == 0) {\r\n      z.sqrTo(r,r2); t = r; r = r2; r2 = t;\r\n      if(--i < 0) { i = this.DB-1; --j; }\r\n    }\r\n  }\r\n  return z.revert(r);\r\n}\r\n\r\n// (public) gcd(this,a) (HAC 14.54)\r\nfunction bnGCD(a) {\r\n  var x = (this.s<0)?this.negate():this.clone();\r\n  var y = (a.s<0)?a.negate():a.clone();\r\n  if(x.compareTo(y) < 0) { var t = x; x = y; y = t; }\r\n  var i = x.getLowestSetBit(), g = y.getLowestSetBit();\r\n  if(g < 0) return x;\r\n  if(i < g) g = i;\r\n  if(g > 0) {\r\n    x.rShiftTo(g,x);\r\n    y.rShiftTo(g,y);\r\n  }\r\n  while(x.signum() > 0) {\r\n    if((i = x.getLowestSetBit()) > 0) x.rShiftTo(i,x);\r\n    if((i = y.getLowestSetBit()) > 0) y.rShiftTo(i,y);\r\n    if(x.compareTo(y) >= 0) {\r\n      x.subTo(y,x);\r\n      x.rShiftTo(1,x);\r\n    }\r\n    else {\r\n      y.subTo(x,y);\r\n      y.rShiftTo(1,y);\r\n    }\r\n  }\r\n  if(g > 0) y.lShiftTo(g,y);\r\n  return y;\r\n}\r\n\r\n// (protected) this % n, n < 2^26\r\nfunction bnpModInt(n) {\r\n  if(n <= 0) return 0;\r\n  var d = this.DV%n, r = (this.s<0)?n-1:0;\r\n  if(this.t > 0)\r\n    if(d == 0) r = this[0]%n;\r\n    else for(var i = this.t-1; i >= 0; --i) r = (d*r+this[i])%n;\r\n  return r;\r\n}\r\n\r\n// (public) 1/this % m (HAC 14.61)\r\nfunction bnModInverse(m) {\r\n  var ac = m.isEven();\r\n  if((this.isEven() && ac) || m.signum() == 0) return BigInteger.ZERO;\r\n  var u = m.clone(), v = this.clone();\r\n  var a = nbv(1), b = nbv(0), c = nbv(0), d = nbv(1);\r\n  while(u.signum() != 0) {\r\n    while(u.isEven()) {\r\n      u.rShiftTo(1,u);\r\n      if(ac) {\r\n        if(!a.isEven() || !b.isEven()) { a.addTo(this,a); b.subTo(m,b); }\r\n        a.rShiftTo(1,a);\r\n      }\r\n      else if(!b.isEven()) b.subTo(m,b);\r\n      b.rShiftTo(1,b);\r\n    }\r\n    while(v.isEven()) {\r\n      v.rShiftTo(1,v);\r\n      if(ac) {\r\n        if(!c.isEven() || !d.isEven()) { c.addTo(this,c); d.subTo(m,d); }\r\n        c.rShiftTo(1,c);\r\n      }\r\n      else if(!d.isEven()) d.subTo(m,d);\r\n      d.rShiftTo(1,d);\r\n    }\r\n    if(u.compareTo(v) >= 0) {\r\n      u.subTo(v,u);\r\n      if(ac) a.subTo(c,a);\r\n      b.subTo(d,b);\r\n    }\r\n    else {\r\n      v.subTo(u,v);\r\n      if(ac) c.subTo(a,c);\r\n      d.subTo(b,d);\r\n    }\r\n  }\r\n  if(v.compareTo(BigInteger.ONE) != 0) return BigInteger.ZERO;\r\n  if(d.compareTo(m) >= 0) return d.subtract(m);\r\n  if(d.signum() < 0) d.addTo(m,d); else return d;\r\n  if(d.signum() < 0) return d.add(m); else return d;\r\n}\r\n\r\nvar lowprimes = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];\r\nvar lplim = (1<<26)/lowprimes[lowprimes.length-1];\r\n\r\n// (public) test primality with certainty >= 1-.5^t\r\nfunction bnIsProbablePrime(t) {\r\n  var i, x = this.abs();\r\n  if(x.t == 1 && x[0] <= lowprimes[lowprimes.length-1]) {\r\n    for(i = 0; i < lowprimes.length; ++i)\r\n      if(x[0] == lowprimes[i]) return true;\r\n    return false;\r\n  }\r\n  if(x.isEven()) return false;\r\n  i = 1;\r\n  while(i < lowprimes.length) {\r\n    var m = lowprimes[i], j = i+1;\r\n    while(j < lowprimes.length && m < lplim) m *= lowprimes[j++];\r\n    m = x.modInt(m);\r\n    while(i < j) if(m%lowprimes[i++] == 0) return false;\r\n  }\r\n  return x.millerRabin(t);\r\n}\r\n\r\n// (protected) true if probably prime (HAC 4.24, Miller-Rabin)\r\nfunction bnpMillerRabin(t) {\r\n  var n1 = this.subtract(BigInteger.ONE);\r\n  var k = n1.getLowestSetBit();\r\n  if(k <= 0) return false;\r\n  var r = n1.shiftRight(k);\r\n  t = (t+1)>>1;\r\n  if(t > lowprimes.length) t = lowprimes.length;\r\n  var a = nbi();\r\n  for(var i = 0; i < t; ++i) {\r\n    //Pick bases at random, instead of starting at 2\r\n    a.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);\r\n    var y = a.modPow(r,this);\r\n    if(y.compareTo(BigInteger.ONE) != 0 && y.compareTo(n1) != 0) {\r\n      var j = 1;\r\n      while(j++ < k && y.compareTo(n1) != 0) {\r\n        y = y.modPowInt(2,this);\r\n        if(y.compareTo(BigInteger.ONE) == 0) return false;\r\n      }\r\n      if(y.compareTo(n1) != 0) return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n// protected\r\nBigInteger.prototype.chunkSize = bnpChunkSize;\r\nBigInteger.prototype.toRadix = bnpToRadix;\r\nBigInteger.prototype.fromRadix = bnpFromRadix;\r\nBigInteger.prototype.fromNumber = bnpFromNumber;\r\nBigInteger.prototype.bitwiseTo = bnpBitwiseTo;\r\nBigInteger.prototype.changeBit = bnpChangeBit;\r\nBigInteger.prototype.addTo = bnpAddTo;\r\nBigInteger.prototype.dMultiply = bnpDMultiply;\r\nBigInteger.prototype.dAddOffset = bnpDAddOffset;\r\nBigInteger.prototype.multiplyLowerTo = bnpMultiplyLowerTo;\r\nBigInteger.prototype.multiplyUpperTo = bnpMultiplyUpperTo;\r\nBigInteger.prototype.modInt = bnpModInt;\r\nBigInteger.prototype.millerRabin = bnpMillerRabin;\r\n\r\n// public\r\nBigInteger.prototype.clone = bnClone;\r\nBigInteger.prototype.intValue = bnIntValue;\r\nBigInteger.prototype.byteValue = bnByteValue;\r\nBigInteger.prototype.shortValue = bnShortValue;\r\nBigInteger.prototype.signum = bnSigNum;\r\nBigInteger.prototype.toByteArray = bnToByteArray;\r\nBigInteger.prototype.equals = bnEquals;\r\nBigInteger.prototype.min = bnMin;\r\nBigInteger.prototype.max = bnMax;\r\nBigInteger.prototype.and = bnAnd;\r\nBigInteger.prototype.or = bnOr;\r\nBigInteger.prototype.xor = bnXor;\r\nBigInteger.prototype.andNot = bnAndNot;\r\nBigInteger.prototype.not = bnNot;\r\nBigInteger.prototype.shiftLeft = bnShiftLeft;\r\nBigInteger.prototype.shiftRight = bnShiftRight;\r\nBigInteger.prototype.getLowestSetBit = bnGetLowestSetBit;\r\nBigInteger.prototype.bitCount = bnBitCount;\r\nBigInteger.prototype.testBit = bnTestBit;\r\nBigInteger.prototype.setBit = bnSetBit;\r\nBigInteger.prototype.clearBit = bnClearBit;\r\nBigInteger.prototype.flipBit = bnFlipBit;\r\nBigInteger.prototype.add = bnAdd;\r\nBigInteger.prototype.subtract = bnSubtract;\r\nBigInteger.prototype.multiply = bnMultiply;\r\nBigInteger.prototype.divide = bnDivide;\r\nBigInteger.prototype.remainder = bnRemainder;\r\nBigInteger.prototype.divideAndRemainder = bnDivideAndRemainder;\r\nBigInteger.prototype.modPow = bnModPow;\r\nBigInteger.prototype.modInverse = bnModInverse;\r\nBigInteger.prototype.pow = bnPow;\r\nBigInteger.prototype.gcd = bnGCD;\r\nBigInteger.prototype.isProbablePrime = bnIsProbablePrime;\r\n\r\n// JSBN-specific extension\r\nBigInteger.prototype.square = bnSquare;\r\n\r\n// BigInteger interfaces not implemented in jsbn:\r\n\r\n// BigInteger(int signum, byte[] magnitude)\r\n// double doubleValue()\r\n// float floatValue()\r\n// int hashCode()\r\n// long longValue()\r\n// static BigInteger valueOf(long val)\r\n","// Version 1.1: support utf-8 encoding in pkcs1pad2\r\n\r\n// convert a (hex) string to a bignum object\r\n\r\nimport {BigInteger} from \"./jsbn2\";\r\nimport {SecureRandom} from \"./rng\";\r\n\r\nexport function parseBigInt(str,r) {\r\n  return new BigInteger(str,r);\r\n}\r\n\r\nfunction linebrk(s,n) {\r\n  var ret = \"\";\r\n  var i = 0;\r\n  while(i + n < s.length) {\r\n    ret += s.substring(i,i+n) + \"\\n\";\r\n    i += n;\r\n  }\r\n  return ret + s.substring(i,s.length);\r\n}\r\n\r\nfunction byte2Hex(b) {\r\n  if(b < 0x10)\r\n    return \"0\" + b.toString(16);\r\n  else\r\n    return b.toString(16);\r\n}\r\n\r\n// PKCS#1 (type 2, random) pad input string s to n bytes, and return a bigint\r\nfunction pkcs1pad2(s,n) {\r\n  if(n < s.length + 11) { // TODO: fix for utf-8\r\n    console.error(\"Message too long for RSA\");\r\n    return null;\r\n  }\r\n  var ba = [];\r\n  var i = s.length - 1;\r\n  while(i >= 0 && n > 0) {\r\n    var c = s.charCodeAt(i--);\r\n    if(c < 128) { // encode using utf-8\r\n      ba[--n] = c;\r\n    }\r\n    else if((c > 127) && (c < 2048)) {\r\n      ba[--n] = (c & 63) | 128;\r\n      ba[--n] = (c >> 6) | 192;\r\n    }\r\n    else {\r\n      ba[--n] = (c & 63) | 128;\r\n      ba[--n] = ((c >> 6) & 63) | 128;\r\n      ba[--n] = (c >> 12) | 224;\r\n    }\r\n  }\r\n  ba[--n] = 0;\r\n  var rng = new SecureRandom();\r\n  var x = [];\r\n  while(n > 2) { // random non-zero pad\r\n    x[0] = 0;\r\n    while(x[0] == 0) rng.nextBytes(x);\r\n    ba[--n] = x[0];\r\n  }\r\n  ba[--n] = 2;\r\n  ba[--n] = 0;\r\n  return new BigInteger(ba);\r\n}\r\n\r\n// \"empty\" RSA key constructor\r\nexport class RSAKey {\r\n  constructor() {\r\n    this.n = null;\r\n    this.e = 0;\r\n    this.d = null;\r\n    this.p = null;\r\n    this.q = null;\r\n    this.dmp1 = null;\r\n    this.dmq1 = null;\r\n    this.coeff = null;\r\n  }\r\n}\r\n\r\n// Set the public key fields N and e from hex strings\r\nfunction RSASetPublic(N,E) {\r\n  if(N != null && E != null && N.length > 0 && E.length > 0) {\r\n    this.n = parseBigInt(N,16);\r\n    this.e = parseInt(E,16);\r\n  }\r\n  else\r\n    console.error(\"Invalid RSA public key\");\r\n}\r\n\r\n// Perform raw public operation on \"x\": return x^e (mod n)\r\nfunction RSADoPublic(x) {\r\n  return x.modPowInt(this.e, this.n);\r\n}\r\n\r\n// Return the PKCS#1 RSA encryption of \"text\" as an even-length hex string\r\nfunction RSAEncrypt(text) {\r\n  var m = pkcs1pad2(text,(this.n.bitLength()+7)>>3);\r\n  if(m == null) return null;\r\n  var c = this.doPublic(m);\r\n  if(c == null) return null;\r\n  var h = c.toString(16);\r\n  if((h.length & 1) == 0) return h; else return \"0\" + h;\r\n}\r\n\r\n// Return the PKCS#1 RSA encryption of \"text\" as a Base64-encoded string\r\n//function RSAEncryptB64(text) {\r\n//  var h = this.encrypt(text);\r\n//  if(h) return hex2b64(h); else return null;\r\n//}\r\n\r\n// protected\r\nRSAKey.prototype.doPublic = RSADoPublic;\r\n\r\n// public\r\nRSAKey.prototype.setPublic = RSASetPublic;\r\nRSAKey.prototype.encrypt = RSAEncrypt;\r\n//RSAKey.prototype.encrypt_b64 = RSAEncryptB64;\r\n","// Version 1.1: support utf-8 decoding in pkcs1unpad2\r\n\r\n// Undo PKCS#1 (type 2, random) padding and, if valid, return the plaintext\r\n\r\nimport {SecureRandom} from \"./rng\";\r\nimport {BigInteger} from \"./jsbn\";\r\nimport {parseBigInt} from \"./rsa\";\r\nimport {RSAKey} from \"./rsa\";\r\nexport {RSAKey} from \"./rsa\";\r\n\r\nfunction pkcs1unpad2(d,n) {\r\n  var b = d.toByteArray();\r\n  var i = 0;\r\n  while(i < b.length && b[i] == 0) ++i;\r\n  if(b.length-i != n-1 || b[i] != 2)\r\n    return null;\r\n  ++i;\r\n  while(b[i] != 0)\r\n    if(++i >= b.length) return null;\r\n  var ret = \"\";\r\n  while(++i < b.length) {\r\n    var c = b[i] & 255;\r\n    if(c < 128) { // utf-8 decode\r\n      ret += String.fromCharCode(c);\r\n    }\r\n    else if((c > 191) && (c < 224)) {\r\n      ret += String.fromCharCode(((c & 31) << 6) | (b[i+1] & 63));\r\n      ++i;\r\n    }\r\n    else {\r\n      ret += String.fromCharCode(((c & 15) << 12) | ((b[i+1] & 63) << 6) | (b[i+2] & 63));\r\n      i += 2;\r\n    }\r\n  }\r\n  return ret;\r\n}\r\n\r\n// Set the private key fields N, e, and d from hex strings\r\nfunction RSASetPrivate(N,E,D) {\r\n  if(N != null && E != null && N.length > 0 && E.length > 0) {\r\n    this.n = parseBigInt(N,16);\r\n    this.e = parseInt(E,16);\r\n    this.d = parseBigInt(D,16);\r\n  }\r\n  else\r\n    console.error(\"Invalid RSA private key\");\r\n}\r\n\r\n// Set the private key fields N, e, d and CRT params from hex strings\r\nfunction RSASetPrivateEx(N,E,D,P,Q,DP,DQ,C) {\r\n  if(N != null && E != null && N.length > 0 && E.length > 0) {\r\n    this.n = parseBigInt(N,16);\r\n    this.e = parseInt(E,16);\r\n    this.d = parseBigInt(D,16);\r\n    this.p = parseBigInt(P,16);\r\n    this.q = parseBigInt(Q,16);\r\n    this.dmp1 = parseBigInt(DP,16);\r\n    this.dmq1 = parseBigInt(DQ,16);\r\n    this.coeff = parseBigInt(C,16);\r\n  }\r\n  else\r\n    console.error(\"Invalid RSA private key\");\r\n}\r\n\r\n// Generate a new random private key B bits long, using public expt E\r\nfunction RSAGenerate(B,E) {\r\n  var rng = new SecureRandom();\r\n  var qs = B>>1;\r\n  this.e = parseInt(E,16);\r\n  var ee = new BigInteger(E,16);\r\n  for(;;) {\r\n    for(;;) {\r\n      this.p = new BigInteger(B-qs,1,rng);\r\n      if(this.p.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE) == 0 && this.p.isProbablePrime(10)) break;\r\n    }\r\n    for(;;) {\r\n      this.q = new BigInteger(qs,1,rng);\r\n      if(this.q.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE) == 0 && this.q.isProbablePrime(10)) break;\r\n    }\r\n    if(this.p.compareTo(this.q) <= 0) {\r\n      var t = this.p;\r\n      this.p = this.q;\r\n      this.q = t;\r\n    }\r\n    var p1 = this.p.subtract(BigInteger.ONE);\r\n    var q1 = this.q.subtract(BigInteger.ONE);\r\n    var phi = p1.multiply(q1);\r\n    if(phi.gcd(ee).compareTo(BigInteger.ONE) == 0) {\r\n      this.n = this.p.multiply(this.q);\r\n      this.d = ee.modInverse(phi);\r\n      this.dmp1 = this.d.mod(p1);\r\n      this.dmq1 = this.d.mod(q1);\r\n      this.coeff = this.q.modInverse(this.p);\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\n// Perform raw private operation on \"x\": return x^d (mod n)\r\nfunction RSADoPrivate(x) {\r\n  if(this.p == null || this.q == null)\r\n    return x.modPow(this.d, this.n);\r\n\r\n  // TODO: re-calculate any missing CRT params\r\n  var xp = x.mod(this.p).modPow(this.dmp1, this.p);\r\n  var xq = x.mod(this.q).modPow(this.dmq1, this.q);\r\n\r\n  while(xp.compareTo(xq) < 0)\r\n    xp = xp.add(this.p);\r\n  return xp.subtract(xq).multiply(this.coeff).mod(this.p).multiply(this.q).add(xq);\r\n}\r\n\r\n// Return the PKCS#1 RSA decryption of \"ctext\".\r\n// \"ctext\" is an even-length hex string and the output is a plain string.\r\nfunction RSADecrypt(ctext) {\r\n  var c = parseBigInt(ctext, 16);\r\n  var m = this.doPrivate(c);\r\n  if(m == null) return null;\r\n  return pkcs1unpad2(m, (this.n.bitLength()+7)>>3);\r\n}\r\n\r\n// Return the PKCS#1 RSA decryption of \"ctext\".\r\n// \"ctext\" is a Base64-encoded string and the output is a plain string.\r\n//function RSAB64Decrypt(ctext) {\r\n//  var h = b64tohex(ctext);\r\n//  if(h) return this.decrypt(h); else return null;\r\n//}\r\n\r\n// protected\r\nRSAKey.prototype.doPrivate = RSADoPrivate;\r\n\r\n// public\r\nRSAKey.prototype.setPrivate = RSASetPrivate;\r\nRSAKey.prototype.setPrivateEx = RSASetPrivateEx;\r\nRSAKey.prototype.generate = RSAGenerate;\r\nRSAKey.prototype.decrypt = RSADecrypt;\r\n//RSAKey.prototype.b64_decrypt = RSAB64Decrypt;","// Base64 JavaScript decoder\r\n// Copyright (c) 2008-2013 Lapo Luchini <lapo@lapo.it>\r\n\r\n// Permission to use, copy, modify, and/or distribute this software for any\r\n// purpose with or without fee is hereby granted, provided that the above\r\n// copyright notice and this permission notice appear in all copies.\r\n// \r\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\r\n// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\r\n// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\r\n// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\r\n// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\r\n// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\r\n// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n\r\n/*jshint browser: true, strict: true, immed: true, latedef: true, undef: true, regexdash: false */\r\n\r\nexport const Base64 = {};\r\nlet decoder;\r\n\r\nBase64.decode = function (a) {\r\n    var i;\r\n    if (decoder === undefined) {\r\n        var b64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",\r\n            ignore = \"= \\f\\n\\r\\t\\u00A0\\u2028\\u2029\";\r\n        decoder = [];\r\n        for (i = 0; i < 64; ++i)\r\n            decoder[b64.charAt(i)] = i;\r\n        for (i = 0; i < ignore.length; ++i)\r\n            decoder[ignore.charAt(i)] = -1;\r\n    }\r\n    var out = [];\r\n    var bits = 0, char_count = 0;\r\n    for (i = 0; i < a.length; ++i) {\r\n        var c = a.charAt(i);\r\n        if (c == '=')\r\n            break;\r\n        c = decoder[c];\r\n        if (c == -1)\r\n            continue;\r\n        if (c === undefined)\r\n            throw 'Illegal character at offset ' + i;\r\n        bits |= c;\r\n        if (++char_count >= 4) {\r\n            out[out.length] = (bits >> 16);\r\n            out[out.length] = (bits >> 8) & 0xFF;\r\n            out[out.length] = bits & 0xFF;\r\n            bits = 0;\r\n            char_count = 0;\r\n        } else {\r\n            bits <<= 6;\r\n        }\r\n    }\r\n    switch (char_count) {\r\n      case 1:\r\n        throw \"Base64 encoding incomplete: at least 2 bits missing\";\r\n      case 2:\r\n        out[out.length] = (bits >> 10);\r\n        break;\r\n      case 3:\r\n        out[out.length] = (bits >> 16);\r\n        out[out.length] = (bits >> 8) & 0xFF;\r\n        break;\r\n    }\r\n    return out;\r\n};\r\n\r\nBase64.re = /-----BEGIN [^-]+-----([A-Za-z0-9+\\/=\\s]+)-----END [^-]+-----|begin-base64[^\\n]+\\n([A-Za-z0-9+\\/=\\s]+)====/;\r\nBase64.unarmor = function (a) {\r\n    var m = Base64.re.exec(a);\r\n    if (m) {\r\n        if (m[1])\r\n            a = m[1];\r\n        else if (m[2])\r\n            a = m[2];\r\n        else\r\n            throw \"RegExp out of sync\";\r\n    }\r\n    return Base64.decode(a);\r\n};\r\n","// Hex JavaScript decoder\r\n// Copyright (c) 2008-2013 Lapo Luchini <lapo@lapo.it>\r\n\r\n// Permission to use, copy, modify, and/or distribute this software for any\r\n// purpose with or without fee is hereby granted, provided that the above\r\n// copyright notice and this permission notice appear in all copies.\r\n// \r\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\r\n// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\r\n// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\r\n// ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\r\n// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\r\n// ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\r\n// OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n\r\n/*jshint browser: true, strict: true, immed: true, latedef: true, undef: true, regexdash: false */\r\nexport const Hex = {};\r\nlet decoder;\r\n\r\nHex.decode = function(a) {\r\n    var i;\r\n    if (decoder === undefined) {\r\n        var hex = \"0123456789ABCDEF\",\r\n            ignore = \" \\f\\n\\r\\t\\u00A0\\u2028\\u2029\";\r\n        decoder = [];\r\n        for (i = 0; i < 16; ++i)\r\n            decoder[hex.charAt(i)] = i;\r\n        hex = hex.toLowerCase();\r\n        for (i = 10; i < 16; ++i)\r\n            decoder[hex.charAt(i)] = i;\r\n        for (i = 0; i < ignore.length; ++i)\r\n            decoder[ignore.charAt(i)] = -1;\r\n    }\r\n    var out = [],\r\n        bits = 0,\r\n        char_count = 0;\r\n    for (i = 0; i < a.length; ++i) {\r\n        var c = a.charAt(i);\r\n        if (c == '=')\r\n            break;\r\n        c = decoder[c];\r\n        if (c == -1)\r\n            continue;\r\n        if (c === undefined)\r\n            throw 'Illegal character at offset ' + i;\r\n        bits |= c;\r\n        if (++char_count >= 2) {\r\n            out[out.length] = bits;\r\n            bits = 0;\r\n            char_count = 0;\r\n        } else {\r\n            bits <<= 4;\r\n        }\r\n    }\r\n    if (char_count)\r\n        throw \"Hex encoding incomplete: 4 bits missing\";\r\n    return out;\r\n};","import {BigInteger} from \"../jsbn/jsbn2\";\r\n/*! asn1-1.0.2.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license\r\n */\r\n\r\nexport const JSX = /*window.JSX || */{};\r\nJSX.env = JSX.env || {};\r\n\r\nvar L = JSX, OP = Object.prototype, FUNCTION_TOSTRING = '[object Function]',ADD = [\"toString\", \"valueOf\"];\r\n\r\nJSX.env.parseUA = function(agent) {\r\n\r\n    var numberify = function(s) {\r\n        var c = 0;\r\n        return parseFloat(s.replace(/\\./g, function() {\r\n            return (c++ == 1) ? '' : '.';\r\n        }));\r\n    },\r\n\r\n    nav = navigator,\r\n    o = {\r\n        ie: 0,\r\n        opera: 0,\r\n        gecko: 0,\r\n        webkit: 0,\r\n        chrome: 0,\r\n        mobile: null,\r\n        air: 0,\r\n        ipad: 0,\r\n        iphone: 0,\r\n        ipod: 0,\r\n        ios: null,\r\n        android: 0,\r\n        webos: 0,\r\n        caja: nav && nav.cajaVersion,\r\n        secure: false,\r\n        os: null\r\n\r\n    },\r\n\r\n    ua = agent || (navigator && navigator.userAgent),\r\n    loc = window && window.location,\r\n    href = loc && loc.href,\r\n    m;\r\n\r\n    o.secure = href && (href.toLowerCase().indexOf(\"https\") === 0);\r\n\r\n    if (ua) {\r\n\r\n        if ((/windows|win32/i).test(ua)) {\r\n            o.os = 'windows';\r\n        } else if ((/macintosh/i).test(ua)) {\r\n            o.os = 'macintosh';\r\n        } else if ((/rhino/i).test(ua)) {\r\n            o.os = 'rhino';\r\n        }\r\n        if ((/KHTML/).test(ua)) {\r\n            o.webkit = 1;\r\n        }\r\n        m = ua.match(/AppleWebKit\\/([^\\s]*)/);\r\n        if (m && m[1]) {\r\n            o.webkit = numberify(m[1]);\r\n            if (/ Mobile\\//.test(ua)) {\r\n                o.mobile = 'Apple'; // iPhone or iPod Touch\r\n                m = ua.match(/OS ([^\\s]*)/);\r\n                if (m && m[1]) {\r\n                    m = numberify(m[1].replace('_', '.'));\r\n                }\r\n                o.ios = m;\r\n                o.ipad = o.ipod = o.iphone = 0;\r\n                m = ua.match(/iPad|iPod|iPhone/);\r\n                if (m && m[0]) {\r\n                    o[m[0].toLowerCase()] = o.ios;\r\n                }\r\n            } else {\r\n                m = ua.match(/NokiaN[^\\/]*|Android \\d\\.\\d|webOS\\/\\d\\.\\d/);\r\n                if (m) {\r\n                    o.mobile = m[0];\r\n                }\r\n                if (/webOS/.test(ua)) {\r\n                    o.mobile = 'WebOS';\r\n                    m = ua.match(/webOS\\/([^\\s]*);/);\r\n                    if (m && m[1]) {\r\n                        o.webos = numberify(m[1]);\r\n                    }\r\n                }\r\n                if (/ Android/.test(ua)) {\r\n                    o.mobile = 'Android';\r\n                    m = ua.match(/Android ([^\\s]*);/);\r\n                    if (m && m[1]) {\r\n                        o.android = numberify(m[1]);\r\n                    }\r\n                }\r\n            }\r\n            m = ua.match(/Chrome\\/([^\\s]*)/);\r\n            if (m && m[1]) {\r\n                o.chrome = numberify(m[1]); // Chrome\r\n            } else {\r\n                m = ua.match(/AdobeAIR\\/([^\\s]*)/);\r\n                if (m) {\r\n                    o.air = m[0]; // Adobe AIR 1.0 or better\r\n                }\r\n            }\r\n        }\r\n        if (!o.webkit) {\r\n            m = ua.match(/Opera[\\s\\/]([^\\s]*)/);\r\n            if (m && m[1]) {\r\n                o.opera = numberify(m[1]);\r\n                m = ua.match(/Version\\/([^\\s]*)/);\r\n                if (m && m[1]) {\r\n                    o.opera = numberify(m[1]); // opera 10+\r\n                }\r\n                m = ua.match(/Opera Mini[^;]*/);\r\n                if (m) {\r\n                    o.mobile = m[0]; // ex: Opera Mini/2.0.4509/1316\r\n                }\r\n            } else { // not opera or webkit\r\n                m = ua.match(/MSIE\\s([^;]*)/);\r\n                if (m && m[1]) {\r\n                    o.ie = numberify(m[1]);\r\n                } else { // not opera, webkit, or ie\r\n                    m = ua.match(/Gecko\\/([^\\s]*)/);\r\n                    if (m) {\r\n                        o.gecko = 1; // Gecko detected, look for revision\r\n                        m = ua.match(/rv:([^\\s\\)]*)/);\r\n                        if (m && m[1]) {\r\n                            o.gecko = numberify(m[1]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return o;\r\n};\r\n\r\nJSX.env.ua = JSX.env.parseUA();\r\n\r\nJSX.isFunction = function(o) {\r\n    return (typeof o === 'function') || OP.toString.apply(o) === FUNCTION_TOSTRING;\r\n};\r\n\r\nJSX._IEEnumFix = (JSX.env.ua.ie) ? function(r, s) {\r\n    var i, fname, f;\r\n    for (i=0;i<ADD.length;i=i+1) {\r\n\r\n        fname = ADD[i];\r\n        f = s[fname];\r\n\r\n        if (L.isFunction(f) && f!=OP[fname]) {\r\n            r[fname]=f;\r\n        }\r\n    }\r\n} : function(){};\r\n\r\nJSX.extend = function(subc, superc, overrides) {\r\n    if (!superc||!subc) {\r\n        throw new Error(\"extend failed, please check that \" +\r\n                        \"all dependencies are included.\");\r\n    }\r\n    var F = function() {}, i;\r\n    F.prototype=superc.prototype;\r\n    subc.prototype=new F();\r\n    subc.prototype.constructor=subc;\r\n    subc.superclass=superc.prototype;\r\n    if (superc.prototype.constructor == OP.constructor) {\r\n        superc.prototype.constructor=superc;\r\n    }\r\n\r\n    if (overrides) {\r\n        for (i in overrides) {\r\n            if (L.hasOwnProperty(overrides, i)) {\r\n                subc.prototype[i]=overrides[i];\r\n            }\r\n        }\r\n\r\n        L._IEEnumFix(subc.prototype, overrides);\r\n    }\r\n};\r\n\r\n/*\r\n * asn1.js - ASN.1 DER encoder classes\r\n *\r\n * Copyright (c) 2013 Kenji Urushima (kenji.urushima@gmail.com)\r\n *\r\n * This software is licensed under the terms of the MIT License.\r\n * http://kjur.github.com/jsrsasign/license\r\n *\r\n * The above copyright and license notice shall be \r\n * included in all copies or substantial portions of the Software.\r\n */\r\n\r\n/**\r\n * @fileOverview\r\n * @name asn1-1.0.js\r\n * @author Kenji Urushima kenji.urushima@gmail.com\r\n * @version 1.0.2 (2013-May-30)\r\n * @since 2.1\r\n * @license <a href=\"http://kjur.github.io/jsrsasign/license/\">MIT License</a>\r\n */\r\n\r\n/** \r\n * kjur's class library name space\r\n * <p>\r\n * This name space provides following name spaces:\r\n * <ul>\r\n * <li>{@link KJUR.asn1} - ASN.1 primitive hexadecimal encoder</li>\r\n * <li>{@link KJUR.asn1.x509} - ASN.1 structure for X.509 certificate and CRL</li>\r\n * <li>{@link KJUR.crypto} - Java Cryptographic Extension(JCE) style MessageDigest/Signature \r\n * class and utilities</li>\r\n * </ul>\r\n * </p> \r\n * NOTE: Please ignore method summary and document of this namespace. This caused by a bug of jsdoc2.\r\n  * @name KJUR\r\n * @namespace kjur's class library name space\r\n */\r\n// if (typeof KJUR == \"undefined\" || !KJUR)\r\nexport const KJUR = {};\r\n\r\n/**\r\n * kjur's ASN.1 class library name space\r\n * <p>\r\n * This is ITU-T X.690 ASN.1 DER encoder class library and\r\n * class structure and methods is very similar to \r\n * org.bouncycastle.asn1 package of \r\n * well known BouncyCaslte Cryptography Library.\r\n *\r\n * <h4>PROVIDING ASN.1 PRIMITIVES</h4>\r\n * Here are ASN.1 DER primitive classes.\r\n * <ul>\r\n * <li>{@link KJUR.asn1.DERBoolean}</li>\r\n * <li>{@link KJUR.asn1.DERInteger}</li>\r\n * <li>{@link KJUR.asn1.DERBitString}</li>\r\n * <li>{@link KJUR.asn1.DEROctetString}</li>\r\n * <li>{@link KJUR.asn1.DERNull}</li>\r\n * <li>{@link KJUR.asn1.DERObjectIdentifier}</li>\r\n * <li>{@link KJUR.asn1.DERUTF8String}</li>\r\n * <li>{@link KJUR.asn1.DERNumericString}</li>\r\n * <li>{@link KJUR.asn1.DERPrintableString}</li>\r\n * <li>{@link KJUR.asn1.DERTeletexString}</li>\r\n * <li>{@link KJUR.asn1.DERIA5String}</li>\r\n * <li>{@link KJUR.asn1.DERUTCTime}</li>\r\n * <li>{@link KJUR.asn1.DERGeneralizedTime}</li>\r\n * <li>{@link KJUR.asn1.DERSequence}</li>\r\n * <li>{@link KJUR.asn1.DERSet}</li>\r\n * </ul>\r\n *\r\n * <h4>OTHER ASN.1 CLASSES</h4>\r\n * <ul>\r\n * <li>{@link KJUR.asn1.ASN1Object}</li>\r\n * <li>{@link KJUR.asn1.DERAbstractString}</li>\r\n * <li>{@link KJUR.asn1.DERAbstractTime}</li>\r\n * <li>{@link KJUR.asn1.DERAbstractStructured}</li>\r\n * <li>{@link KJUR.asn1.DERTaggedObject}</li>\r\n * </ul>\r\n * </p>\r\n * NOTE: Please ignore method summary and document of this namespace. This caused by a bug of jsdoc2.\r\n * @name KJUR.asn1\r\n * @namespace\r\n */\r\nif (typeof KJUR.asn1 == \"undefined\" || !KJUR.asn1) KJUR.asn1 = {};\r\n\r\n/**\r\n * ASN1 utilities class\r\n * @name KJUR.asn1.ASN1Util\r\n * @classs ASN1 utilities class\r\n * @since asn1 1.0.2\r\n */\r\nKJUR.asn1.ASN1Util = new function() {\r\n    this.integerToByteHex = function(i) {\r\n\tvar h = i.toString(16);\r\n\tif ((h.length % 2) == 1) h = '0' + h;\r\n\treturn h;\r\n    };\r\n    this.bigIntToMinTwosComplementsHex = function(bigIntegerValue) {\r\n\tvar h = bigIntegerValue.toString(16);\r\n\tif (h.substr(0, 1) != '-') {\r\n\t    if (h.length % 2 == 1) {\r\n\t\th = '0' + h;\r\n\t    } else {\r\n\t\tif (! h.match(/^[0-7]/)) {\r\n\t\t    h = '00' + h;\r\n\t\t}\r\n\t    }\r\n\t} else {\r\n\t    var hPos = h.substr(1);\r\n\t    var xorLen = hPos.length;\r\n\t    if (xorLen % 2 == 1) {\r\n\t\txorLen += 1;\r\n\t    } else {\r\n\t\tif (! h.match(/^[0-7]/)) {\r\n\t\t    xorLen += 2;\r\n\t\t}\r\n\t    }\r\n\t    var hMask = '';\r\n\t    for (var i = 0; i < xorLen; i++) {\r\n\t\thMask += 'f';\r\n\t    }\r\n\t    var biMask = new BigInteger(hMask, 16);\r\n\t    var biNeg = biMask.xor(bigIntegerValue).add(BigInteger.ONE);\r\n\t    h = biNeg.toString(16).replace(/^-/, '');\r\n\t}\r\n\treturn h;\r\n    };\r\n    /**\r\n     * get PEM string from hexadecimal data and header string\r\n     * @name getPEMStringFromHex\r\n     * @memberOf KJUR.asn1.ASN1Util\r\n     * @function\r\n     * @param {String} dataHex hexadecimal string of PEM body\r\n     * @param {String} pemHeader PEM header string (ex. 'RSA PRIVATE KEY')\r\n     * @return {String} PEM formatted string of input data\r\n     * @description\r\n     * @example\r\n     * var pem  = KJUR.asn1.ASN1Util.getPEMStringFromHex('616161', 'RSA PRIVATE KEY');\r\n     * // value of pem will be:\r\n     * -----BEGIN PRIVATE KEY-----\r\n     * YWFh\r\n     * -----END PRIVATE KEY-----\r\n     */\r\n    this.getPEMStringFromHex = function(dataHex, pemHeader) {\r\n\tvar dataWA = CryptoJS.enc.Hex.parse(dataHex);\r\n\tvar dataB64 = CryptoJS.enc.Base64.stringify(dataWA);\r\n\tvar pemBody = dataB64.replace(/(.{64})/g, \"$1\\r\\n\");\r\n        pemBody = pemBody.replace(/\\r\\n$/, '');\r\n\treturn \"-----BEGIN \" + pemHeader + \"-----\\r\\n\" + \r\n               pemBody + \r\n               \"\\r\\n-----END \" + pemHeader + \"-----\\r\\n\";\r\n    };\r\n};\r\n\r\n// ********************************************************************\r\n//  Abstract ASN.1 Classes\r\n// ********************************************************************\r\n\r\n// ********************************************************************\r\n\r\n/**\r\n * base class for ASN.1 DER encoder object\r\n * @name KJUR.asn1.ASN1Object\r\n * @class base class for ASN.1 DER encoder object\r\n * @property {Boolean} isModified flag whether internal data was changed\r\n * @property {String} hTLV hexadecimal string of ASN.1 TLV\r\n * @property {String} hT hexadecimal string of ASN.1 TLV tag(T)\r\n * @property {String} hL hexadecimal string of ASN.1 TLV length(L)\r\n * @property {String} hV hexadecimal string of ASN.1 TLV value(V)\r\n * @description\r\n */\r\nKJUR.asn1.ASN1Object = function() {\r\n    var isModified = true;\r\n    var hTLV = null;\r\n    var hT = '00'\r\n    var hL = '00';\r\n    var hV = '';\r\n\r\n    /**\r\n     * get hexadecimal ASN.1 TLV length(L) bytes from TLV value(V)\r\n     * @name getLengthHexFromValue\r\n     * @memberOf KJUR.asn1.ASN1Object\r\n     * @function\r\n     * @return {String} hexadecimal string of ASN.1 TLV length(L)\r\n     */\r\n    this.getLengthHexFromValue = function() {\r\n\tif (typeof this.hV == \"undefined\" || this.hV == null) {\r\n\t    throw \"this.hV is null or undefined.\";\r\n\t}\r\n\tif (this.hV.length % 2 == 1) {\r\n\t    throw \"value hex must be even length: n=\" + hV.length + \",v=\" + this.hV;\r\n\t}\r\n\tvar n = this.hV.length / 2;\r\n\tvar hN = n.toString(16);\r\n\tif (hN.length % 2 == 1) {\r\n\t    hN = \"0\" + hN;\r\n\t}\r\n\tif (n < 128) {\r\n\t    return hN;\r\n\t} else {\r\n\t    var hNlen = hN.length / 2;\r\n\t    if (hNlen > 15) {\r\n\t\tthrow \"ASN.1 length too long to represent by 8x: n = \" + n.toString(16);\r\n\t    }\r\n\t    var head = 128 + hNlen;\r\n\t    return head.toString(16) + hN;\r\n\t}\r\n    };\r\n\r\n    /**\r\n     * get hexadecimal string of ASN.1 TLV bytes\r\n     * @name getEncodedHex\r\n     * @memberOf KJUR.asn1.ASN1Object\r\n     * @function\r\n     * @return {String} hexadecimal string of ASN.1 TLV\r\n     */\r\n    this.getEncodedHex = function() {\r\n\tif (this.hTLV == null || this.isModified) {\r\n\t    this.hV = this.getFreshValueHex();\r\n\t    this.hL = this.getLengthHexFromValue();\r\n\t    this.hTLV = this.hT + this.hL + this.hV;\r\n\t    this.isModified = false;\r\n\t    //console.error(\"first time: \" + this.hTLV);\r\n\t}\r\n\treturn this.hTLV;\r\n    };\r\n\r\n    /**\r\n     * get hexadecimal string of ASN.1 TLV value(V) bytes\r\n     * @name getValueHex\r\n     * @memberOf KJUR.asn1.ASN1Object\r\n     * @function\r\n     * @return {String} hexadecimal string of ASN.1 TLV value(V) bytes\r\n     */\r\n    this.getValueHex = function() {\r\n\tthis.getEncodedHex();\r\n\treturn this.hV;\r\n    }\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn '';\r\n    };\r\n};\r\n\r\n// == BEGIN DERAbstractString ================================================\r\n/**\r\n * base class for ASN.1 DER string classes\r\n * @name KJUR.asn1.DERAbstractString\r\n * @class base class for ASN.1 DER string classes\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @property {String} s internal string of value\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>str - specify initial ASN.1 value(V) by a string</li>\r\n * <li>hex - specify initial ASN.1 value(V) by a hexadecimal string</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERAbstractString = function(params) {\r\n    KJUR.asn1.DERAbstractString.superclass.constructor.call(this);\r\n    var s = null;\r\n    var hV = null;\r\n\r\n    /**\r\n     * get string value of this string object\r\n     * @name getString\r\n     * @memberOf KJUR.asn1.DERAbstractString\r\n     * @function\r\n     * @return {String} string value of this string object\r\n     */\r\n    this.getString = function() {\r\n\treturn this.s;\r\n    };\r\n\r\n    /**\r\n     * set value by a string\r\n     * @name setString\r\n     * @memberOf KJUR.asn1.DERAbstractString\r\n     * @function\r\n     * @param {String} newS value by a string to set\r\n     */\r\n    this.setString = function(newS) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.s = newS;\r\n\tthis.hV = stohex(this.s);\r\n    };\r\n\r\n    /**\r\n     * set value by a hexadecimal string\r\n     * @name setStringHex\r\n     * @memberOf KJUR.asn1.DERAbstractString\r\n     * @function\r\n     * @param {String} newHexString value by a hexadecimal string to set\r\n     */\r\n    this.setStringHex = function(newHexString) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.s = null;\r\n\tthis.hV = newHexString;\r\n    };\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn this.hV;\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['str'] != \"undefined\") {\r\n\t    this.setString(params['str']);\r\n\t} else if (typeof params['hex'] != \"undefined\") {\r\n\t    this.setStringHex(params['hex']);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERAbstractString, KJUR.asn1.ASN1Object);\r\n// == END   DERAbstractString ================================================\r\n\r\n// == BEGIN DERAbstractTime ==================================================\r\n/**\r\n * base class for ASN.1 DER Generalized/UTCTime class\r\n * @name KJUR.asn1.DERAbstractTime\r\n * @class base class for ASN.1 DER Generalized/UTCTime class\r\n * @param {Array} params associative array of parameters (ex. {'str': '130430235959Z'})\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * @see KJUR.asn1.ASN1Object - superclass\r\n */\r\nKJUR.asn1.DERAbstractTime = function(params) {\r\n    KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);\r\n    var s = null;\r\n    var date = null;\r\n\r\n    // --- PRIVATE METHODS --------------------\r\n    this.localDateToUTC = function(d) {\r\n\tutc = d.getTime() + (d.getTimezoneOffset() * 60000);\r\n\tvar utcDate = new Date(utc);\r\n\treturn utcDate;\r\n    };\r\n\r\n    this.formatDate = function(dateObject, type) {\r\n\tvar pad = this.zeroPadding;\r\n\tvar d = this.localDateToUTC(dateObject);\r\n\tvar year = String(d.getFullYear());\r\n\tif (type == 'utc') year = year.substr(2, 2);\r\n\tvar month = pad(String(d.getMonth() + 1), 2);\r\n\tvar day = pad(String(d.getDate()), 2);\r\n\tvar hour = pad(String(d.getHours()), 2);\r\n\tvar min = pad(String(d.getMinutes()), 2);\r\n\tvar sec = pad(String(d.getSeconds()), 2);\r\n\treturn year + month + day + hour + min + sec + 'Z';\r\n    };\r\n\r\n    this.zeroPadding = function(s, len) {\r\n\tif (s.length >= len) return s;\r\n\treturn new Array(len - s.length + 1).join('0') + s;\r\n    };\r\n\r\n    // --- PUBLIC METHODS --------------------\r\n    /**\r\n     * get string value of this string object\r\n     * @name getString\r\n     * @memberOf KJUR.asn1.DERAbstractTime\r\n     * @function\r\n     * @return {String} string value of this time object\r\n     */\r\n    this.getString = function() {\r\n\treturn this.s;\r\n    };\r\n\r\n    /**\r\n     * set value by a string\r\n     * @name setString\r\n     * @memberOf KJUR.asn1.DERAbstractTime\r\n     * @function\r\n     * @param {String} newS value by a string to set such like \"130430235959Z\"\r\n     */\r\n    this.setString = function(newS) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.s = newS;\r\n\tthis.hV = stohex(this.s);\r\n    };\r\n\r\n    /**\r\n     * set value by a Date object\r\n     * @name setByDateValue\r\n     * @memberOf KJUR.asn1.DERAbstractTime\r\n     * @function\r\n     * @param {Integer} year year of date (ex. 2013)\r\n     * @param {Integer} month month of date between 1 and 12 (ex. 12)\r\n     * @param {Integer} day day of month\r\n     * @param {Integer} hour hours of date\r\n     * @param {Integer} min minutes of date\r\n     * @param {Integer} sec seconds of date\r\n     */\r\n    this.setByDateValue = function(year, month, day, hour, min, sec) {\r\n\tvar dateObject = new Date(Date.UTC(year, month - 1, day, hour, min, sec, 0));\r\n\tthis.setByDate(dateObject);\r\n    };\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn this.hV;\r\n    };\r\n};\r\nJSX.extend(KJUR.asn1.DERAbstractTime, KJUR.asn1.ASN1Object);\r\n// == END   DERAbstractTime ==================================================\r\n\r\n// == BEGIN DERAbstractStructured ============================================\r\n/**\r\n * base class for ASN.1 DER structured class\r\n * @name KJUR.asn1.DERAbstractStructured\r\n * @class base class for ASN.1 DER structured class\r\n * @property {Array} asn1Array internal array of ASN1Object\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * @see KJUR.asn1.ASN1Object - superclass\r\n */\r\nKJUR.asn1.DERAbstractStructured = function(params) {\r\n    KJUR.asn1.DERAbstractString.superclass.constructor.call(this);\r\n    var asn1Array = null;\r\n\r\n    /**\r\n     * set value by array of ASN1Object\r\n     * @name setByASN1ObjectArray\r\n     * @memberOf KJUR.asn1.DERAbstractStructured\r\n     * @function\r\n     * @param {array} asn1ObjectArray array of ASN1Object to set\r\n     */\r\n    this.setByASN1ObjectArray = function(asn1ObjectArray) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.asn1Array = asn1ObjectArray;\r\n    };\r\n\r\n    /**\r\n     * append an ASN1Object to internal array\r\n     * @name appendASN1Object\r\n     * @memberOf KJUR.asn1.DERAbstractStructured\r\n     * @function\r\n     * @param {ASN1Object} asn1Object to add\r\n     */\r\n    this.appendASN1Object = function(asn1Object) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.asn1Array.push(asn1Object);\r\n    };\r\n\r\n    this.asn1Array = new Array();\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['array'] != \"undefined\") {\r\n\t    this.asn1Array = params['array'];\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERAbstractStructured, KJUR.asn1.ASN1Object);\r\n\r\n\r\n// ********************************************************************\r\n//  ASN.1 Object Classes\r\n// ********************************************************************\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER Boolean\r\n * @name KJUR.asn1.DERBoolean\r\n * @class class for ASN.1 DER Boolean\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * @see KJUR.asn1.ASN1Object - superclass\r\n */\r\nKJUR.asn1.DERBoolean = function() {\r\n    KJUR.asn1.DERBoolean.superclass.constructor.call(this);\r\n    this.hT = \"01\";\r\n    this.hTLV = \"0101ff\";\r\n};\r\nJSX.extend(KJUR.asn1.DERBoolean, KJUR.asn1.ASN1Object);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER Integer\r\n * @name KJUR.asn1.DERInteger\r\n * @class class for ASN.1 DER Integer\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>int - specify initial ASN.1 value(V) by integer value</li>\r\n * <li>bigint - specify initial ASN.1 value(V) by BigInteger object</li>\r\n * <li>hex - specify initial ASN.1 value(V) by a hexadecimal string</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERInteger = function(params) {\r\n    KJUR.asn1.DERInteger.superclass.constructor.call(this);\r\n    this.hT = \"02\";\r\n\r\n    /**\r\n     * set value by Tom Wu's BigInteger object\r\n     * @name setByBigInteger\r\n     * @memberOf KJUR.asn1.DERInteger\r\n     * @function\r\n     * @param {BigInteger} bigIntegerValue to set\r\n     */\r\n    this.setByBigInteger = function(bigIntegerValue) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.hV = KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(bigIntegerValue);\r\n    };\r\n\r\n    /**\r\n     * set value by integer value\r\n     * @name setByInteger\r\n     * @memberOf KJUR.asn1.DERInteger\r\n     * @function\r\n     * @param {Integer} integer value to set\r\n     */\r\n    this.setByInteger = function(intValue) {\r\n\tvar bi = new BigInteger(String(intValue), 10);\r\n\tthis.setByBigInteger(bi);\r\n    };\r\n\r\n    /**\r\n     * set value by integer value\r\n     * @name setValueHex\r\n     * @memberOf KJUR.asn1.DERInteger\r\n     * @function\r\n     * @param {String} hexadecimal string of integer value\r\n     * @description\r\n     * <br/>\r\n     * NOTE: Value shall be represented by minimum octet length of\r\n     * two's complement representation.\r\n     */\r\n    this.setValueHex = function(newHexString) {\r\n\tthis.hV = newHexString;\r\n    };\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn this.hV;\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['bigint'] != \"undefined\") {\r\n\t    this.setByBigInteger(params['bigint']);\r\n\t} else if (typeof params['int'] != \"undefined\") {\r\n\t    this.setByInteger(params['int']);\r\n\t} else if (typeof params['hex'] != \"undefined\") {\r\n\t    this.setValueHex(params['hex']);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERInteger, KJUR.asn1.ASN1Object);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER encoded BitString primitive\r\n * @name KJUR.asn1.DERBitString\r\n * @class class for ASN.1 DER encoded BitString primitive\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description \r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>bin - specify binary string (ex. '10111')</li>\r\n * <li>array - specify array of boolean (ex. [true,false,true,true])</li>\r\n * <li>hex - specify hexadecimal string of ASN.1 value(V) including unused bits</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERBitString = function(params) {\r\n    KJUR.asn1.DERBitString.superclass.constructor.call(this);\r\n    this.hT = \"03\";\r\n\r\n    /**\r\n     * set ASN.1 value(V) by a hexadecimal string including unused bits\r\n     * @name setHexValueIncludingUnusedBits\r\n     * @memberOf KJUR.asn1.DERBitString\r\n     * @function\r\n     * @param {String} newHexStringIncludingUnusedBits\r\n     */\r\n    this.setHexValueIncludingUnusedBits = function(newHexStringIncludingUnusedBits) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.hV = newHexStringIncludingUnusedBits;\r\n    };\r\n\r\n    /**\r\n     * set ASN.1 value(V) by unused bit and hexadecimal string of value\r\n     * @name setUnusedBitsAndHexValue\r\n     * @memberOf KJUR.asn1.DERBitString\r\n     * @function\r\n     * @param {Integer} unusedBits\r\n     * @param {String} hValue\r\n     */\r\n    this.setUnusedBitsAndHexValue = function(unusedBits, hValue) {\r\n\tif (unusedBits < 0 || 7 < unusedBits) {\r\n\t    throw \"unused bits shall be from 0 to 7: u = \" + unusedBits;\r\n\t}\r\n\tvar hUnusedBits = \"0\" + unusedBits;\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.hV = hUnusedBits + hValue;\r\n    };\r\n\r\n    /**\r\n     * set ASN.1 DER BitString by binary string\r\n     * @name setByBinaryString\r\n     * @memberOf KJUR.asn1.DERBitString\r\n     * @function\r\n     * @param {String} binaryString binary value string (i.e. '10111')\r\n     * @description\r\n     * Its unused bits will be calculated automatically by length of \r\n     * 'binaryValue'. <br/>\r\n     * NOTE: Trailing zeros '0' will be ignored.\r\n     */\r\n    this.setByBinaryString = function(binaryString) {\r\n\tbinaryString = binaryString.replace(/0+$/, '');\r\n\tvar unusedBits = 8 - binaryString.length % 8;\r\n\tif (unusedBits == 8) unusedBits = 0;\r\n\tfor (var i = 0; i <= unusedBits; i++) {\r\n\t    binaryString += '0';\r\n\t}\r\n\tvar h = '';\r\n\tfor (var i = 0; i < binaryString.length - 1; i += 8) {\r\n\t    var b = binaryString.substr(i, 8);\r\n\t    var x = parseInt(b, 2).toString(16);\r\n\t    if (x.length == 1) x = '0' + x;\r\n\t    h += x;  \r\n\t}\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.hV = '0' + unusedBits + h;\r\n    };\r\n\r\n    /**\r\n     * set ASN.1 TLV value(V) by an array of boolean\r\n     * @name setByBooleanArray\r\n     * @memberOf KJUR.asn1.DERBitString\r\n     * @function\r\n     * @param {array} booleanArray array of boolean (ex. [true, false, true])\r\n     * @description\r\n     * NOTE: Trailing falses will be ignored.\r\n     */\r\n    this.setByBooleanArray = function(booleanArray) {\r\n\tvar s = '';\r\n\tfor (var i = 0; i < booleanArray.length; i++) {\r\n\t    if (booleanArray[i] == true) {\r\n\t\ts += '1';\r\n\t    } else {\r\n\t\ts += '0';\r\n\t    }\r\n\t}\r\n\tthis.setByBinaryString(s);\r\n    };\r\n\r\n    /**\r\n     * generate an array of false with specified length\r\n     * @name newFalseArray\r\n     * @memberOf KJUR.asn1.DERBitString\r\n     * @function\r\n     * @param {Integer} nLength length of array to generate\r\n     * @return {array} array of boolean faluse\r\n     * @description\r\n     * This static method may be useful to initialize boolean array.\r\n     */\r\n    this.newFalseArray = function(nLength) {\r\n\tvar a = new Array(nLength);\r\n\tfor (var i = 0; i < nLength; i++) {\r\n\t    a[i] = false;\r\n\t}\r\n\treturn a;\r\n    };\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn this.hV;\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['hex'] != \"undefined\") {\r\n\t    this.setHexValueIncludingUnusedBits(params['hex']);\r\n\t} else if (typeof params['bin'] != \"undefined\") {\r\n\t    this.setByBinaryString(params['bin']);\r\n\t} else if (typeof params['array'] != \"undefined\") {\r\n\t    this.setByBooleanArray(params['array']);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERBitString, KJUR.asn1.ASN1Object);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER OctetString\r\n * @name KJUR.asn1.DEROctetString\r\n * @class class for ASN.1 DER OctetString\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @extends KJUR.asn1.DERAbstractString\r\n * @description\r\n * @see KJUR.asn1.DERAbstractString - superclass\r\n */\r\nKJUR.asn1.DEROctetString = function(params) {\r\n    KJUR.asn1.DEROctetString.superclass.constructor.call(this, params);\r\n    this.hT = \"04\";\r\n};\r\nJSX.extend(KJUR.asn1.DEROctetString, KJUR.asn1.DERAbstractString);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER Null\r\n * @name KJUR.asn1.DERNull\r\n * @class class for ASN.1 DER Null\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * @see KJUR.asn1.ASN1Object - superclass\r\n */\r\nKJUR.asn1.DERNull = function() {\r\n    KJUR.asn1.DERNull.superclass.constructor.call(this);\r\n    this.hT = \"05\";\r\n    this.hTLV = \"0500\";\r\n};\r\nJSX.extend(KJUR.asn1.DERNull, KJUR.asn1.ASN1Object);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER ObjectIdentifier\r\n * @name KJUR.asn1.DERObjectIdentifier\r\n * @class class for ASN.1 DER ObjectIdentifier\r\n * @param {Array} params associative array of parameters (ex. {'oid': '2.5.4.5'})\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>oid - specify initial ASN.1 value(V) by a oid string (ex. 2.5.4.13)</li>\r\n * <li>hex - specify initial ASN.1 value(V) by a hexadecimal string</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERObjectIdentifier = function(params) {\r\n    var itox = function(i) {\r\n\tvar h = i.toString(16);\r\n\tif (h.length == 1) h = '0' + h;\r\n\treturn h;\r\n    };\r\n    var roidtox = function(roid) {\r\n\tvar h = '';\r\n\tvar bi = new BigInteger(roid, 10);\r\n\tvar b = bi.toString(2);\r\n\tvar padLen = 7 - b.length % 7;\r\n\tif (padLen == 7) padLen = 0;\r\n\tvar bPad = '';\r\n\tfor (var i = 0; i < padLen; i++) bPad += '0';\r\n\tb = bPad + b;\r\n\tfor (var i = 0; i < b.length - 1; i += 7) {\r\n\t    var b8 = b.substr(i, 7);\r\n\t    if (i != b.length - 7) b8 = '1' + b8;\r\n\t    h += itox(parseInt(b8, 2));\r\n\t}\r\n\treturn h;\r\n    }\r\n\r\n    KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this);\r\n    this.hT = \"06\";\r\n\r\n    /**\r\n     * set value by a hexadecimal string\r\n     * @name setValueHex\r\n     * @memberOf KJUR.asn1.DERObjectIdentifier\r\n     * @function\r\n     * @param {String} newHexString hexadecimal value of OID bytes\r\n     */\r\n    this.setValueHex = function(newHexString) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.s = null;\r\n\tthis.hV = newHexString;\r\n    };\r\n\r\n    /**\r\n     * set value by a OID string\r\n     * @name setValueOidString\r\n     * @memberOf KJUR.asn1.DERObjectIdentifier\r\n     * @function\r\n     * @param {String} oidString OID string (ex. 2.5.4.13)\r\n     */\r\n    this.setValueOidString = function(oidString) {\r\n\tif (! oidString.match(/^[0-9.]+$/)) {\r\n\t    throw \"malformed oid string: \" + oidString;\r\n\t}\r\n\tvar h = '';\r\n\tvar a = oidString.split('.');\r\n\tvar i0 = parseInt(a[0]) * 40 + parseInt(a[1]);\r\n\th += itox(i0);\r\n\ta.splice(0, 2);\r\n\tfor (var i = 0; i < a.length; i++) {\r\n\t    h += roidtox(a[i]);\r\n\t}\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.s = null;\r\n\tthis.hV = h;\r\n    };\r\n\r\n    /**\r\n     * set value by a OID name\r\n     * @name setValueName\r\n     * @memberOf KJUR.asn1.DERObjectIdentifier\r\n     * @function\r\n     * @param {String} oidName OID name (ex. 'serverAuth')\r\n     * @since 1.0.1\r\n     * @description\r\n     * OID name shall be defined in 'KJUR.asn1.x509.OID.name2oidList'.\r\n     * Otherwise raise error.\r\n     */\r\n    this.setValueName = function(oidName) {\r\n\tif (typeof KJUR.asn1.x509.OID.name2oidList[oidName] != \"undefined\") {\r\n\t    var oid = KJUR.asn1.x509.OID.name2oidList[oidName];\r\n\t    this.setValueOidString(oid);\r\n\t} else {\r\n\t    throw \"DERObjectIdentifier oidName undefined: \" + oidName;\r\n\t}\r\n    };\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn this.hV;\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['oid'] != \"undefined\") {\r\n\t    this.setValueOidString(params['oid']);\r\n\t} else if (typeof params['hex'] != \"undefined\") {\r\n\t    this.setValueHex(params['hex']);\r\n\t} else if (typeof params['name'] != \"undefined\") {\r\n\t    this.setValueName(params['name']);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERObjectIdentifier, KJUR.asn1.ASN1Object);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER UTF8String\r\n * @name KJUR.asn1.DERUTF8String\r\n * @class class for ASN.1 DER UTF8String\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @extends KJUR.asn1.DERAbstractString\r\n * @description\r\n * @see KJUR.asn1.DERAbstractString - superclass\r\n */\r\nKJUR.asn1.DERUTF8String = function(params) {\r\n    KJUR.asn1.DERUTF8String.superclass.constructor.call(this, params);\r\n    this.hT = \"0c\";\r\n};\r\nJSX.extend(KJUR.asn1.DERUTF8String, KJUR.asn1.DERAbstractString);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER NumericString\r\n * @name KJUR.asn1.DERNumericString\r\n * @class class for ASN.1 DER NumericString\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @extends KJUR.asn1.DERAbstractString\r\n * @description\r\n * @see KJUR.asn1.DERAbstractString - superclass\r\n */\r\nKJUR.asn1.DERNumericString = function(params) {\r\n    KJUR.asn1.DERNumericString.superclass.constructor.call(this, params);\r\n    this.hT = \"12\";\r\n};\r\nJSX.extend(KJUR.asn1.DERNumericString, KJUR.asn1.DERAbstractString);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER PrintableString\r\n * @name KJUR.asn1.DERPrintableString\r\n * @class class for ASN.1 DER PrintableString\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @extends KJUR.asn1.DERAbstractString\r\n * @description\r\n * @see KJUR.asn1.DERAbstractString - superclass\r\n */\r\nKJUR.asn1.DERPrintableString = function(params) {\r\n    KJUR.asn1.DERPrintableString.superclass.constructor.call(this, params);\r\n    this.hT = \"13\";\r\n};\r\nJSX.extend(KJUR.asn1.DERPrintableString, KJUR.asn1.DERAbstractString);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER TeletexString\r\n * @name KJUR.asn1.DERTeletexString\r\n * @class class for ASN.1 DER TeletexString\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @extends KJUR.asn1.DERAbstractString\r\n * @description\r\n * @see KJUR.asn1.DERAbstractString - superclass\r\n */\r\nKJUR.asn1.DERTeletexString = function(params) {\r\n    KJUR.asn1.DERTeletexString.superclass.constructor.call(this, params);\r\n    this.hT = \"14\";\r\n};\r\nJSX.extend(KJUR.asn1.DERTeletexString, KJUR.asn1.DERAbstractString);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER IA5String\r\n * @name KJUR.asn1.DERIA5String\r\n * @class class for ASN.1 DER IA5String\r\n * @param {Array} params associative array of parameters (ex. {'str': 'aaa'})\r\n * @extends KJUR.asn1.DERAbstractString\r\n * @description\r\n * @see KJUR.asn1.DERAbstractString - superclass\r\n */\r\nKJUR.asn1.DERIA5String = function(params) {\r\n    KJUR.asn1.DERIA5String.superclass.constructor.call(this, params);\r\n    this.hT = \"16\";\r\n};\r\nJSX.extend(KJUR.asn1.DERIA5String, KJUR.asn1.DERAbstractString);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER UTCTime\r\n * @name KJUR.asn1.DERUTCTime\r\n * @class class for ASN.1 DER UTCTime\r\n * @param {Array} params associative array of parameters (ex. {'str': '130430235959Z'})\r\n * @extends KJUR.asn1.DERAbstractTime\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>str - specify initial ASN.1 value(V) by a string (ex.'130430235959Z')</li>\r\n * <li>hex - specify initial ASN.1 value(V) by a hexadecimal string</li>\r\n * <li>date - specify Date object.</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n * <h4>EXAMPLES</h4>\r\n * @example\r\n * var d1 = new KJUR.asn1.DERUTCTime();\r\n * d1.setString('130430125959Z');\r\n *\r\n * var d2 = new KJUR.asn1.DERUTCTime({'str': '130430125959Z'});\r\n *\r\n * var d3 = new KJUR.asn1.DERUTCTime({'date': new Date(Date.UTC(2015, 0, 31, 0, 0, 0, 0))});\r\n */\r\nKJUR.asn1.DERUTCTime = function(params) {\r\n    KJUR.asn1.DERUTCTime.superclass.constructor.call(this, params);\r\n    this.hT = \"17\";\r\n\r\n    /**\r\n     * set value by a Date object\r\n     * @name setByDate\r\n     * @memberOf KJUR.asn1.DERUTCTime\r\n     * @function\r\n     * @param {Date} dateObject Date object to set ASN.1 value(V)\r\n     */\r\n    this.setByDate = function(dateObject) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.date = dateObject;\r\n\tthis.s = this.formatDate(this.date, 'utc');\r\n\tthis.hV = stohex(this.s);\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['str'] != \"undefined\") {\r\n\t    this.setString(params['str']);\r\n\t} else if (typeof params['hex'] != \"undefined\") {\r\n\t    this.setStringHex(params['hex']);\r\n\t} else if (typeof params['date'] != \"undefined\") {\r\n\t    this.setByDate(params['date']);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERUTCTime, KJUR.asn1.DERAbstractTime);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER GeneralizedTime\r\n * @name KJUR.asn1.DERGeneralizedTime\r\n * @class class for ASN.1 DER GeneralizedTime\r\n * @param {Array} params associative array of parameters (ex. {'str': '20130430235959Z'})\r\n * @extends KJUR.asn1.DERAbstractTime\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>str - specify initial ASN.1 value(V) by a string (ex.'20130430235959Z')</li>\r\n * <li>hex - specify initial ASN.1 value(V) by a hexadecimal string</li>\r\n * <li>date - specify Date object.</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERGeneralizedTime = function(params) {\r\n    KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this, params);\r\n    this.hT = \"18\";\r\n\r\n    /**\r\n     * set value by a Date object\r\n     * @name setByDate\r\n     * @memberOf KJUR.asn1.DERGeneralizedTime\r\n     * @function\r\n     * @param {Date} dateObject Date object to set ASN.1 value(V)\r\n     * @example\r\n     * When you specify UTC time, use 'Date.UTC' method like this:<br/>\r\n     * var o = new DERUTCTime();\r\n     * var date = new Date(Date.UTC(2015, 0, 31, 23, 59, 59, 0)); #2015JAN31 23:59:59\r\n     * o.setByDate(date);\r\n     */\r\n    this.setByDate = function(dateObject) {\r\n\tthis.hTLV = null;\r\n\tthis.isModified = true;\r\n\tthis.date = dateObject;\r\n\tthis.s = this.formatDate(this.date, 'gen');\r\n\tthis.hV = stohex(this.s);\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['str'] != \"undefined\") {\r\n\t    this.setString(params['str']);\r\n\t} else if (typeof params['hex'] != \"undefined\") {\r\n\t    this.setStringHex(params['hex']);\r\n\t} else if (typeof params['date'] != \"undefined\") {\r\n\t    this.setByDate(params['date']);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERGeneralizedTime, KJUR.asn1.DERAbstractTime);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER Sequence\r\n * @name KJUR.asn1.DERSequence\r\n * @class class for ASN.1 DER Sequence\r\n * @extends KJUR.asn1.DERAbstractStructured\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>array - specify array of ASN1Object to set elements of content</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERSequence = function(params) {\r\n    KJUR.asn1.DERSequence.superclass.constructor.call(this, params);\r\n    this.hT = \"30\";\r\n    this.getFreshValueHex = function() {\r\n\tvar h = '';\r\n\tfor (var i = 0; i < this.asn1Array.length; i++) {\r\n\t    var asn1Obj = this.asn1Array[i];\r\n\t    h += asn1Obj.getEncodedHex();\r\n\t}\r\n\tthis.hV = h;\r\n\treturn this.hV;\r\n    };\r\n};\r\nJSX.extend(KJUR.asn1.DERSequence, KJUR.asn1.DERAbstractStructured);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER Set\r\n * @name KJUR.asn1.DERSet\r\n * @class class for ASN.1 DER Set\r\n * @extends KJUR.asn1.DERAbstractStructured\r\n * @description\r\n * <br/>\r\n * As for argument 'params' for constructor, you can specify one of\r\n * following properties:\r\n * <ul>\r\n * <li>array - specify array of ASN1Object to set elements of content</li>\r\n * </ul>\r\n * NOTE: 'params' can be omitted.\r\n */\r\nKJUR.asn1.DERSet = function(params) {\r\n    KJUR.asn1.DERSet.superclass.constructor.call(this, params);\r\n    this.hT = \"31\";\r\n    this.getFreshValueHex = function() {\r\n\tvar a = new Array();\r\n\tfor (var i = 0; i < this.asn1Array.length; i++) {\r\n\t    var asn1Obj = this.asn1Array[i];\r\n\t    a.push(asn1Obj.getEncodedHex());\r\n\t}\r\n\ta.sort();\r\n\tthis.hV = a.join('');\r\n\treturn this.hV;\r\n    };\r\n};\r\nJSX.extend(KJUR.asn1.DERSet, KJUR.asn1.DERAbstractStructured);\r\n\r\n// ********************************************************************\r\n/**\r\n * class for ASN.1 DER TaggedObject\r\n * @name KJUR.asn1.DERTaggedObject\r\n * @class class for ASN.1 DER TaggedObject\r\n * @extends KJUR.asn1.ASN1Object\r\n * @description\r\n * <br/>\r\n * Parameter 'tagNoNex' is ASN.1 tag(T) value for this object.\r\n * For example, if you find '[1]' tag in a ASN.1 dump, \r\n * 'tagNoHex' will be 'a1'.\r\n * <br/>\r\n * As for optional argument 'params' for constructor, you can specify *ANY* of\r\n * following properties:\r\n * <ul>\r\n * <li>explicit - specify true if this is explicit tag otherwise false \r\n *     (default is 'true').</li>\r\n * <li>tag - specify tag (default is 'a0' which means [0])</li>\r\n * <li>obj - specify ASN1Object which is tagged</li>\r\n * </ul>\r\n * @example\r\n * d1 = new KJUR.asn1.DERUTF8String({'str':'a'});\r\n * d2 = new KJUR.asn1.DERTaggedObject({'obj': d1});\r\n * hex = d2.getEncodedHex();\r\n */\r\nKJUR.asn1.DERTaggedObject = function(params) {\r\n    KJUR.asn1.DERTaggedObject.superclass.constructor.call(this);\r\n    this.hT = \"a0\";\r\n    this.hV = '';\r\n    this.isExplicit = true;\r\n    this.asn1Object = null;\r\n\r\n    /**\r\n     * set value by an ASN1Object\r\n     * @name setString\r\n     * @memberOf KJUR.asn1.DERTaggedObject\r\n     * @function\r\n     * @param {Boolean} isExplicitFlag flag for explicit/implicit tag\r\n     * @param {Integer} tagNoHex hexadecimal string of ASN.1 tag\r\n     * @param {ASN1Object} asn1Object ASN.1 to encapsulate\r\n     */\r\n    this.setASN1Object = function(isExplicitFlag, tagNoHex, asn1Object) {\r\n\tthis.hT = tagNoHex;\r\n\tthis.isExplicit = isExplicitFlag;\r\n\tthis.asn1Object = asn1Object;\r\n\tif (this.isExplicit) {\r\n\t    this.hV = this.asn1Object.getEncodedHex();\r\n\t    this.hTLV = null;\r\n\t    this.isModified = true;\r\n\t} else {\r\n\t    this.hV = null;\r\n\t    this.hTLV = asn1Object.getEncodedHex();\r\n\t    this.hTLV = this.hTLV.replace(/^../, tagNoHex);\r\n\t    this.isModified = false;\r\n\t}\r\n    };\r\n\r\n    this.getFreshValueHex = function() {\r\n\treturn this.hV;\r\n    };\r\n\r\n    if (typeof params != \"undefined\") {\r\n\tif (typeof params['tag'] != \"undefined\") {\r\n\t    this.hT = params['tag'];\r\n\t}\r\n\tif (typeof params['explicit'] != \"undefined\") {\r\n\t    this.isExplicit = params['explicit'];\r\n\t}\r\n\tif (typeof params['obj'] != \"undefined\") {\r\n\t    this.asn1Object = params['obj'];\r\n\t    this.setASN1Object(this.isExplicit, this.hT, this.asn1Object);\r\n\t}\r\n    }\r\n};\r\nJSX.extend(KJUR.asn1.DERTaggedObject, KJUR.asn1.ASN1Object);","import {int2char} from \"./jsbn\";\r\n\r\nvar b64map=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\nvar b64pad=\"=\";\r\n\r\nexport function hex2b64(h) {\r\n  var i;\r\n  var c;\r\n  var ret = \"\";\r\n  for(i = 0; i+3 <= h.length; i+=3) {\r\n    c = parseInt(h.substring(i,i+3),16);\r\n    ret += b64map.charAt(c >> 6) + b64map.charAt(c & 63);\r\n  }\r\n  if(i+1 == h.length) {\r\n    c = parseInt(h.substring(i,i+1),16);\r\n    ret += b64map.charAt(c << 2);\r\n  }\r\n  else if(i+2 == h.length) {\r\n    c = parseInt(h.substring(i,i+2),16);\r\n    ret += b64map.charAt(c >> 2) + b64map.charAt((c & 3) << 4);\r\n  }\r\n  while((ret.length & 3) > 0) ret += b64pad;\r\n  return ret;\r\n}\r\n\r\n// convert a base64 string to hex\r\nexport function b64tohex(s) {\r\n  var ret = \"\";\r\n  var i;\r\n  var k = 0; // b64 state, 0-3\r\n  var slop;\r\n  for(i = 0; i < s.length; ++i) {\r\n    if(s.charAt(i) == b64pad) break;\r\n    let v = b64map.indexOf(s.charAt(i));\r\n    if(v < 0) continue;\r\n    if(k == 0) {\r\n      ret += int2char(v >> 2);\r\n      slop = v & 3;\r\n      k = 1;\r\n    }\r\n    else if(k == 1) {\r\n      ret += int2char((slop << 2) | (v >> 4));\r\n      slop = v & 0xf;\r\n      k = 2;\r\n    }\r\n    else if(k == 2) {\r\n      ret += int2char(slop);\r\n      ret += int2char(v >> 2);\r\n      slop = v & 3;\r\n      k = 3;\r\n    }\r\n    else {\r\n      ret += int2char((slop << 2) | (v >> 4));\r\n      ret += int2char(v & 0xf);\r\n      k = 0;\r\n    }\r\n  }\r\n  if(k == 1)\r\n    ret += int2char(slop << 2);\r\n  return ret;\r\n}\r\n\r\n// convert a base64 string to a byte/number array\r\nexport function b64toBA(s) {\r\n  //piggyback on b64tohex for now, optimize later\r\n  var h = b64tohex(s);\r\n  var i;\r\n  var a = [];\r\n  for(i = 0; 2*i < h.length; ++i) {\r\n    a[i] = parseInt(h.substring(2*i,2*i+2),16);\r\n  }\r\n  return a;\r\n}\r\n","import {ASN1} from \"../lib/asn1js/asn1\";\r\nimport {RSAKey} from \"../lib/jsbn/rsa2\";\r\nimport {Base64} from \"../lib/asn1js/base64\";\r\nimport {Hex} from \"../lib/asn1js/hex\";\r\nimport {parseBigInt} from \"../lib/jsbn/rsa\";\r\nimport {KJUR} from \"../lib/jsrsasign/asn1-1.0\";\r\nimport {hex2b64} from \"../lib/jsbn/base64\";\r\nimport {b64tohex} from \"../lib/jsbn/base64\";\r\n/**\r\n * Retrieve the hexadecimal value (as a string) of the current ASN.1 element\r\n * @returns {string}\r\n * @public\r\n */\r\nASN1.prototype.getHexStringValue = function () {\r\n  var hexString = this.toHexString();\r\n  var offset = this.header * 2;\r\n  var length = this.length * 2;\r\n  return hexString.substr(offset, length);\r\n};\r\n\r\n/**\r\n * Method to parse a pem encoded string containing both a public or private key.\r\n * The method will translate the pem encoded string in a der encoded string and\r\n * will parse private key and public key parameters. This method accepts public key\r\n * in the rsaencryption pkcs #1 format (oid: 1.2.840.113549.1.1.1).\r\n *\r\n * @todo Check how many rsa formats use the same format of pkcs #1.\r\n *\r\n * The format is defined as:\r\n * PublicKeyInfo ::= SEQUENCE {\r\n *   algorithm       AlgorithmIdentifier,\r\n *   PublicKey       BIT STRING\r\n * }\r\n * Where AlgorithmIdentifier is:\r\n * AlgorithmIdentifier ::= SEQUENCE {\r\n *   algorithm       OBJECT IDENTIFIER,     the OID of the enc algorithm\r\n *   parameters      ANY DEFINED BY algorithm OPTIONAL (NULL for PKCS #1)\r\n * }\r\n * and PublicKey is a SEQUENCE encapsulated in a BIT STRING\r\n * RSAPublicKey ::= SEQUENCE {\r\n *   modulus           INTEGER,  -- n\r\n *   publicExponent    INTEGER   -- e\r\n * }\r\n * it's possible to examine the structure of the keys obtained from openssl using\r\n * an asn.1 dumper as the one used here to parse the components: http://lapo.it/asn1js/\r\n * @argument {string} pem the pem encoded string, can include the BEGIN/END header/footer\r\n * @private\r\n */\r\nRSAKey.prototype.parseKey = function (pem) {\r\n  try {\r\n    var modulus = 0;\r\n    var public_exponent = 0;\r\n    var reHex = /^\\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\\s*)+$/;\r\n    var der = reHex.test(pem) ? Hex.decode(pem) : Base64.unarmor(pem);\r\n    var asn1 = ASN1.decode(der);\r\n\r\n    //Fixes a bug with OpenSSL 1.0+ private keys\r\n    if(asn1.sub.length === 3){\r\n        asn1 = asn1.sub[2].sub[0];\r\n    }\r\n    if (asn1.sub.length === 9) {\r\n\r\n      // Parse the private key.\r\n      modulus = asn1.sub[1].getHexStringValue(); //bigint\r\n      this.n = parseBigInt(modulus, 16);\r\n\r\n      public_exponent = asn1.sub[2].getHexStringValue(); //int\r\n      this.e = parseInt(public_exponent, 16);\r\n\r\n      var private_exponent = asn1.sub[3].getHexStringValue(); //bigint\r\n      this.d = parseBigInt(private_exponent, 16);\r\n\r\n      var prime1 = asn1.sub[4].getHexStringValue(); //bigint\r\n      this.p = parseBigInt(prime1, 16);\r\n\r\n      var prime2 = asn1.sub[5].getHexStringValue(); //bigint\r\n      this.q = parseBigInt(prime2, 16);\r\n\r\n      var exponent1 = asn1.sub[6].getHexStringValue(); //bigint\r\n      this.dmp1 = parseBigInt(exponent1, 16);\r\n\r\n      var exponent2 = asn1.sub[7].getHexStringValue(); //bigint\r\n      this.dmq1 = parseBigInt(exponent2, 16);\r\n\r\n      var coefficient = asn1.sub[8].getHexStringValue(); //bigint\r\n      this.coeff = parseBigInt(coefficient, 16);\r\n\r\n    }\r\n    else if (asn1.sub.length === 2) {\r\n\r\n      // Parse the public key.\r\n      var bit_string = asn1.sub[1];\r\n      var sequence = bit_string.sub[0];\r\n\r\n      modulus = sequence.sub[0].getHexStringValue();\r\n      this.n = parseBigInt(modulus, 16);\r\n      public_exponent = sequence.sub[1].getHexStringValue();\r\n      this.e = parseInt(public_exponent, 16);\r\n\r\n    }\r\n    else {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n  catch (ex) {\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Translate rsa parameters in a hex encoded string representing the rsa key.\r\n *\r\n * The translation follow the ASN.1 notation :\r\n * RSAPrivateKey ::= SEQUENCE {\r\n *   version           Version,\r\n *   modulus           INTEGER,  -- n\r\n *   publicExponent    INTEGER,  -- e\r\n *   privateExponent   INTEGER,  -- d\r\n *   prime1            INTEGER,  -- p\r\n *   prime2            INTEGER,  -- q\r\n *   exponent1         INTEGER,  -- d mod (p1)\r\n *   exponent2         INTEGER,  -- d mod (q-1)\r\n *   coefficient       INTEGER,  -- (inverse of q) mod p\r\n * }\r\n * @returns {string}  DER Encoded String representing the rsa private key\r\n * @private\r\n */\r\nRSAKey.prototype.getPrivateBaseKey = function () {\r\n  var options = {\r\n    'array': [\r\n      new KJUR.asn1.DERInteger({'int': 0}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.n}),\r\n      new KJUR.asn1.DERInteger({'int': this.e}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.d}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.p}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.q}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.dmp1}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.dmq1}),\r\n      new KJUR.asn1.DERInteger({'bigint': this.coeff})\r\n    ]\r\n  };\r\n  var seq = new KJUR.asn1.DERSequence(options);\r\n  return seq.getEncodedHex();\r\n};\r\n\r\n/**\r\n * base64 (pem) encoded version of the DER encoded representation\r\n * @returns {string} pem encoded representation without header and footer\r\n * @public\r\n */\r\nRSAKey.prototype.getPrivateBaseKeyB64 = function () {\r\n  return hex2b64(this.getPrivateBaseKey());\r\n};\r\n\r\n/**\r\n * Translate rsa parameters in a hex encoded string representing the rsa public key.\r\n * The representation follow the ASN.1 notation :\r\n * PublicKeyInfo ::= SEQUENCE {\r\n *   algorithm       AlgorithmIdentifier,\r\n *   PublicKey       BIT STRING\r\n * }\r\n * Where AlgorithmIdentifier is:\r\n * AlgorithmIdentifier ::= SEQUENCE {\r\n *   algorithm       OBJECT IDENTIFIER,     the OID of the enc algorithm\r\n *   parameters      ANY DEFINED BY algorithm OPTIONAL (NULL for PKCS #1)\r\n * }\r\n * and PublicKey is a SEQUENCE encapsulated in a BIT STRING\r\n * RSAPublicKey ::= SEQUENCE {\r\n *   modulus           INTEGER,  -- n\r\n *   publicExponent    INTEGER   -- e\r\n * }\r\n * @returns {string} DER Encoded String representing the rsa public key\r\n * @private\r\n */\r\nRSAKey.prototype.getPublicBaseKey = function () {\r\n  var options = {\r\n    'array': [\r\n      new KJUR.asn1.DERObjectIdentifier({'oid': '1.2.840.113549.1.1.1'}), //RSA Encryption pkcs #1 oid\r\n      new KJUR.asn1.DERNull()\r\n    ]\r\n  };\r\n  var first_sequence = new KJUR.asn1.DERSequence(options);\r\n\r\n  options = {\r\n    'array': [\r\n      new KJUR.asn1.DERInteger({'bigint': this.n}),\r\n      new KJUR.asn1.DERInteger({'int': this.e})\r\n    ]\r\n  };\r\n  var second_sequence = new KJUR.asn1.DERSequence(options);\r\n\r\n  options = {\r\n    'hex': '00' + second_sequence.getEncodedHex()\r\n  };\r\n  var bit_string = new KJUR.asn1.DERBitString(options);\r\n\r\n  options = {\r\n    'array': [\r\n      first_sequence,\r\n      bit_string\r\n    ]\r\n  };\r\n  var seq = new KJUR.asn1.DERSequence(options);\r\n  return seq.getEncodedHex();\r\n};\r\n\r\n/**\r\n * base64 (pem) encoded version of the DER encoded representation\r\n * @returns {string} pem encoded representation without header and footer\r\n * @public\r\n */\r\nRSAKey.prototype.getPublicBaseKeyB64 = function () {\r\n  return hex2b64(this.getPublicBaseKey());\r\n};\r\n\r\n/**\r\n * wrap the string in block of width chars. The default value for rsa keys is 64\r\n * characters.\r\n * @param {string} str the pem encoded string without header and footer\r\n * @param {Number} [width=64] - the length the string has to be wrapped at\r\n * @returns {string}\r\n * @private\r\n */\r\nRSAKey.prototype.wordwrap = function (str, width) {\r\n  width = width || 64;\r\n  if (!str) {\r\n    return str;\r\n  }\r\n  var regex = '(.{1,' + width + '})( +|$\\n?)|(.{1,' + width + '})';\r\n  return str.match(RegExp(regex, 'g')).join('\\n');\r\n};\r\n\r\n/**\r\n * Retrieve the pem encoded private key\r\n * @returns {string} the pem encoded private key with header/footer\r\n * @public\r\n */\r\nRSAKey.prototype.getPrivateKey = function () {\r\n  var key = \"-----BEGIN RSA PRIVATE KEY-----\\n\";\r\n  key += this.wordwrap(this.getPrivateBaseKeyB64()) + \"\\n\";\r\n  key += \"-----END RSA PRIVATE KEY-----\";\r\n  return key;\r\n};\r\n\r\n/**\r\n * Retrieve the pem encoded public key\r\n * @returns {string} the pem encoded public key with header/footer\r\n * @public\r\n */\r\nRSAKey.prototype.getPublicKey = function () {\r\n  var key = \"-----BEGIN PUBLIC KEY-----\\n\";\r\n  key += this.wordwrap(this.getPublicBaseKeyB64()) + \"\\n\";\r\n  key += \"-----END PUBLIC KEY-----\";\r\n  return key;\r\n};\r\n\r\n/**\r\n * Check if the object contains the necessary parameters to populate the rsa modulus\r\n * and public exponent parameters.\r\n * @param {Object} [obj={}] - An object that may contain the two public key\r\n * parameters\r\n * @returns {boolean} true if the object contains both the modulus and the public exponent\r\n * properties (n and e)\r\n * @todo check for types of n and e. N should be a parseable bigInt object, E should\r\n * be a parseable integer number\r\n * @private\r\n */\r\nRSAKey.prototype.hasPublicKeyProperty = function (obj) {\r\n  obj = obj || {};\r\n  return (\r\n    obj.hasOwnProperty('n') &&\r\n    obj.hasOwnProperty('e')\r\n  );\r\n};\r\n\r\n/**\r\n * Check if the object contains ALL the parameters of an RSA key.\r\n * @param {Object} [obj={}] - An object that may contain nine rsa key\r\n * parameters\r\n * @returns {boolean} true if the object contains all the parameters needed\r\n * @todo check for types of the parameters all the parameters but the public exponent\r\n * should be parseable bigint objects, the public exponent should be a parseable integer number\r\n * @private\r\n */\r\nRSAKey.prototype.hasPrivateKeyProperty = function (obj) {\r\n  obj = obj || {};\r\n  return (\r\n    obj.hasOwnProperty('n') &&\r\n    obj.hasOwnProperty('e') &&\r\n    obj.hasOwnProperty('d') &&\r\n    obj.hasOwnProperty('p') &&\r\n    obj.hasOwnProperty('q') &&\r\n    obj.hasOwnProperty('dmp1') &&\r\n    obj.hasOwnProperty('dmq1') &&\r\n    obj.hasOwnProperty('coeff')\r\n  );\r\n};\r\n\r\n/**\r\n * Parse the properties of obj in the current rsa object. Obj should AT LEAST\r\n * include the modulus and public exponent (n, e) parameters.\r\n * @param {Object} obj - the object containing rsa parameters\r\n * @private\r\n */\r\nRSAKey.prototype.parsePropertiesFrom = function (obj) {\r\n  this.n = obj.n;\r\n  this.e = obj.e;\r\n\r\n  if (obj.hasOwnProperty('d')) {\r\n    this.d = obj.d;\r\n    this.p = obj.p;\r\n    this.q = obj.q;\r\n    this.dmp1 = obj.dmp1;\r\n    this.dmq1 = obj.dmq1;\r\n    this.coeff = obj.coeff;\r\n  }\r\n};\r\n\r\n/**\r\n * Create a new JSEncryptRSAKey that extends Tom Wu's RSA key object.\r\n * This object is just a decorator for parsing the key parameter\r\n * @param {string|Object} key - The key in string format, or an object containing\r\n * the parameters needed to build a RSAKey object.\r\n * @constructor\r\n */\r\nclass JSEncryptRSAKey extends RSAKey {\r\n  constructor(key) {\r\n    // Call the super constructor.\r\n    super();\r\n    // If a key key was provided.\r\n    if (key) {\r\n      // If this is a string...\r\n      if (typeof key === 'string') {\r\n        this.parseKey(key);\r\n      }\r\n      else if (\r\n          this.hasPrivateKeyProperty(key) ||\r\n          this.hasPublicKeyProperty(key)\r\n      ) {\r\n        // Set the values for the key.\r\n        this.parsePropertiesFrom(key);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n *\r\n * @param {Object} [options = {}] - An object to customize JSEncrypt behaviour\r\n * possible parameters are:\r\n * - default_key_size        {number}  default: 1024 the key size in bit\r\n * - default_public_exponent {string}  default: '010001' the hexadecimal representation of the public exponent\r\n * - log                     {boolean} default: false whether log warn/error or not\r\n * @constructor\r\n */\r\nexport class JSEncrypt{\r\n  constructor (options) {\r\n    options = options || {};\r\n    this.default_key_size = parseInt(options.default_key_size) || 1024;\r\n    this.default_public_exponent = options.default_public_exponent || '010001'; //65537 default openssl public exponent for rsa key type\r\n    this.log = options.log || false;\r\n    // The private and public key.\r\n    this.key = null;\r\n  }\r\n}\r\n\r\n/**\r\n * Method to set the rsa key parameter (one method is enough to set both the public\r\n * and the private key, since the private key contains the public key paramenters)\r\n * Log a warning if logs are enabled\r\n * @param {Object|string} key the pem encoded string or an object (with or without header/footer)\r\n * @public\r\n */\r\nJSEncrypt.prototype.setKey = function (key) {\r\n  if (this.log && this.key) {\r\n    console.warn('A key was already set, overriding existing.');\r\n  }\r\n  this.key = new JSEncryptRSAKey(key);\r\n};\r\n\r\n/**\r\n * Proxy method for setKey, for api compatibility\r\n * @see setKey\r\n * @public\r\n */\r\nJSEncrypt.prototype.setPrivateKey = function (privkey) {\r\n  // Create the key.\r\n  this.setKey(privkey);\r\n};\r\n\r\n/**\r\n * Proxy method for setKey, for api compatibility\r\n * @see setKey\r\n * @public\r\n */\r\nJSEncrypt.prototype.setPublicKey = function (pubkey) {\r\n  // Sets the public key.\r\n  this.setKey(pubkey);\r\n};\r\n\r\n/**\r\n * Proxy method for RSAKey object's decrypt, decrypt the string using the private\r\n * components of the rsa key object. Note that if the object was not set will be created\r\n * on the fly (by the getKey method) using the parameters passed in the JSEncrypt constructor\r\n * @param {string} string base64 encoded crypted string to decrypt\r\n * @return {string} the decrypted string\r\n * @public\r\n */\r\nJSEncrypt.prototype.decrypt = function (string) {\r\n  // Return the decrypted string.\r\n  try {\r\n    return this.getKey().decrypt(b64tohex(string));\r\n  }\r\n  catch (ex) {\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Proxy method for RSAKey object's encrypt, encrypt the string using the public\r\n * components of the rsa key object. Note that if the object was not set will be created\r\n * on the fly (by the getKey method) using the parameters passed in the JSEncrypt constructor\r\n * @param {string} string the string to encrypt\r\n * @return {string} the encrypted string encoded in base64\r\n * @public\r\n */\r\nJSEncrypt.prototype.encrypt = function (string) {\r\n  // Return the encrypted string.\r\n  try {\r\n    return hex2b64(this.getKey().encrypt(string));\r\n  }\r\n  catch (ex) {\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Getter for the current JSEncryptRSAKey object. If it doesn't exists a new object\r\n * will be created and returned\r\n * @param {callback} [cb] the callback to be called if we want the key to be generated\r\n * in an async fashion\r\n * @returns {JSEncryptRSAKey} the JSEncryptRSAKey object\r\n * @public\r\n */\r\nJSEncrypt.prototype.getKey = function (cb) {\r\n  // Only create new if it does not exist.\r\n  if (!this.key) {\r\n    // Get a new private key.\r\n    this.key = new JSEncryptRSAKey();\r\n    if (cb && {}.toString.call(cb) === '[object Function]') {\r\n      this.key.generateAsync(this.default_key_size, this.default_public_exponent, cb);\r\n      return;\r\n    }\r\n    // Generate the key.\r\n    this.key.generate(this.default_key_size, this.default_public_exponent);\r\n  }\r\n  return this.key;\r\n};\r\n\r\n/**\r\n * Returns the pem encoded representation of the private key\r\n * If the key doesn't exists a new key will be created\r\n * @returns {string} pem encoded representation of the private key WITH header and footer\r\n * @public\r\n */\r\nJSEncrypt.prototype.getPrivateKey = function () {\r\n  // Return the private representation of this key.\r\n  return this.getKey().getPrivateKey();\r\n};\r\n\r\n/**\r\n * Returns the pem encoded representation of the private key\r\n * If the key doesn't exists a new key will be created\r\n * @returns {string} pem encoded representation of the private key WITHOUT header and footer\r\n * @public\r\n */\r\nJSEncrypt.prototype.getPrivateKeyB64 = function () {\r\n  // Return the private representation of this key.\r\n  return this.getKey().getPrivateBaseKeyB64();\r\n};\r\n\r\n\r\n/**\r\n * Returns the pem encoded representation of the public key\r\n * If the key doesn't exists a new key will be created\r\n * @returns {string} pem encoded representation of the public key WITH header and footer\r\n * @public\r\n */\r\nJSEncrypt.prototype.getPublicKey = function () {\r\n  // Return the private representation of this key.\r\n  return this.getKey().getPublicKey();\r\n};\r\n\r\n/**\r\n * Returns the pem encoded representation of the public key\r\n * If the key doesn't exists a new key will be created\r\n * @returns {string} pem encoded representation of the public key WITHOUT header and footer\r\n * @public\r\n */\r\nJSEncrypt.prototype.getPublicKeyB64 = function () {\r\n  // Return the private representation of this key.\r\n  return this.getKey().getPublicBaseKeyB64();\r\n};\r\n\r\n","// export * from 'jsencrypt';\nexport * from '../../node_modules/jsencrypt/src/jsencrypt.js';","import {EventEmitter} from \"../deps/bp_event.js\";\n\nexport class BaseRequest {\n    constructor(data) {\n        this.data = data;\n        this.before = (data)=>{return Promise.resolve(data)};\n    }\n\n    send() {\n        return this.before(this.data);\n    }\n\n    before(fn) {\n        return Promise.resolve\n    }\n}\n\nexport class BaseTransport {\n    constructor(endpoint, stream_type, config={}) {\n        this.stream_type = stream_type;\n        this.endpoint = endpoint;\n        this.eventSource = new EventEmitter();\n        this.dataQueue = [];\n    }\n\n    static canTransfer(stream_type) {\n        return BaseTransport.streamTypes().includes(stream_type);\n    }\n    \n    static streamTypes() {\n        return [];\n    }\n\n    destroy() {\n        this.eventSource.destroy();\n    }\n\n    connect() {\n        // TO be impemented\n    }\n\n    disconnect() {\n        // TO be impemented\n    }\n\n    reconnect() {\n        return this.disconnect().then(()=>{\n            return this.connect();\n        });\n    }\n\n    setEndpoint(endpoint) {\n        this.endpoint = endpoint;\n        return this.reconnect();\n    }\n\n    send(data) {\n        // TO be impemented\n        // return this.prepare(data).send();\n    }\n\n    prepare(data) {\n        // TO be impemented\n        // return new Request(data);\n    }\n\n    // onData(type, data) {\n    //     this.eventSource.dispatchEvent(type, data);\n    // }\n}","export const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n\nexport const CPU_CORES = 1;//navigator.hardwareConcurrency || 3;","import {getTagged} from '../deps/bp_logger.js';\nimport {JSEncrypt} from '../deps/jsencrypt.js';\nimport {BaseTransport} from \"../core/base_transport.js\";\nimport {CPU_CORES} from \"../core/util/browser.js\";\n\nconst LOG_TAG = \"transport:ws\";\nconst Log = getTagged(LOG_TAG);\nconst WORKER_COUNT = CPU_CORES;\n\nexport default class WebsocketTransport extends BaseTransport {\n    constructor(endpoint, stream_type, options={\n        socket:`${location.protocol.replace('http', 'ws')}//${location.host}/ws/`,\n        workers: 1\n    }) {\n        super(endpoint, stream_type);\n        this.proxies = [];\n        this.currentProxy = 0;\n        this.workers = 1;\n        this.socket_url = options.socket;\n        this.ready = this.connect();\n    }\n\n    destroy() {\n        return this.disconnect().then(()=>{\n            return super.destroy();\n        });\n\n    }\n\n    static canTransfer(stream_type) {\n        return WebsocketTransport.streamTypes().includes(stream_type);\n    }\n\n    static streamTypes() {\n        return ['hls', 'rtsp'];\n    }\n\n    connect() {\n        return this.disconnect().then(()=>{\n            let promises = [];\n            // TODO: get mirror list\n            for (let i=0; i<this.workers; ++i) {\n                let proxy = new WebSocketProxy(this.socket_url, this.endpoint, this.stream_type);\n\n                proxy.set_disconnect_handler((e)=> {\n                    this.eventSource.dispatchEvent('disconnected', {code: e.code, reason: e.reason});\n                    // TODO: only reconnect on demand\n                    if ([1000, 1006, 1013, 1011].includes(e.code)) {\n                        setTimeout(()=> {\n                            if (this.ready && this.ready.reject) {\n                                this.ready.reject();\n                            }\n                            this.ready = this.connect();\n                        }, 3000);\n                    }\n                });\n\n                proxy.set_data_handler((data)=> {\n                    this.dataQueue.push(new Uint8Array(data));\n                    this.eventSource.dispatchEvent('data');\n                });\n\n                promises.push(proxy.connect().then(()=> {\n                    this.eventSource.dispatchEvent('connected');\n                }).catch((e)=> {\n                    this.eventSource.dispatchEvent('error');\n                    throw new Error(e);\n                }));\n                this.proxies.push(proxy);\n            }\n            return Promise.all(promises);\n        });\n    }\n\n    disconnect() {\n        let promises = [];\n        for (let i=0; i<this.proxies.length; ++i) {\n            promises.push(this.proxies[i].close());\n        }\n        this.proxies= [];\n        if (this.proxies.length) {\n            return Promise.all(promises);\n        } else {\n            return Promise.resolve();\n        }\n    }\n\n    socket() {\n        return this.proxies[(this.currentProxy++)%this.proxies.length];\n    }\n\n    send(_data, fn) {\n        let res = this.socket().send(_data);\n        if (fn) {\n            fn(res.seq);\n        }\n        return res.promise;\n    }\n}\n\nclass WSPProtocol {\n    static get PROTO() {return  'WSP';}\n\n    static get V1_1() {return '1.1';}\n\n    static get CMD_INIT() {return 'INIT';}\n    static get CMD_JOIN() {return  'JOIN';}\n    static get CMD_WRAP() {return  'WRAP';}\n\n\n    constructor(ver){\n        this.ver = ver;\n    }\n\n    build(cmd, data, payload=''){\n        let data_str='';\n        if (!data.seq) {\n            data.seq = ++WSPProtocol.seq;\n        }\n        for (let k in data) {\n            data_str += `${k}: ${data[k]}\\r\\n`;\n        }\n        return `${WSPProtocol.PROTO}/${this.ver} ${cmd}\\r\\n${data_str}\\r\\n${payload}`;\n    }\n\n    static parse(data) {\n        if(typeof(data) != \"string\") {\n            console.log(data);\n            return null;\n        }\n        let payIdx = data.indexOf('\\r\\n\\r\\n');\n        let lines = data.substr(0, payIdx).split('\\r\\n');\n        let hdr = lines.shift().match(new RegExp(`${WSPProtocol.PROTO}/${WSPProtocol.V1_1}\\\\s+(\\\\d+)\\\\s+(.+)`));\n        if (hdr) {\n            let res = {\n                code: Number(hdr[1]),\n                msg:  hdr[2],\n                data: {},\n                payload: ''\n            };\n            while (lines.length) {\n                let line = lines.shift();\n                if (line) {\n                    let [k,v] = line.split(':');\n                    res.data[k.trim()] = v.trim();\n                } else {\n                    break;\n                }\n            }\n            res.payload = data.substr(payIdx+4);\n            return res;\n        }\n        return null;\n    }\n}\nWSPProtocol.seq = 0;\n\nclass WebSocketProxy {\n    static get CHN_CONTROL() {return 'control';}\n    static get CHN_DATA() {return  'data';}\n\n    constructor(wsurl, endpoint, stream_type) {\n        this.url = wsurl;\n        this.stream_type = stream_type;\n        this.endpoint = endpoint;\n        this.data_handler = ()=>{};\n        this.disconnect_handler = ()=>{};\n        this.builder = new WSPProtocol(WSPProtocol.V1_1);\n        this.awaitingPromises = {};\n        this.seq = 0;\n        this.encryptor = new JSEncrypt();\n    }\n\n    set_data_handler(handler) {\n        this.data_handler = handler;\n    }\n\n    set_disconnect_handler(handler) {\n        this.disconnect_handler = handler;\n    }\n\n    close() {\n        Log.log('closing connection');\n        return new Promise((resolve)=>{\n            this.ctrlChannel.onclose = ()=>{\n                if (this.dataChannel) {\n                    this.dataChannel.onclose = ()=>{\n                        Log.log('closed');\n                        resolve();\n                    };\n                    this.dataChannel.close();\n                } else {\n                    Log.log('closed');\n                    resolve();\n                }\n            };\n            this.ctrlChannel.close();\n        });\n    }\n\n    onDisconnect(){\n        this.ctrlChannel.onclose=null;\n        this.ctrlChannel.close();\n        if (this.dataChannel) {\n            this.dataChannel.onclose = null;\n            this.dataChannel.close();\n        }\n        this.disconnect_handler(this);\n    }\n\n    initDataChannel(channel_id) {\n        return new Promise((resolve, reject)=>{\n            this.dataChannel = new WebSocket(this.url + WebSocketProxy.CHN_DATA);\n            this.dataChannel.binaryType = 'arraybuffer';\n            this.dataChannel.onopen = ()=>{\n                let msg = this.builder.build(WSPProtocol.CMD_JOIN, {\n                    channel: channel_id\n                });\n                Log.debug(msg);\n                this.dataChannel.send(msg);\n            };\n            this.dataChannel.onmessage = (ev)=>{\n                Log.debug(`[data]\\r\\n${ev.data}`);\n                let res = WSPProtocol.parse(ev.data);\n                if (!res) {\n                    return reject();\n                }\n\n                this.dataChannel.onmessage=(e)=>{\n                    // Log.debug('got data');\n                    if (this.data_handler) {\n                        this.data_handler(e.data);\n                    }\n                };\n                resolve();\n            };\n            this.dataChannel.onerror = (e)=>{\n                Log.error(`[data] ${e.type}`);\n                this.dataChannel.close();\n            };\n            this.dataChannel.onclose = (e)=>{\n                Log.error(`[data] ${e.type}. code: ${e.code}, reason: ${e.reason || 'unknown reason'}`);\n                this.onDisconnect(e);\n            };\n        });\n    }\n\n    connect() {\n        this.encryptionKey = null;\n        return new Promise((resolve, reject)=>{\n            this.ctrlChannel = new WebSocket(this.url + WebSocketProxy.CHN_CONTROL);\n\n            this.connected = false;\n\n            this.ctrlChannel.onopen = ()=>{\n                let headers = {\n                    proto: this.stream_type\n                };\n                if (this.endpoint.socket) {\n                    headers.socket = this.endpoint.socket;\n                } else {\n                    Object.assign(headers, {\n                        host:  this.endpoint.host,\n                        port:  this.endpoint.port\n                    })\n                }\n                let msg = this.builder.build(WSPProtocol.CMD_INIT, headers);\n                Log.debug(msg);\n                this.ctrlChannel.send(msg);\n            };\n\n            this.ctrlChannel.onmessage = (ev)=>{\n                Log.debug(`[ctrl]\\r\\n${ev.data}`);\n\n                let res = WSPProtocol.parse(ev.data);\n                if (!res) {\n                    return reject();\n                }\n\n                if (res.code >= 300) {\n                    Log.error(`[ctrl]\\r\\n${res.code}: ${res.msg}`);\n                    return reject();\n                }\n                this.ctrlChannel.onmessage = (e)=> {\n                    let res = WSPProtocol.parse(e.data);\n                    Log.debug(`[ctrl]\\r\\n${e.data}`);\n                    if (res.data.seq in this.awaitingPromises) {\n                        if (res.code < 300) {\n                            this.awaitingPromises[res.data.seq].resolve(res);\n                        } else {\n                            this.awaitingPromises[res.data.seq].reject(res);\n                        }\n                        delete this.awaitingPromises[res.data.seq];\n                    }\n                };\n                this.encryptionKey = res.data.pubkey || null;\n                if (this.encryptionKey) {\n                    this.encryptor.setPublicKey(this.encryptionKey);\n                    // TODO: check errors\n                }\n                this.initDataChannel(res.data.channel).then(resolve).catch(reject);\n            };\n\n            this.ctrlChannel.onerror = (e)=>{\n                Log.error(`[ctrl] ${e.type}`);\n                this.ctrlChannel.close();\n            };\n            this.ctrlChannel.onclose = (e)=>{\n                Log.error(`[ctrl] ${e.type}. code: ${e.code} ${e.reason || 'unknown reason'}`);\n                this.onDisconnect(e);\n            };\n        });\n    }\n\n    encrypt(msg) {\n        if (this.encryptionKey) {\n            let crypted = this.encryptor.encrypt(msg);\n            if (crypted === false) {\n                throw new Error(\"Encryption failed. Stopping\")\n            }\n            return crypted;\n        }\n        return msg;\n    }\n\n    send(payload) {\n        if (this.ctrlChannel.readyState != WebSocket.OPEN) {\n            this.close();\n            // .then(this.connect.bind(this));\n            // return;\n            throw new Error('disconnected');\n        }\n        // Log.debug(payload);\n        let data = {\n            contentLength: payload.length,\n            seq: ++WSPProtocol.seq\n        };\n        return {\n            seq:data.seq,\n            promise: new Promise((resolve, reject)=>{\n                this.awaitingPromises[data.seq] = {resolve, reject};\n                let msg = this.builder.build(WSPProtocol.CMD_WRAP, data, payload);\n                Log.debug(msg);\n                this.ctrlChannel.send(this.encrypt(msg));\n            })};\n    }\n}","import {getTagged} from './deps/bp_logger.js';\nimport {Url} from './core/util/url.js';\nimport {Remuxer} from './core/remuxer/remuxer.js';\nimport DEFAULT_CLIENT from './client/rtsp/client.js';\nimport DEFAULT_TRANSPORT from './transport/websocket.js';\n\nconst Log = getTagged('wsp');\n\nexport class StreamType {\n    static get HLS() {return 'hls';}\n    static get RTSP() {return 'rtsp';}\n\n    static isSupported(type) {\n        return [StreamType.HLS, StreamType.RTSP].includes(type);\n    }\n\n    static fromUrl(url) {\n        let parsed;\n        try {\n            parsed = Url.parse(url);\n        } catch (e) {\n            return null;\n        }\n        switch (parsed.protocol) {\n            case 'rtsp':\n                return StreamType.RTSP;\n            case 'http':\n            case 'https':\n                if (url.indexOf('.m3u8')>=0) {\n                    return StreamType.HLS;\n                } else {\n                    return null;\n                }\n            default:\n                return null;\n        }\n    }\n\n    static fromMime(mime) {\n        switch (mime) {\n            case 'application/x-rtsp':\n                return StreamType.RTSP;\n            case 'application/vnd.apple.mpegurl':\n            case 'application/x-mpegurl':\n                return StreamType.HLS;\n            default:\n                return null;\n        }\n    }\n}\n\nexport class WSPlayer {\n\n    constructor(node, opts) {\n        if (typeof node == typeof '') {\n            this.player = document.getElementById(node);\n        } else {\n            this.player = node;\n        }\n\n        let modules = opts.modules || {\n            client: DEFAULT_CLIENT,\n            transport: {\n                constructor: DEFAULT_TRANSPORT\n            }\n        };\n        this.errorHandler = opts.errorHandler || null;\n        this.queryCredentials = opts.queryCredentials || null;\n\n        this.modules = {};\n        for (let module of modules) {\n            let transport = module.transport || DEFAULT_TRANSPORT;\n            let client = module.client || DEFAULT_CLIENT;\n            if (transport.constructor.canTransfer(client.streamType())) {\n                this.modules[client.streamType()] = {\n                    client: client,\n                    transport: transport\n                }\n            } else {\n                Log.warn(`Client stream type ${client.streamType()} is incompatible with transport types [${transport.streamTypes().join(', ')}]. Skip`)\n            }\n        }\n\n        this.type = StreamType.RTSP;\n        this.url = null;\n        if (opts.url && opts.type) {\n            this.url = opts.url;\n            this.type = opts.type;\n        } else {\n            if (!this._checkSource(this.player)) {\n                for (let i=0; i<this.player.children.length; ++i) {\n                    if (this._checkSource(this.player.children[i])) {\n                        break;\n                    }\n                }\n            }\n            // if (!this.url) {\n            //      throw new Error('No playable endpoint found');\n            // }\n        }\n\n        if (this.url) {\n            this.setSource(this.url, this.type);\n        }\n\n        this.player.addEventListener('play', ()=>{\n            if (!this.isPlaying()) {\n                this.client.start();\n            }\n        }, false);\n\n        this.player.addEventListener('pause', ()=>{\n            this.client.stop();\n        }, false);\n\n        this.player.addEventListener('abort', () => {\n            // disconnect the transport when the player is closed\n            this.client.stop();\n            this.transport.disconnect().then(() => {\n                this.client.destroy();\n            });\n        }, false);\n    }\n\n    // TODO: check native support\n\n    isPlaying() {\n        return !(this.player.paused || this.client.paused);\n    }\n\n    static canPlayWithModules(mimeType, modules) {\n\n        let filteredModules = {};\n        for (let module of modules) {\n            let transport = module.transport || DEFAULT_TRANSPORT;\n            let client = module.client || DEFAULT_CLIENT;\n            if (transport.canTransfer(client.streamType())) {\n                filteredModules[client.streamType()] = true;\n            }\n        }\n\n        for (let type in filteredModules) {\n            if (type == StreamType.fromMime(mimeType)) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /// TODO: deprecate it?\n    static canPlay(resource) {\n        return StreamType.fromMime(resource.type) || StreamType.fromUrl(resource.src);\n    }\n\n    canPlayUrl(src) {\n        let type = StreamType.fromUrl(src);\n        return (type in this.modules);\n    }\n\n    _checkSource(src) {\n        if (!src.dataset['ignore'] && src.src && !this.player.canPlayType(src.type) && (StreamType.fromMime(src.type) || StreamType.fromUrl(src.src))) {\n            this.url = src.src;\n            this.type = src.type ? StreamType.fromMime(src.type) : StreamType.fromUrl(src.src);\n            return true;\n        }\n        return false;\n    }\n\n    async setSource(url, type) {\n        if (this.transport) {\n            if (this.client) {\n                await this.client.detachTransport();\n            }\n            await this.transport.destroy();\n        }\n        try {\n            this.endpoint = Url.parse(url);\n        } catch (e) {\n            return;\n        }\n        this.url = url;\n        let transport = this.modules[type].transport;\n        this.transport = new transport.constructor(this.endpoint, this.type, transport.options);\n\n\n        let lastType = this.type;\n        this.type = (StreamType.isSupported(type)?type:false) || StreamType.fromMime(type);\n        if (!this.type) {\n            throw new Error(\"Bad stream type\");\n        }\n\n        if (lastType!=this.type || !this.client) {\n            if (this.client) {\n                await this.client.destroy();\n            }\n            let client = this.modules[type].client;\n            this.client = new client();\n        } else {\n            this.client.reset();\n        }\n\n        if (this.queryCredentials) {\n            this.client.queryCredentials = this.queryCredentials;\n        }\n        if (this.remuxer) {\n            this.remuxer.destroy();\n            this.remuxer = null;\n        }\n        this.remuxer = new Remuxer(this.player);\n        this.remuxer.attachClient(this.client);\n\n        this.client.attachTransport(this.transport);\n        this.client.setSource(this.endpoint);\n\n        if (this.player.autoplay) {\n            this.start();\n        }\n    }\n\n    start() {\n        if (this.client) {\n            this.client.start().catch((e)=>{\n                if (this.errorHandler) {\n                    this.errorHandler(e);\n                }\n            });\n        }\n    }\n\n    stop() {\n        if (this.client) {\n            this.client.stop();\n        }\n    }\n\n    async destroy() {\n        if (this.transport) {\n            if (this.client) {\n                await this.client.detachTransport();\n            }\n            await this.transport.destroy();\n        }\n        if (this.client) {\n            await this.client.destroy();\n        }\n        if (this.remuxer) {\n            this.remuxer.destroy();\n            this.remuxer = null;\n        }\n    }\n\n}\n","import {appendByteArray} from '../util/binary.js';\n\nexport class PESAsm {\n\n    constructor() {\n        this.fragments = [];\n        this.pesLength=0;\n        this.pesPkt = null;\n    }\n\n    parse(frag) {\n\n        if (this.extPresent) {\n            let ext = this.parseExtension(frag);\n            ext.data = frag.subarray(ext.offset);\n        } else {\n            return null;\n        }\n    }\n\n    parseHeader() {\n        let hdr = this.fragments[0];\n        let pesPrefix = (hdr[0] << 16) + (hdr[1] << 8) + hdr[2];\n        this.extPresent = ![0xbe, 0xbf].includes(hdr[3]);\n        if (pesPrefix === 1) {\n            let pesLength = (hdr[4] << 8) + hdr[5];\n            if (pesLength) {\n                this.pesLength = pesLength;\n                this.hasLength = true;\n            } else {\n                this.hasLength = false;\n                this.pesPkt = null;\n            }\n            return true;\n        }\n        return false;\n    }\n\n    static PTSNormalize(value, reference) {\n\n        let offset;\n        if (reference === undefined) {\n            return value;\n        }\n        if (reference < value) {\n            // - 2^33\n            offset = -8589934592;\n        } else {\n            // + 2^33\n            offset = 8589934592;\n        }\n        /* PTS is 33bit (from 0 to 2^33 -1)\n         if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\n         PTS looping occured. fill the gap */\n        while (Math.abs(value - reference) > 4294967296) {\n            value += offset;\n        }\n        return value;\n    }\n\n    parseExtension(frag) {\n        let  pesFlags, pesPrefix, pesLen, pesHdrLen, pesPts, pesDts, payloadStartOffset;\n            pesFlags = frag[1];\n            if (pesFlags & 0xC0) {\n                /* PES header described here : http://dvd.sourceforge.net/dvdinfo/pes-hdr.html\n                 as PTS / DTS is 33 bit we cannot use bitwise operator in JS,\n                 as Bitwise operators treat their operands as a sequence of 32 bits */\n                pesPts = (frag[3] & 0x0E) * 536870912 +// 1 << 29\n                    (frag[4] & 0xFF) * 4194304 +// 1 << 22\n                    (frag[5] & 0xFE) * 16384 +// 1 << 14\n                    (frag[6] & 0xFF) * 128 +// 1 << 7\n                    (frag[7] & 0xFE) / 2;\n                // check if greater than 2^32 -1\n                if (pesPts > 4294967295) {\n                    // decrement 2^33\n                    pesPts -= 8589934592;\n                }\n                if (pesFlags & 0x40) {\n                    pesDts = (frag[8] & 0x0E ) * 536870912 +// 1 << 29\n                        (frag[9] & 0xFF ) * 4194304 +// 1 << 22\n                        (frag[10] & 0xFE ) * 16384 +// 1 << 14\n                        (frag[11] & 0xFF ) * 128 +// 1 << 7\n                        (frag[12] & 0xFE ) / 2;\n                    // check if greater than 2^32 -1\n                    if (pesDts > 4294967295) {\n                        // decrement 2^33\n                        pesDts -= 8589934592;\n                    }\n                } else {\n                    pesDts = pesPts;\n                }\n\n            pesHdrLen = frag[2];\n            payloadStartOffset = pesHdrLen + 9;\n\n            // TODO: normalize pts/dts\n            return {offset: payloadStartOffset, pts: pesPts, dts: pesDts};\n        } else {\n            return null;\n        }\n    }\n    \n    feed(frag, shouldParse) {\n\n        let res = null;\n        if (shouldParse && this.fragments.length) {\n            if (!this.parseHeader()) {\n                throw new Error(\"Invalid PES packet\");\n            }\n\n            let offset = 6;\n            let parsed = {};\n            if (this.extPresent) {\n                // TODO: make sure fragment have necessary length\n                parsed = this.parseExtension(this.fragments[0].subarray(6));\n                offset = parsed.offset;\n            }\n            if (!this.pesPkt) {\n                this.pesPkt = new Uint8Array(this.pesLength);\n            }\n\n            let poffset = 0;\n            while (this.pesLength && this.fragments.length) {\n                let data = this.fragments.shift();\n                if (offset) {\n                    if (data.byteLength < offset) {\n                        offset -= data.byteLength;\n                        continue;\n                    } else {\n                        data = data.subarray(offset);\n                        this.pesLength -= offset - (this.hasLength?6:0);\n                        offset = 0;\n                    }\n                }\n                this.pesPkt.set(data, poffset);\n                poffset += data.byteLength;\n                this.pesLength -= data.byteLength;\n            }\n            res = {data:this.pesPkt, pts: parsed.pts, dts: parsed.dts};\n        } else {\n            this.pesPkt = null;\n        }\n        this.pesLength += frag.byteLength;\n\n        if (this.fragments.length && this.fragments[this.fragments.length-1].byteLength < 6) {\n            this.fragments[this.fragments.length-1] = appendByteArray(this.fragments[0], frag);\n        } else {\n            this.fragments.push(frag);\n        }\n\n        return res;\n    }\n}","import {BitArray} from '../util/binary.js';\nimport {PESAsm} from './pes.js';\nimport {PayloadType} from '../defs.js';\n\nexport class PESType {\n    static get AAC() {return  0x0f;}  // ISO/IEC 13818-7 ADTS AAC (MPEG-2 lower bit-rate audio)\n    static get ID3() {return  0x15;}  // Packetized metadata (ID3)\n    static get H264() {return  0x1b;}  // ITU-T Rec. H.264 and ISO/IEC 14496-10 (lower bit-rate video)\n}\n\nexport class TSParser {\n    static get PACKET_LENGTH() {return  188;}\n\n    constructor() {\n        this.pmtParsed = false;\n        this.pesParserTypes = new Map();\n        this.pesParsers = new Map();\n        this.pesAsms = {};\n        this.ontracks = null;\n        this.toSkip = 0;\n    }\n\n    addPesParser(pesType, constructor) {\n        this.pesParserTypes.set(pesType, constructor);\n    }\n\n    parse(packet) {\n        let bits = new BitArray(packet);\n        if (packet[0] === 0x47) {\n            bits.skipBits(9);\n            let payStart = bits.readBits(1);\n            bits.skipBits(1);\n            let pid = bits.readBits(13);\n            bits.skipBits(2);\n            let adaptFlag = bits.readBits(1);\n            let payFlag = bits.readBits(1);\n            bits.skipBits(4);\n            if (adaptFlag) {\n                let adaptSize = bits.readBits(8);\n                this.toSkip = bits.skipBits(adaptSize*8);\n                if (bits.finished()) {\n                    return;\n                }\n            }\n            if (!payFlag) return;\n\n            let payload = packet.subarray(bits.bytepos);//bitSlice(packet, bits.bitpos+bits.bytepos*8);\n\n            if (this.pmtParsed && this.pesParsers.has(pid)) {\n                let pes = this.pesAsms[pid].feed(payload, payStart);\n                if (pes) {\n                    return this.pesParsers.get(pid).parse(pes);\n                }\n            } else {\n                if (pid === 0) {\n                    this.pmtId = this.parsePAT(payload);\n                } else if (pid === this.pmtId) {\n                    this.parsePMT(payload);\n                    this.pmtParsed = true;\n                }\n            }\n        }\n        return null;\n    }\n\n    parsePAT(data) {\n        let bits = new BitArray(data);\n        let ptr = bits.readBits(8);\n        bits.skipBits(8*ptr+83);\n        return bits.readBits(13);\n    }\n\n    parsePMT(data) {\n        let bits = new BitArray(data);\n        let ptr = bits.readBits(8);\n        bits.skipBits(8*ptr + 8);\n        bits.skipBits(6);\n        let secLen = bits.readBits(10);\n        bits.skipBits(62);\n        let pil = bits.readBits(10);\n        bits.skipBits(pil*8);\n\n        let tracks = new Set();\n        let readLen = secLen-13-pil;\n        while (readLen>0) {\n            let pesType = bits.readBits(8);\n            bits.skipBits(3);\n            let pid = bits.readBits(13);\n            bits.skipBits(6);\n            let il = bits.readBits(10);\n            bits.skipBits(il*8);\n            if ([PESType.AAC, PESType.H264].includes(pesType)) {\n                if (this.pesParserTypes.has(pesType) && !this.pesParsers.has(pid)) {\n                    this.pesParsers.set(pid, new (this.pesParserTypes.get(pesType)));\n                    this.pesAsms[pid] = new PESAsm();\n                    switch (pesType) {\n                        case PESType.H264: tracks.add({type: PayloadType.H264, offset: 0});break;\n                        case PESType.AAC: tracks.add({type: PayloadType.AAC, offset: 0});break;\n                    }\n                }\n            }\n            readLen -= 5+il;\n        }\n        // TODO: notify about tracks\n        if (this.ontracks) {\n            this.ontracks(tracks);\n        }\n    }\n}","import {NALUAsm} from \"../../core/elementary/NALUAsm.js\";\nimport {NALU} from \"../../core/elementary/NALU.js\";\nimport {appendByteArray} from \"../../core/util/binary.js\";\nimport {StreamType, PayloadType} from '../../core/defs.js';\n\nexport class AVCPES {\n    constructor() {\n        this.naluasm = new NALUAsm();\n        this.lastUnit = null;\n    }\n\n    parse(pes) {\n        let array = pes.data;\n        let i = 0, len = array.byteLength, value, overflow, state = 0;\n        let units = [], lastUnitStart;\n        while (i < len) {\n            value = array[i++];\n            // finding 3 or 4-byte start codes (00 00 01 OR 00 00 00 01)\n            switch (state) {\n                case 0:\n                    if (value === 0) {\n                        state = 1;\n                    }\n                    break;\n                case 1:\n                    if( value === 0) {\n                        state = 2;\n                    } else {\n                        state = 0;\n                    }\n                    break;\n                case 2:\n                case 3:\n                    if( value === 0) {\n                        state = 3;\n                    } else if (value === 1 && i < len) {\n                        if (lastUnitStart) {\n                            let nalu = this.naluasm.onNALUFragment(array.subarray(lastUnitStart, i - state - 1), pes.dts);\n                            if (nalu && (nalu.type() in NALU.TYPES)) {\n                                units.push(nalu);\n                            }\n                        } else {\n                            // If NAL units are not starting right at the beginning of the PES packet, push preceding data into previous NAL unit.\n                            overflow  = i - state - 1;\n                            if (overflow) {\n                                if (this.lastUnit) {\n                                    this.lastUnit.data = appendByteArray(this.lastUnit.data.byteLength, array.subarray(0, overflow));\n                                }\n                            }\n                        }\n                        lastUnitStart = i;\n                        state = 0;\n                    } else {\n                        state = 0;\n                    }\n                    break;\n                default:\n                    break;\n            }\n        }\n        if (lastUnitStart) {\n            let nalu = this.naluasm.onNALUFragment(array.subarray(lastUnitStart, len), pes.dts, pes.pts);\n            if (nalu) {\n                units.push(nalu);\n            }\n        }\n        this.lastUnit = units[units.length-1];\n        return {units: units, type: StreamType.VIDEO, pay: PayloadType.H264};\n    }\n}","import {BitArray} from '../../core/util/binary.js';\nimport {AACParser} from '../../core/parsers/aac.js';\n\nexport class ADTS {\n\n    static parseHeader(data) {\n        let bits = new BitArray(data);\n        bits.skipBits(15);\n        let protectionAbs = bits.readBits(1);\n        bits.skipBits(14);\n        let len = bits.readBits(13);\n        bits.skipBits(11);\n        let cnt = bits.readBits(2);\n        if (!protectionAbs) {\n            bits.skipBits(16);\n        }\n        return {size: len-bits.bytepos, frameCount: cnt, offset: bits.bytepos}\n    }\n\n    static parseHeaderConfig(data) {\n        let bits = new BitArray(data);\n        bits.skipBits(15);\n        let protectionAbs = bits.readBits(1);\n        let profile = bits.readBits(2) + 1;\n        let freq = bits.readBits(4);\n        bits.skipBits(1);\n        let channels = bits.readBits(3);\n        bits.skipBits(4);\n        let len = bits.readBits(13);\n        bits.skipBits(11);\n        let cnt = bits.readBits(2);\n        if (!protectionAbs) {\n            bits.skipBits(16);\n        }\n\n        let userAgent = navigator.userAgent.toLowerCase();\n        let configLen = 4;\n        let extSamplingIdx;\n\n        // firefox: freq less than 24kHz = AAC SBR (HE-AAC)\n        if (userAgent.indexOf('firefox') !== -1) {\n            if (freq >= 6) {\n                profile = 5;\n                configLen = 4;\n                // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n                // there is a factor 2 between frame sample rate and output sample rate\n                // multiply frequency by 2 (see table below, equivalent to substract 3)\n                extSamplingIdx = freq - 3;\n            } else {\n                profile = 2;\n                configLen = 2;\n                extSamplingIdx = freq;\n            }\n            // Android : always use AAC\n        } else if (userAgent.indexOf('android') !== -1) {\n            profile = 2;\n            configLen = 2;\n            extSamplingIdx = freq;\n        } else {\n            /*  for other browsers (chrome ...)\n             always force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)\n             */\n            profile = 5;\n            configLen = 4;\n            // if (manifest codec is HE-AAC or HE-AACv2) OR (manifest codec not specified AND frequency less than 24kHz)\n            if (freq >= 6) {\n                // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n                // there is a factor 2 between frame sample rate and output sample rate\n                // multiply frequency by 2 (see table below, equivalent to substract 3)\n                extSamplingIdx = freq - 3;\n            } else {\n                // if (manifest codec is AAC) AND (frequency less than 24kHz OR nb channel is 1) OR (manifest codec not specified and mono audio)\n                // Chrome fails to play back with AAC LC mono when initialized with HE-AAC.  This is not a problem with stereo.\n                if (channels === 1) {\n                    profile = 2;\n                    configLen = 2;\n                }\n                extSamplingIdx = freq;\n            }\n        }\n\n\n        let config = new Uint8Array(configLen);\n\n        config[0] = profile << 3;\n        // samplingFrequencyIndex\n        config[0] |= (freq & 0x0E) >> 1;\n        config[1] |= (freq & 0x01) << 7;\n        // channelConfiguration\n        config[1] |= channels << 3;\n        if (profile === 5) {\n            // adtsExtensionSampleingIndex\n            config[1] |= (extSamplingIdx & 0x0E) >> 1;\n            config[2] = (extSamplingIdx & 0x01) << 7;\n            // adtsObjectType (force to 2, chrome is checking that object type is less than 5 ???\n            //    https://chromium.googlesource.com/chromium/src.git/+/master/media/formats/mp4/aac.cc\n            config[2] |= 2 << 2;\n            config[3] = 0;\n        }\n        return {\n            config: {\n                config: config,\n                codec: `mp4a.40.${profile}`,\n                samplerate: AACParser.SampleRates[freq],\n                channels: channels,\n            },\n            size: len-bits.bytepos,\n            frameCount: cnt,\n            offset: bits.bytepos\n        };\n    }\n}","import {Log} from '../../deps/bp_logger.js';\nimport {ADTS} from './adts.js';\nimport {StreamType, PayloadType} from '../../core/defs.js';\nimport {AACFrame} from '../../core/elementary/AACFrame.js';\n\nexport class AACPES {\n    constructor() {\n        this.aacOverFlow = null;\n        this.lastAacPTS = null;\n        this.track = {};\n        this.config = null;\n    }\n\n    parse(pes) {\n            let data = pes.data;\n            let pts = pes.pts;\n            let startOffset = 0;\n            let aacOverFlow = this.aacOverFlow;\n            let lastAacPTS = this.lastAacPTS;\n            var config, frameDuration, frameIndex, offset, stamp, len;\n\n        if (aacOverFlow) {\n            var tmp = new Uint8Array(aacOverFlow.byteLength + data.byteLength);\n            tmp.set(aacOverFlow, 0);\n            tmp.set(data, aacOverFlow.byteLength);\n            Log.debug(`AAC: append overflowing ${aacOverFlow.byteLength} bytes to beginning of new PES`);\n            data = tmp;\n        }\n\n        // look for ADTS header (0xFFFx)\n        for (offset = startOffset, len = data.length; offset < len - 1; offset++) {\n            if ((data[offset] === 0xff) && (data[offset+1] & 0xf0) === 0xf0) {\n                break;\n            }\n        }\n        // if ADTS header does not start straight from the beginning of the PES payload, raise an error\n        if (offset) {\n            var reason, fatal;\n            if (offset < len - 1) {\n                reason = `AAC PES did not start with ADTS header,offset:${offset}`;\n                fatal = false;\n            } else {\n                reason = 'no ADTS header found in AAC PES';\n                fatal = true;\n            }\n            Log.error(reason);\n            if (fatal) {\n                return;\n            }\n        }\n\n        let hdr = null;\n        let res = {units:[], type: StreamType.AUDIO, pay: PayloadType.AAC};\n        if (!this.config) {\n            hdr = ADTS.parseHeaderConfig(data.subarray(offset));\n            this.config = hdr.config;\n            res.config = hdr.config;\n            hdr.config = null;\n            Log.debug(`parsed codec:${this.config.codec},rate:${this.config.samplerate},nb channel:${this.config.channels}`);\n        }\n        frameIndex = 0;\n        frameDuration = 1024 * 90000 / this.config.samplerate;\n\n        // if last AAC frame is overflowing, we should ensure timestamps are contiguous:\n        // first sample PTS should be equal to last sample PTS + frameDuration\n        if(aacOverFlow && lastAacPTS) {\n            var newPTS = lastAacPTS+frameDuration;\n            if(Math.abs(newPTS-pts) > 1) {\n                Log.debug(`AAC: align PTS for overlapping frames by ${Math.round((newPTS-pts)/90)}`);\n                pts=newPTS;\n            }\n        }\n\n        while ((offset + 5) < len) {\n            if (!hdr) {\n                hdr = ADTS.parseHeader(data.subarray(offset));\n            }\n            if ((hdr.size > 0) && ((offset + hdr.offset + hdr.size) <= len)) {\n                stamp = pts + frameIndex * frameDuration;\n                res.units.push(new AACFrame(data.subarray(offset + hdr.offset, offset + hdr.offset + hdr.size), stamp));\n                offset += hdr.offset + hdr.size;\n                frameIndex++;\n                // look for ADTS header (0xFFFx)\n                for ( ; offset < (len - 1); offset++) {\n                    if ((data[offset] === 0xff) && ((data[offset + 1] & 0xf0) === 0xf0)) {\n                        break;\n                    }\n                }\n            } else {\n                break;\n            }\n            hdr = null;\n        }\n        if ((offset < len) && (data[offset]==0xff)) {   // TODO: check it\n            aacOverFlow = data.subarray(offset, len);\n            //logger.log(`AAC: overflow detected:${len-offset}`);\n        } else {\n            aacOverFlow = null;\n        }\n        this.aacOverFlow = aacOverFlow;\n        this.lastAacPTS = stamp;\n\n        return res;\n    }\n}","// adapted from https://github.com/kanongil/node-m3u8parse/blob/master/attrlist.js\nclass AttrList {\n\n    constructor(attrs) {\n        if (typeof attrs === 'string') {\n            attrs = AttrList.parseAttrList(attrs);\n        }\n        for(var attr in attrs){\n            if(attrs.hasOwnProperty(attr)) {\n                this[attr] = attrs[attr];\n            }\n        }\n        this.attrs = attrs;\n    }\n\n    decimalInteger(attrName) {\n        const intValue = parseInt(this[attrName], 10);\n        if (intValue > Number.MAX_SAFE_INTEGER) {\n            return Infinity;\n        }\n        return intValue;\n    }\n\n    hexadecimalInteger(attrName) {\n        if(this[attrName]) {\n            let stringValue = (this[attrName] || '0x').slice(2);\n            stringValue = ((stringValue.length & 1) ? '0' : '') + stringValue;\n\n            const value = new Uint8Array(stringValue.length / 2);\n            for (let i = 0; i < stringValue.length / 2; i++) {\n                value[i] = parseInt(stringValue.slice(i * 2, i * 2 + 2), 16);\n            }\n            return value;\n        } else {\n            return null;\n        }\n    }\n\n    hexadecimalIntegerAsNumber(attrName) {\n        const intValue = parseInt(this[attrName], 16);\n        if (intValue > Number.MAX_SAFE_INTEGER) {\n            return Infinity;\n        }\n        return intValue;\n    }\n\n    decimalFloatingPoint(attrName) {\n        return parseFloat(this[attrName]);\n    }\n\n    enumeratedString(attrName) {\n        return this[attrName];\n    }\n\n    decimalResolution(attrName) {\n        const res = /^(\\d+)x(\\d+)$/.exec(this[attrName]);\n        if (res === null) {\n            return undefined;\n        }\n        return {\n            width: parseInt(res[1], 10),\n            height: parseInt(res[2], 10)\n        };\n    }\n\n    static parseAttrList(input) {\n        const re = /\\s*(.+?)\\s*=((?:\\\".*?\\\")|.*?)(?:,|$)/g;\n        var match, attrs = {};\n        while ((match = re.exec(input)) !== null) {\n            var value = match[2], quote = '\"';\n\n            if (value.indexOf(quote) === 0 &&\n                value.lastIndexOf(quote) === (value.length-1)) {\n                value = value.slice(1, -1);\n            }\n            attrs[match[1]] = value;\n        }\n        return attrs;\n    }\n\n}\n\nexport class M3U8Parser {\n    static get TYPE_CHUNK() {return  0;}\n    static get TYPE_PLAYLIST() {return  1;}\n    // TODO: parse master playlists\n    static parse(playlist, baseUrl='') {\n        playlist = playlist.replace(/\\r/, '').split('\\n');\n        if (playlist.shift().indexOf('#EXTM3U') < 0) {\n            throw new Error(\"Bad playlist\");\n        }\n        let chunkList = [];\n        let playlistList = [];\n        let expectedUrl = false;\n        let cont = {};\n        let urlType=null;\n        while (playlist.length) {\n            let entry = playlist.shift().replace(/\\r/, '');\n            if (expectedUrl) {\n                if (entry) {\n                    cont.url = entry.startsWith('http')?entry:`${baseUrl}/${entry}`;\n                    switch (urlType) {\n                        case M3U8Parser.TYPE_CHUNK:\n                            chunkList.push(cont);\n                            break;\n                        case M3U8Parser.TYPE_PLAYLIST:\n                            playlistList.push(cont);\n                            break;\n                    }\n                    cont={};\n                    expectedUrl = false;\n                }\n            } else {\n                if (entry.startsWith('#EXTINF')) {\n                    // TODO: it's unsafe\n                    cont.duration = Number(entry.split(':')[1].split(',')[0]);\n                    urlType = M3U8Parser.TYPE_CHUNK;\n                    expectedUrl = true;\n                } else if (entry.startsWith('#EXT-X-STREAM-INF')){\n                    let props = entry.split(':')[1];\n                    let al = new AttrList(props);\n                    for (let prop in al.attrs) {\n                        cont[prop.toLowerCase()]= al.attrs[prop];\n                    }\n                    urlType = M3U8Parser.TYPE_PLAYLIST;\n                    expectedUrl = true;\n                }\n            }\n        }\n        return {chunks: chunkList, playlists: playlistList}\n    }\n}","import {getTagged} from '../../deps/bp_logger.js';\nimport {BaseClient} from '../../core/base_client.js';\nimport {TSParser, PESType} from '../../core/parsers/ts.js';\nimport {AVCPES} from '../../client/hls/pes_avc.js';\nimport {AACPES} from '../../client/hls/pes_aac.js';\nimport {StreamType} from '../../core/defs.js';\nimport {M3U8Parser} from '../../core/parsers/m3u8.js';\nimport {CPU_CORES} from '../../core/util/browser.js';\n\nconst LOG_TAG = \"client:hls\";\nconst Log = getTagged(LOG_TAG);\n\n\nexport default class HLSClient extends BaseClient {\n    static get CHUNKS_TO_LOAD() {return  CPU_CORES;}\n\n    constructor(transport, options) {\n        super(transport, options);\n\n        this.parser = new TSParser();\n        this.parser.addPesParser(PESType.H264, AVCPES);\n        this.parser.addPesParser(PESType.AAC, AACPES);\n        this.parser.ontracks = (tracks)=>{\n            let duration = 0;\n            for (let chunk of this.chunks) {\n                duration+=chunk.duration;\n            }\n            for (let track of tracks) {\n                track.duration = duration;\n                this.sampleQueues[track.type]=[];\n            }\n\n            this.eventSource.dispatchEvent('tracks', tracks);\n            this.startStreamFlush();\n        };\n\n        this.playlists = [];\n        this.chunks = [];\n        this.loadedChunks = [];\n        this.pendingChunks = new Set();\n        this.chunkIdx = 0;\n        this.seqMap = new Map();\n        this.sampleQueues = {};\n        this.chunkSeq = new Map();\n\n        this.eventSource.addEventListener('needData', this.loadChunks.bind(this, HLSClient.CHUNKS_TO_LOAD));\n        this.resume = false;\n\n        this.parsing = false;\n    }\n\n    static streamType() {\n        return 'hls';\n    }\n\n    parse(data) {\n        let seq = new DataView(data.buffer, data.byteOffset, 4).getUint32(0);\n        // console.log(`data for ${seq}`);\n        // console.log('begin parse');\n        let offset = 4;\n        while (offset < data.byteLength) {\n            let parsed = this.parser.parse(data.subarray(offset, offset + TSParser.PACKET_LENGTH));\n            if (parsed) {\n                if (parsed.config) {\n                    this.eventSource.dispatchEvent(`${StreamType.map[parsed.type]}_config`, {\n                        config: parsed.config,\n                        pay: parsed.pay\n                    });\n                }\n                this.sampleQueues[parsed.type].push(parsed.units);\n                this.eventSource.dispatchEvent('samples', {pay: parsed.pay});\n            }\n            offset += TSParser.PACKET_LENGTH;\n        }\n        // this.eventSource.dispatchEvent('flush');\n        // console.log('end parse');\n        this.parsing = false;\n        if (this.loadedChunks.length) {\n            this.onData(this.loadedChunks.shift());\n        }\n    }\n\n    checkSeq(seq, data) {\n        seq = Number(seq);\n        if (this.seqMap.has(seq)) {\n            // parse data\n            let cs = this.chunkSeq.get(seq);\n            this.pendingChunks.delete(cs.idx);\n            this.chunkSeq.delete(seq);\n            this.parse(data?data:this.seqMap.get(seq));\n            this.seqMap.delete(seq);\n            cs.promise.resolve();\n        } else {\n            this.seqMap.set(seq, data);\n        }\n    }\n\n    onData(data) {\n        if (this.parsing) {\n            this.loadedChunks.push(data);\n        } else {\n            this.parsing = true;\n            let seq = new DataView(data.buffer, data.byteOffset, 4).getUint32(0);\n            // TODO: store seq & check if data ready\n            this.checkSeq(seq, data);\n        }\n    }\n\n    onConnected() {\n        super.onConnected();\n        Log.debug('HLS connected');\n        if (!this.paused) {\n            this.start();\n        }\n    }\n\n    onDisconnected() {\n        super.onDisconnected();\n        Log.debug('HLS disconnected');\n        this.parsing = false;\n        this.seqMap.clear();\n        this.chunkSeq.clear();\n        // this.stop();\n    }\n\n    start() {\n        super.start();\n        if (this.resume) {\n            this.eventSource.dispatchEvent('needData');\n        } else {\n            this.resume = true;\n            this.eventSource.dispatchEvent('clear');\n            Log.debug('waiting for transport ready');\n            this.transport.ready.then(()=> {\n                Log.debug('loading playlist');\n                this.loadPlaylist();\n            }).catch((e)=>{\n                Log.debug('reject transport', e);\n            });\n        }\n    }\n\n    stop() {\n        super.stop();\n    }\n\n    setSource(source) {\n        this.resume = false;\n        super.setSource(source);\n    }\n\n    send(request, beforeSend) {\n        try {\n            return this.transport.send(request, beforeSend);\n        } catch (e) {\n            Log.error(e);\n            this.onDisconnected();\n            this.transport.connect();\n            return Promise.reject();\n        }\n    }\n\n    loadPlaylist(playlist=null) {\n        let url = playlist?playlist.url:this.sourceUrl;\n        this.send(`GET ${url} HTTP/1.1\\r\\nHost: ${this.transport.endpoint.host}\\r\\n\\r\\n`).then((data)=>{\n            let entries = data.payload.split('\\r\\n\\r\\n');\n            let http = entries[0].split('\\r\\n');\n            let status = http[0].match(new RegExp(`HTTP/\\\\d\\\\.\\\\d\\\\s+(\\\\d+)\\\\s+(\\\\w+)`));\n            if (!status || status[1]>=400) {\n                Log.error('bad playlist response');\n                return;\n            }\n            Log.debug(status);\n            let baseUrl = url.substr(0, url.lastIndexOf('/'));\n            let playlist = M3U8Parser.parse(entries[1], baseUrl);\n            if (playlist.chunks.length) {\n                this.chunks = playlist.chunks;\n                this.resume = true;\n                // Load first chunk to detect initial timestamps\n                this.loadChunks(1);\n            } else if (playlist.playlists) {\n                this.playlists = playlist.playlists;\n                // TODO: check playlist support\n                this.loadPlaylist(this.playlists[0])\n            }\n            // this.chunks = entries[1].split('\\n').map((e)=>{e.replace(/\\r/, ''); return e;});\n            // this.loadChunk();\n        }).catch((e)=>{\n            this.resume = false;\n        });\n    }\n\n    loadChunk(chunk, idx) {\n        return new Promise((resolve, reject)=>{\n            this.send(`GET ${chunk.url}?${Math.random()} HTTP/1.1\\r\\nHost: ${this.transport.endpoint.host}\\r\\n\\r\\n`, (seq)=>{\n                this.chunkSeq.set(seq, {\n                    idx: idx,\n                    promise: {resolve, reject}\n                });\n            }).then((res)=>{\n                let lines = res.payload.split('\\r\\n');\n                let [version, code, msg] = lines[0].split(' ');\n                if (Number(code) >= 300) {\n                    throw new Error(`Load error: ${code} ${msg}`);\n                }\n\n                // TODO: store seq & check if data ready\n                this.checkSeq(res.data.seq, null);\n            });\n        });\n    }\n\n    loadChunks(count) {\n        if (this.chunkIdx>= this.chunks.length) return;\n        let promises = [];\n        if (this.pendingChunks.size) {\n            Log.debug(`Reload chunks: ${Array.from(this.pendingChunks)}`);\n            for (let i of this.pendingChunks) {\n                let chunk = this.chunks[i];\n                Log.log(`Loading ${chunk.url} (${i+1} of ${this.chunks.length})`);\n                promises.push(this.loadChunk(chunk, i));\n            }\n        } else {\n            for (let i = this.chunkIdx; i < this.chunkIdx+count; ++i) {\n                let chunk = this.chunks[i];//.shift();\n                Log.log(`Loading ${chunk.url} (${i+1} of ${this.chunks.length})`);\n                this.pendingChunks.add(i);\n\n                promises.push(this.loadChunk(chunk, i));\n                if (i+1 >= this.chunks.length) return;\n            }\n        }\n        return Promise.all(promises).then(()=>{\n            Log.log('chunk loaded');\n            // TODO: check queue overflow\n            this.chunkIdx+=HLSClient.CHUNKS_TO_LOAD;\n            if (!this.paused) {\n                this.eventSource.dispatchEvent('needData');\n            }\n        }).catch((e)=>{\n            Log.error(e);\n            // this.stop();\n        });\n    }\n}","import videojs from 'video.js';\nimport * as streamedian from '../../../src/player';\nimport WebsocketTransport from '../../../src//transport/websocket';\nimport RTSPClient from '../../../src//client/rtsp/client';\nimport HLSClient from '../../../src//client/hls/client';\n\nclass StreamedianVideojs{\n\n    constructor(source, tech, techOptions){\n\n        var player = videojs.getPlayer(techOptions.playerId);\n        this.playerOptions = player.options_;\n        this.tech    = tech;\n\n        this.transport = {\n            constructor: WebsocketTransport,\n            options: {\n                socket: this.playerOptions.rtsp_config.websocket_url\n            }\n        };\n        this.player = new streamedian.WSPlayer(tech.el(), {\n            modules: [\n                {\n                    client: RTSPClient,\n                    transport: this.transport\n                },\n                {\n                    client: HLSClient,\n                    transport: this.transport\n                }\n            ]\n        });\n    }\n}\n\nvar StreamedianSourceHandler = {\n    canHandleSource: function (source) {\n        return this.canPlayType(source.type);\n    },\n    handleSource: function (source, tech, options) {\n        return new StreamedianVideojs(source, tech, options);\n    },\n    canPlayType: function (type) {\n        var canPlayType = '';\n        if (streamedian.WSPlayer.canPlayWithModules(type,[\n                {\n                    client: RTSPClient,\n                    transport: WebsocketTransport\n                },\n                {\n                    client: HLSClient,\n                    transport: WebsocketTransport\n                }\n            ])) {\n            canPlayType = 'probably';\n        }\n        return canPlayType;\n    }\n};\n\nvideojs.getTech('Html5').registerSourceHandler(StreamedianSourceHandler, 0);"],"names":["LogLevel","Error","Warn","Log","Debug","DEFAULT_LOG_LEVEL","Logger","level","tag","setLevel","lvl","args","Array","prototype","slice","call","unshift","console","level_map","apply","_log","arguments","taggedLoggers","Map","getTagged","has","set","get","Url","url","ret","regex","result","exec","full","protocol","urlpath","parts","split","basename","pop","basepath","join","loginSplit","hostport","userpass","length","user","pass","host","auth","port","protocolDefaultPort","portDefined","location","socket","undefined","parsed","test","listener","Symbol","listeners","DestructibleEventListener","eventListener","entry","fn","removeEventListener","clear","event","selector","addEventListener","e","target","matches","Set","add","ev","delete","size","dispatchEvent","EventEmitter","element","document","createElement","destroy","on","data","CustomEvent","detail","EventSourceWrapper","eventSource","MP4","types","avc1","avcC","btrt","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","sdtp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trun","trex","tkhd","vmhd","smhd","i","hasOwnProperty","charCodeAt","videoHdlr","Uint8Array","audioHdlr","HDLR_TYPES","STTS","STSC","STCO","STSZ","VMHD","SMHD","STSD","majorBrand","avc1Brand","minorVersion","FTYP","box","DINF","type","payload","len","byteLength","timescale","duration","track","sequenceNumber","sn","baseMediaDecodeTime","tracks","boxes","concat","bytes","samples","flags","dependsOn","isDependedOn","hasRedundancy","sps","pps","push","avcc","width","height","configlen","config","audiosamplerate","channelCount","id","volume","sampleDependencyTable","offset","arraylen","array","sample","cts","isLeading","paddingValue","isNonSync","degradPrio","init","movie","LOG_TAG","MSEBuffer","parent","codec","mediaSource","players","cleaning","queue","cleanResolvers","cleanRanges","debug","sourceBuffer","addSourceBuffer","buffered","currentTime","start","resolver","shift","doCleanup","feedNext","readyState","sourceBuffers","removeSourceBuffer","updating","promises","Promise","resolve","reject","remove","end","onupdateend","all","is_live","doAppend","range","removeBound","removeStart","removeEnd","err","error","MSE","ErrorNotes","code","forEach","video","stop","endOfStream","appendBuffer","name","initCleanup","message","codecs","window","MediaSource","isTypeSupported","MediaError","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","playing","map","idx","onplaying","onpause","paused","reset","play","buffers","setLive","pause","values","buffer","then","clearLiveSeekableRange","src","URL","createObjectURL","setupEvents","resolved","mediaReady","_sourceOpen","_sourceEnded","_sourceClose","ready","mimeCodec","feed","track_id","BaseRemuxer","scaleFactor","params","timeOffset","readyToDecode","seq","tsAlign","timestamp","unit","pts","dts","initPTS","initDTS","shouldInitialize","Math","min","unscaled","initialized","mp4track","sampleFunction","setupSample","sort","dtsSortFunc","a","b","AACRemuxer","codecstring","CODEC_AAC","units","nextAacPts","lastPts","firstDTS","firstPTS","getTrackID","fragmented","setConfig","channels","samplerate","MP4_TIMESCALE","expectedSampleDuration","aac","getSize","mp4Sample","lastDTS","nextDts","delta","round","scaled","abs","log","max","getData","ExpGolomb","bytesAvailable","word","bitsAvailable","position","workingBytes","availableBytes","subarray","DataView","byteOffset","getUint32","count","skipBytes","loadWord","bits","valu","logger","readBits","leadingZeroCount","skipLZ","skipBits","clz","readUEG","appendByteArray","buffer1","buffer2","tmp","base64ToArrayBuffer","base64","binary_string","atob","hexToByteArray","hex","bufView","parseInt","substr","bitSlice","bytearray","byteLen","ceil","res","startByte","endByte","bitOffset","nBitOffset","endOffset","tail","BitArray","bitpos","byte","getUint8","bytepos","finished","NALU","nalu","ntype","TYPES","IDR","SEI","SPS","PPS","NDR","nri","sliceType","idata","getNri","header","view","setUint32","setUint8","H264Parser","remuxer","firstFound","readSPS","codecarray","h","toString","parceSliceHeader","isKeyframe","parsePPS","parseSPS","byte_idx","pay_type","pay_size","sz","uuid","from","EOSEQ","EOSTR","decoder","first_mb","slice_type","ppsid","frame_num","readUByte","lastScale","nextScale","deltaScale","j","readEG","frameCropLeftOffset","frameCropRightOffset","frameCropTopOffset","frameCropBottomOffset","sarScale","profileIdc","profileCompat","levelIdc","numRefFramesInPicOrderCntCycle","picWidthInMbsMinus1","picHeightInMapUnitsMinus1","frameMbsOnlyFlag","scalingListCount","skipUEG","chromaFormatIdc","readBoolean","skipScalingList","picOrderCntType","skipEG","sarRatio","aspectRatioIdc","unitsInTick","readUInt","timeScale","fixedFrameRate","frameDuration","H264Remuxer","lastSampleDuration","lastDurations","lastGopDTS","gop","firstUnit","h264","arr","setSPS","warn","setPPS","_get","parseNAL","getPayloadBase","sampleDuration","toMS","avgDuration","reduce","navigator","userAgent","toLowerCase","indexOf","StreamType","VIDEO","AUDIO","PayloadType","H264","AAC","Remuxer","mediaElement","mse","mseEventSource","mse_ready","errorListener","mseClose","bind","closeListener","errorDecodeListener","mseErrorDecode","initSegments","streams","enabled","initMSEHandlers","detachClient","TrackConverters","TrackTimescale","TrackScaleFactor","client","seekable","initmse","initPts","Infinity","initDts","track_type","isSupported","initSegment","initMSE","setCodec","onSamples","Object","keys","pay","getPayload","flush","qidx","sampleQueues","chunk","remux","clientEventSource","samplesListener","audioConfigListener","onTracks","State","stateMachine","transitions","StateMachine","storage","currentState","states","activate","finishTransition","deactivate","state","fromName","toName","ReferenceError","promise","stateName","_promisify","catch","failHandler","SDPParser","version","origin","sessionName","timing","sessionBlock","media","mediaMap","content","dataString","success","currentMediaBlock","line","replace","charAt","_parseVersion","_parseOrigin","_parseSessionName","_parseTiming","rtpmap","_parseMediaDescription","_parseAttribute","match","username","sessionid","sessionversion","nettype","addresstype","unicastaddress","proto","fmt","index","mediaType","pt","m","separator","attribute","mode","Number","control","attrs","toUpperCase","clock","encparams","ptype","string_map","fmtp","param","trim","RTSPStream","rtpChannel","stopKeepAlive","keepaliveInterval","keepaliveTime","forgetRTPChannel","sendSetup","sendTeardown","sdp","getSessionBlock","isAbsolute","contentBase","ctrl","methods","includes","sendRequest","getSetupURL","session","clearInterval","setInterval","sendKeepalive","RTSPError","reconnect","_cmd","_params","assign","getControlURL","RTSPClient","STATE_SETUP","interleaveChannelIndex","interleavedChannels","Date","toUTCString","Session","_data","headers","transport","interleaved","sessionParamsChunks","sessionParams","kv","useRTPChannel","startKeepAlive","safeAdd","x","y","lsw","msw","bitRotateLeft","num","cnt","md5cmn","q","s","t","md5ff","c","d","md5gg","md5hh","md5ii","binlMD5","olda","oldb","oldc","oldd","binl2rstr","input","output","length32","String","fromCharCode","rstr2binl","length8","rstrMD5","rstrHMACMD5","key","bkey","ipad","opad","hash","rstr2hex","hexTab","str2rstrUTF8","unescape","encodeURIComponent","rawMD5","hexMD5","rawHMACMD5","k","hexHMACMD5","md5","string","raw","RTP","pkt","padding","has_extension","csrc","marker","sequence","getUint16","ssrc","csrcs","pktIndex","extension","ehl","header_data","headerLength","padLength","getMediaBlockByPayloadType","RTPFactory","tsOffsets","last","overflow","rtp","tsOffset","RTSPMessage","_rtsp_version","_host","_payload","requestString","lines","body","statusLine","RegExp","lineIdx","v","MessageBuilder","RTSP_1_0","NALUAsm","fragmented_nalu","rawData","nal_start_idx","don","STAP_B","parseNALHeader","getInt8","parseSingleNALUPacket","fu_header","is_start","is_end","payload_type","FU_B","appendData","FU_A","parseFragmentationUnit","STAP_A","parseAggregationPacket","hdr","AACFrame","AACAsm","sizeLength","indexLength","indexDeltaLength","CTSDeltaLength","DTSDeltaLength","RandomAccessIndication","StreamStateIndication","AuxiliaryDataSizeLength","configHeaderLength","auHeadersLengthPadded","ts","getTimestampMS","auHeadersLengthInBits","frames","frameOffset","ctsPresent","dtsPresent","aacData","RTPPayloadParser","h264parser","RTPH264Parser","aacparser","RTPAACParser","parse","naluasm","onNALUFragment","scale","asm","conf","onAACFragment","BaseClient","options","defineProperties","sourceUrl","value","writable","connected","_onData","dataQueue","onData","_onConnect","onConnected","_onDisconnect","onDisconnected","detachTransport","source","endpoint","flushInterval","password","AACParser","bytesOrBits","prof","sfi","SampleRates","parseAudioSpecificConfig","RTSPSession","sessionId","sendPlay","STATE_PLAY","STATE_PLAYING","supports","STATE_PAUSE","STATE_PAUSED","STATE_TEARDOWN","clientSM","RTSPClientSM","ontracks","startStreamFlush","setSource","AuthError","msg","payParser","rtp_channels","sessions","addState","STATE_INITIAL","STATE_OPTIONS","sendOptions","onOptions","STATE_DESCRIBE","sendDescribe","onDescribe","onSetup","STATE_STREAMS","started","transitionTo","addTransition","shouldReconnect","rtpFactory","channel","onRTP","packet","sendPause","authenticator","rtpBuffer","stream","lastTimestamp","method","cSeq","CSeq","USER_AGENT","send","build","_method","response","substring","chunks","ep","queryCredentials","parsedChunks","ha1","realm","ha2","nonce","btoa","getMediaBlockList","getMediaBlock","setupPromise","rtp_info","val","sps_pps","has_config","generic","parseStreamMuxConfig","sessionPromises","hardLimit","ellipsis","DOM","tagName","className","text","str","createTextNode","Stream","enc","pos","hexDigits","hexByte","high_byte","low_byte","parseStringISO","reTime","n","unusedBit","lenBit","skip","ASN1","sub","tagClass","tagConstructed","tagNumber","posContent","reSeemsASCII","parseOctetString","parseInteger","parseBitString","parseOID","parseStringUTF","parseStringBMP","parseTime","typeName","indent","writeln","print","toPrettyString","node","asn1","head","innerHTML","preview","appendChild","oids","oid","w","toDOM","onclick","current","re","hexDump","root","hexNode","onmouseover","onmouseout","selected","fakeHover","fakeOut","toHexDOM_sub","posStart","posEnd","first","toHexDOM","decodeLength","buf","hasContent","p","subTag","subLength","exception","decode","streamStart","expected","write","Arcfour","S","ARC4init","ARC4next","next","prng_newstate","rng_psize","rng_state","rng_pool","rng_pptr","crypto","getRandomValues","z","Uint32Array","onMouseMoveListener","detachEvent","mouseCoordinates","attachEvent","rng_get_byte","random","floor","rng_get_bytes","ba","SecureRandom","nextBytes","dbits","BigInteger","fromNumber","fromString","nbi","am1","am2","xl","xh","l","am3","j_lm","appName","am","DB","DM","DV","BI_FP","FV","pow","F1","F2","BI_RM","BI_RC","rr","vv","int2char","intAt","bnpCopyTo","r","bnpFromInt","nbv","fromInt","bnpFromString","fromRadix","mi","sh","clamp","ZERO","subTo","bnpClamp","bnToString","negate","toRadix","km","bnNegate","bnAbs","bnCompareTo","nbits","bnBitLength","bnpDLShiftTo","bnpDRShiftTo","bnpLShiftTo","bs","cbs","bm","ds","bnpRShiftTo","bnpSubTo","bnpMultiplyTo","bnpSquareTo","bnpDivRemTo","pm","copyTo","ms","nsh","lShiftTo","ys","y0","yt","d1","d2","dlShiftTo","compareTo","ONE","qd","drShiftTo","rShiftTo","bnMod","divRemTo","Classic","cConvert","mod","cRevert","cReduce","cMulTo","multiplyTo","cSqrTo","squareTo","convert","revert","mulTo","sqrTo","bnpInvDigit","Montgomery","mp","invDigit","mpl","mph","um","mt2","montConvert","montRevert","montReduce","u0","montSqrTo","montMulTo","bnpIsEven","bnpExp","r2","g","bnModPowInt","isEven","exp","bitLength","modPowInt","bnClone","bnIntValue","bnByteValue","bnShortValue","bnpChunkSize","LN2","bnSigNum","bnpToRadix","signum","cs","chunkSize","intValue","bnpFromRadix","dMultiply","dAddOffset","bnpFromNumber","testBit","bitwiseTo","shiftLeft","op_or","isProbablePrime","bnToByteArray","bnEquals","bnMin","bnMax","bnpBitwiseTo","op","f","op_and","bnAnd","bnOr","op_xor","bnXor","op_andnot","bnAndNot","bnNot","bnShiftLeft","bnShiftRight","lbit","bnGetLowestSetBit","cbit","bnBitCount","bnTestBit","bnpChangeBit","bnSetBit","changeBit","bnClearBit","bnFlipBit","bnpAddTo","bnAdd","addTo","bnSubtract","bnMultiply","bnSquare","bnDivide","bnRemainder","bnDivideAndRemainder","bnpDMultiply","bnpDAddOffset","NullExp","nNop","nMulTo","nSqrTo","bnPow","bnpMultiplyLowerTo","bnpMultiplyUpperTo","Barrett","q3","mu","divide","barrettConvert","barrettRevert","barrettReduce","multiplyUpperTo","multiplyLowerTo","barrettSqrTo","barrettMulTo","bnModPow","k1","g2","is1","bnGCD","clone","getLowestSetBit","bnpModInt","bnModInverse","ac","u","subtract","lowprimes","lplim","bnIsProbablePrime","modInt","millerRabin","bnpMillerRabin","n1","shiftRight","modPow","byteValue","shortValue","toByteArray","equals","and","or","xor","andNot","not","bitCount","setBit","clearBit","flipBit","multiply","remainder","divideAndRemainder","modInverse","gcd","square","parseBigInt","pkcs1pad2","rng","RSAKey","dmp1","dmq1","coeff","RSASetPublic","N","E","RSADoPublic","RSAEncrypt","doPublic","setPublic","encrypt","pkcs1unpad2","RSASetPrivate","D","RSASetPrivateEx","P","Q","DP","DQ","C","RSAGenerate","B","qs","ee","p1","q1","phi","RSADoPrivate","xp","xq","RSADecrypt","ctext","doPrivate","setPrivate","setPrivateEx","generate","decrypt","Base64","b64","ignore","out","char_count","unarmor","Hex","JSX","env","L","OP","FUNCTION_TOSTRING","ADD","parseUA","agent","numberify","parseFloat","nav","o","ie","opera","gecko","webkit","chrome","mobile","air","iphone","ipod","ios","android","webos","caja","cajaVersion","secure","os","ua","loc","href","isFunction","_IEEnumFix","fname","extend","subc","superc","overrides","F","constructor","superclass","KJUR","ASN1Util","integerToByteHex","bigIntToMinTwosComplementsHex","bigIntegerValue","hPos","xorLen","hMask","biMask","biNeg","getPEMStringFromHex","dataHex","pemHeader","dataWA","CryptoJS","dataB64","stringify","pemBody","ASN1Object","hV","getLengthHexFromValue","hN","hNlen","getEncodedHex","hTLV","isModified","getFreshValueHex","hL","hT","getValueHex","DERAbstractString","getString","setString","newS","stohex","setStringHex","newHexString","DERAbstractTime","localDateToUTC","utc","getTime","getTimezoneOffset","utcDate","formatDate","dateObject","pad","zeroPadding","year","getFullYear","month","getMonth","day","getDate","hour","getHours","getMinutes","sec","getSeconds","setByDateValue","UTC","setByDate","DERAbstractStructured","setByASN1ObjectArray","asn1ObjectArray","asn1Array","appendASN1Object","asn1Object","DERBoolean","DERInteger","setByBigInteger","setByInteger","bi","setValueHex","DERBitString","setHexValueIncludingUnusedBits","newHexStringIncludingUnusedBits","setUnusedBitsAndHexValue","unusedBits","hValue","hUnusedBits","setByBinaryString","binaryString","setByBooleanArray","booleanArray","newFalseArray","nLength","DEROctetString","DERNull","DERObjectIdentifier","itox","roidtox","roid","padLen","bPad","b8","setValueOidString","oidString","i0","splice","setValueName","oidName","x509","OID","name2oidList","DERUTF8String","DERNumericString","DERPrintableString","DERTeletexString","DERIA5String","DERUTCTime","date","DERGeneralizedTime","DERSequence","asn1Obj","DERSet","DERTaggedObject","isExplicit","setASN1Object","isExplicitFlag","tagNoHex","b64map","b64pad","hex2b64","b64tohex","slop","getHexStringValue","hexString","toHexString","parseKey","pem","modulus","public_exponent","reHex","der","private_exponent","prime1","prime2","exponent1","exponent2","coefficient","bit_string","ex","getPrivateBaseKey","getPrivateBaseKeyB64","getPublicBaseKey","first_sequence","second_sequence","getPublicBaseKeyB64","wordwrap","getPrivateKey","getPublicKey","hasPublicKeyProperty","obj","hasPrivateKeyProperty","parsePropertiesFrom","JSEncryptRSAKey","JSEncrypt","default_key_size","default_public_exponent","setKey","setPrivateKey","privkey","setPublicKey","pubkey","getKey","cb","generateAsync","getPrivateKeyB64","getPublicKeyB64","BaseRequest","before","BaseTransport","stream_type","disconnect","connect","streamTypes","isSafari","CPU_CORES","WebsocketTransport","workers","proxies","currentProxy","socket_url","proxy","WebSocketProxy","set_disconnect_handler","reason","setTimeout","set_data_handler","close","WSPProtocol","ver","cmd","data_str","PROTO","payIdx","V1_1","wsurl","data_handler","disconnect_handler","builder","awaitingPromises","encryptor","handler","ctrlChannel","onclose","dataChannel","channel_id","WebSocket","CHN_DATA","binaryType","onopen","CMD_JOIN","onmessage","onerror","onDisconnect","encryptionKey","CHN_CONTROL","CMD_INIT","initDataChannel","crypted","OPEN","contentLength","CMD_WRAP","HLS","RTSP","mime","WSPlayer","opts","player","getElementById","modules","DEFAULT_CLIENT","DEFAULT_TRANSPORT","errorHandler","module","canTransfer","streamType","_checkSource","children","isPlaying","fromUrl","dataset","canPlayType","fromMime","lastType","attachClient","attachTransport","autoplay","mimeType","filteredModules","resource","PESAsm","fragments","pesLength","pesPkt","frag","extPresent","ext","parseExtension","pesPrefix","hasLength","pesFlags","pesHdrLen","pesPts","pesDts","payloadStartOffset","shouldParse","parseHeader","poffset","reference","PESType","TSParser","pmtParsed","pesParserTypes","pesParsers","pesAsms","toSkip","pesType","payStart","pid","adaptFlag","payFlag","adaptSize","pes","pmtId","parsePAT","parsePMT","ptr","secLen","pil","readLen","il","AVCPES","lastUnit","lastUnitStart","ADTS","protectionAbs","frameCount","profile","freq","configLen","extSamplingIdx","AACPES","aacOverFlow","lastAacPTS","startOffset","frameIndex","stamp","fatal","parseHeaderConfig","newPTS","AttrList","parseAttrList","attr","attrName","MAX_SAFE_INTEGER","stringValue","quote","lastIndexOf","M3U8Parser","playlist","baseUrl","chunkList","playlistList","expectedUrl","cont","urlType","startsWith","TYPE_CHUNK","TYPE_PLAYLIST","props","al","prop","playlists","HLSClient","parser","addPesParser","loadedChunks","pendingChunks","chunkIdx","seqMap","chunkSeq","loadChunks","CHUNKS_TO_LOAD","resume","parsing","PACKET_LENGTH","checkSeq","loadPlaylist","request","beforeSend","entries","http","status","loadChunk","StreamedianVideojs","tech","techOptions","videojs","getPlayer","playerId","playerOptions","options_","rtsp_config","websocket_url","streamedian","el","StreamedianSourceHandler","canHandleSource","handleSource","canPlayWithModules","getTech","registerSourceHandler"],"mappings":"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"}